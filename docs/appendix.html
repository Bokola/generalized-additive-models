<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Generalized Additive Models</title>
  <meta name="description" content="Generalized Additive Models">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Generalized Additive Models" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/" />
  <meta property="og:image" content="https://m-clark.github.io/img/nineteeneightyR.png" />
  <meta property="og:description" content="Generalized Additive Models" />
  <meta name="github-repo" content="m-clark/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Generalized Additive Models" />
  
  <meta name="twitter:description" content="Generalized Additive Models" />
  <meta name="twitter:image" content="https://m-clark.github.io/img/nineteeneightyR.png" />



<meta name="date" content="2018-01-12">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  <link rel="shortcut icon" href="img/R.ico" type="image/x-icon">
<link rel="prev" href="conclusion.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.9/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/book.css" type="text/css" />
<link rel="stylesheet" href="css/standard_html.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://m-clark.github.io/"><span style="font-size:125%; font-variant:small-caps; font-style:italic; color:#0085A1; font-family:Roboto">Generalized Additive Models</span></a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#beyond-the-general-linear-model-i"><i class="fa fa-check"></i>Beyond the General Linear Model I</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#general-linear-model"><i class="fa fa-check"></i>General Linear Model</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#generalized-linear-model"><i class="fa fa-check"></i>Generalized Linear Model</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#generalized-additive-model"><i class="fa fa-check"></i>Generalized Additive Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#beyond-the-general-linear-model-ii"><i class="fa fa-check"></i>Beyond the General Linear Model II</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#fitting-the-standard-linear-model"><i class="fa fa-check"></i>Fitting the Standard Linear Model</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#polynomial-regression"><i class="fa fa-check"></i>Polynomial Regression</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#scatterplot-smoothing"><i class="fa fa-check"></i>Scatterplot Smoothing</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#generalized-additive-models"><i class="fa fa-check"></i>Generalized Additive Models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#summary"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html"><i class="fa fa-check"></i>Application Using R</a><ul>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html#initial-examination"><i class="fa fa-check"></i>Initial Examination</a></li>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html#single-predictor"><i class="fa fa-check"></i>Single Predictor</a><ul>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html#linear-fit"><i class="fa fa-check"></i>Linear Fit</a></li>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html#gam"><i class="fa fa-check"></i>GAM</a></li>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html#graphical-display"><i class="fa fa-check"></i>Graphical Display</a></li>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html#model-comparison"><i class="fa fa-check"></i>Model Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html#multiple-predictors"><i class="fa fa-check"></i>Multiple Predictors</a><ul>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html#linear-fit-1"><i class="fa fa-check"></i>Linear Fit</a></li>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html#gam-1"><i class="fa fa-check"></i>GAM</a></li>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html#graphical-display-1"><i class="fa fa-check"></i>Graphical Display</a></li>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html#model-comparison-1"><i class="fa fa-check"></i>Model Comparison</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="other-issues.html"><a href="other-issues.html"><i class="fa fa-check"></i>Other Issues</a><ul>
<li class="chapter" data-level="" data-path="other-issues.html"><a href="other-issues.html#estimation"><i class="fa fa-check"></i>Estimation</a><ul>
<li class="chapter" data-level="" data-path="other-issues.html"><a href="other-issues.html#shrinkage-variable-selection"><i class="fa fa-check"></i>Shrinkage &amp; Variable Selection</a></li>
<li class="chapter" data-level="" data-path="other-issues.html"><a href="other-issues.html#effective-degrees-of-freedom-again"><i class="fa fa-check"></i>Effective degrees of freedom again</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="other-issues.html"><a href="other-issues.html#choice-of-smoothing-function"><i class="fa fa-check"></i>Choice of Smoothing Function</a></li>
<li class="chapter" data-level="" data-path="other-issues.html"><a href="other-issues.html#diagnostics"><i class="fa fa-check"></i>Diagnostics</a><ul>
<li class="chapter" data-level="" data-path="other-issues.html"><a href="other-issues.html#concurvity"><i class="fa fa-check"></i>Concurvity</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="other-issues.html"><a href="other-issues.html#prediction"><i class="fa fa-check"></i>Prediction</a></li>
<li class="chapter" data-level="" data-path="other-issues.html"><a href="other-issues.html#model-comparison-revisited"><i class="fa fa-check"></i>Model Comparison Revisited</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="other-approaches.html"><a href="other-approaches.html"><i class="fa fa-check"></i>Other Approaches</a><ul>
<li class="chapter" data-level="" data-path="other-approaches.html"><a href="other-approaches.html#other-nonlinear-modeling-approaches"><i class="fa fa-check"></i>Other Nonlinear Modeling Approaches</a><ul>
<li class="chapter" data-level="" data-path="other-approaches.html"><a href="other-approaches.html#known-form"><i class="fa fa-check"></i>Known Form</a></li>
<li class="chapter" data-level="" data-path="other-approaches.html"><a href="other-approaches.html#response-transformation"><i class="fa fa-check"></i>Response Transformation</a></li>
<li class="chapter" data-level="" data-path="other-approaches.html"><a href="other-approaches.html#the-black-box"><i class="fa fa-check"></i>The Black Box</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="other-approaches.html"><a href="other-approaches.html#extensions"><i class="fa fa-check"></i>Extensions</a><ul>
<li class="chapter" data-level="" data-path="other-approaches.html"><a href="other-approaches.html#other-gams"><i class="fa fa-check"></i>Other GAMs</a></li>
<li class="chapter" data-level="" data-path="other-approaches.html"><a href="other-approaches.html#reproducing-kernel-hilbert-space"><i class="fa fa-check"></i>Reproducing Kernel Hilbert Space</a></li>
<li class="chapter" data-level="" data-path="other-approaches.html"><a href="other-approaches.html#gaussian-processes"><i class="fa fa-check"></i>Gaussian Processes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i>Conclusion</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#r-packages"><i class="fa fa-check"></i>R packages</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#penalized-estimation-example"><i class="fa fa-check"></i>Penalized Estimation Example</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#basis-functions-for-a-cubic-spline"><i class="fa fa-check"></i>Basis functions for a cubic spline</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://m-clark.github.io/"><img src="img/mc.png" style="width:50%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo"></a></li>
<li><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="width:50%; border-width:0; display:block; margin: 0 auto;" src="img/ccbysa.png" /></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><span style="color:#0085A1; font-size:5rem">Generalized Additive Models</span></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="appendix" class="section level1">
<h1>Appendix</h1>
<div id="r-packages" class="section level2">
<h2>R packages</h2>
<p><span class="newthought">The following is</span> a non-exhaustive list of R packages which contain GAM functionality. Each is linked to the CRAN page for the package. Note also that several build upon the <span class="pack">mgcv</span> package used for this document.</p>
<p><a href="http://cran.r-project.org/web/packages/brms/">brms</a> Allows for Bayesian GAMs via the Stan modeling language (very new implementation).</p>
<p><a href="http://cran.r-project.org/web/packages/CausalGAM/">CausalGAM</a> This package implements various estimators for average treatment effects.</p>
<p><a href="http://cran.r-project.org/web/packages/COZIGAM/">COZIGAM</a> Constrained and Unconstrained Zero-Inflated Generalized Additive Models.</p>
<p><a href="http://cran.r-project.org/web/packages/CoxBoost/">CoxBoost</a> This package provides routines for fitting Cox models. See also <span class="func">cph</span> in rms package for nonlinear approaches in the survival context.</p>
<p><a href="http://cran.r-project.org/web/packages/gam/">gam</a> Functions for fitting and working with generalized additive models.</p>
<p><a href="http://cran.r-project.org/web/packages/GAMBoost/">GAMBoost</a>: This package provides routines for fitting generalized linear and and generalized additive models by likelihood based boosting.</p>
<p><a href="http://cran.r-project.org/web/packages/gamboostLSS/">gamboostLSS</a>: Boosting models for fitting generalized additive models for location, shape and scale (gamLSS models).</p>
<p><a href="http://cran.r-project.org/web/packages/GAMens/">GAMens</a>: This package implements the GAMbag, GAMrsm and GAMens ensemble classifiers for binary classification.</p>
<p><a href="http://cran.r-project.org/web/packages/gamlss/">gamlss</a>: Generalized additive models for location, shape, and scale.</p>
<p><a href="http://cran.r-project.org/web/packages/gamm4/">gamm4</a>: Fit generalized additive mixed models via a version of mgcv’s gamm function.</p>
<p><a href="http://cran.r-project.org/web/packages/gammSlice/">gammSlice</a>: Bayesian fitting and inference for generalized additive mixed models.</p>
<p><a href="http://cran.r-project.org/web/packages/GMMBoost/">GMMBoost</a>: Likelihood-based Boosting for Generalized mixed models.</p>
<p><a href="http://cran.r-project.org/web/packages/gss/">gss</a>: A comprehensive package for structural multivariate function estimation using smoothing splines.</p>
<p><a href="http://cran.r-project.org/web/packages/mboost/">mboost</a>: Model-Based Boosting.</p>
<p><a href="http://cran.r-project.org/web/packages/mgcv/">mgcv</a>: Routines for GAMs and other generalized ridge regression with multiple smoothing parameter selection by GCV, REML or UBRE/AIC. Also GAMMs.</p>
<p><a href="http://cran.r-project.org/web/packages/VGAM/">VGAM</a>: Vector generalized linear and additive models, and associated models.</p>
</div>
<div id="penalized-estimation-example" class="section level2">
<h2>Penalized Estimation Example</h2>
<p>Initial data set up and functions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">############################
### Wood by-hand example <span class="al">###</span>
############################

size =<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.42</span>,<span class="fl">1.58</span>,<span class="fl">1.78</span>,<span class="fl">1.99</span>,<span class="fl">1.99</span>,<span class="fl">1.99</span>,<span class="fl">2.13</span>,<span class="fl">2.13</span>,<span class="fl">2.13</span>,
         <span class="fl">2.32</span>,<span class="fl">2.32</span>,<span class="fl">2.32</span>,<span class="fl">2.32</span>,<span class="fl">2.32</span>,<span class="fl">2.43</span>,<span class="fl">2.43</span>,<span class="fl">2.78</span>,<span class="fl">2.98</span>,<span class="fl">2.98</span>)
wear =<span class="st"> </span><span class="kw">c</span>(<span class="fl">4.0</span>,<span class="fl">4.2</span>,<span class="fl">2.5</span>,<span class="fl">2.6</span>,<span class="fl">2.8</span>,<span class="fl">2.4</span>,<span class="fl">3.2</span>,<span class="fl">2.4</span>,<span class="fl">2.6</span>,<span class="fl">4.8</span>,<span class="fl">2.9</span>,
         <span class="fl">3.8</span>,<span class="fl">3.0</span>,<span class="fl">2.7</span>,<span class="fl">3.1</span>,<span class="fl">3.3</span>,<span class="fl">3.0</span>,<span class="fl">2.8</span>,<span class="fl">1.7</span>)
x =<span class="st"> </span>size <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(size); x =<span class="st"> </span>x<span class="op">/</span><span class="kw">max</span>(x)
d =<span class="st"> </span><span class="kw">data.frame</span>(wear, x)

<span class="co">#cubic spline function</span>
rk &lt;-<span class="st"> </span><span class="cf">function</span>(x,z) {
  ((z<span class="op">-</span><span class="fl">0.5</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">12</span>)<span class="op">*</span>((x<span class="op">-</span><span class="fl">0.5</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">12</span>)<span class="op">/</span><span class="dv">4</span> <span class="op">-</span>
<span class="st">    </span>((<span class="kw">abs</span>(x<span class="op">-</span>z)<span class="op">-</span><span class="fl">0.5</span>)<span class="op">^</span><span class="dv">4</span><span class="op">-</span>(<span class="kw">abs</span>(x<span class="op">-</span>z)<span class="op">-</span><span class="fl">0.5</span>)<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">7</span><span class="op">/</span><span class="dv">240</span>) <span class="op">/</span><span class="st"> </span><span class="dv">24</span>
}

spl.X &lt;-<span class="st"> </span><span class="cf">function</span>(x,knots){
  q &lt;-<span class="st"> </span><span class="kw">length</span>(knots) <span class="op">+</span><span class="st"> </span><span class="dv">2</span>                <span class="co"># number of parameters</span>
  n &lt;-<span class="st"> </span><span class="kw">length</span>(x)                        <span class="co"># number of observations</span>
  X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>, n, q)                  <span class="co"># initialized model matrix</span>
  X[,<span class="dv">2</span>] &lt;-<span class="st"> </span>x                            <span class="co"># set second column to x</span>
  X[,<span class="dv">3</span><span class="op">:</span>q] &lt;-<span class="st"> </span><span class="kw">outer</span>(x, knots, <span class="dt">FUN =</span> rk)  <span class="co"># remaining to cubic spline</span>
  X
}

spl.S &lt;-<span class="st"> </span><span class="cf">function</span>(knots) {
  q =<span class="st"> </span><span class="kw">length</span>(knots) <span class="op">+</span><span class="st"> </span><span class="dv">2</span>
  S =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, q, q)                           <span class="co"># initialize matrix</span>
  S[<span class="dv">3</span><span class="op">:</span>q, <span class="dv">3</span><span class="op">:</span>q] =<span class="st"> </span><span class="kw">outer</span>(knots, knots, <span class="dt">FUN=</span>rk)     <span class="co"># fill in non-zero part</span>
  S
}

<span class="co">#matrix square root function</span>
mat.sqrt &lt;-<span class="st"> </span><span class="cf">function</span>(S){
  d =<span class="st"> </span><span class="kw">eigen</span>(S, <span class="dt">symmetric=</span>T)
  rS =<span class="st"> </span>d<span class="op">$</span>vectors <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(d<span class="op">$</span>values<span class="op">^</span>.<span class="dv">5</span>) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(d<span class="op">$</span>vectors)
  rS
}

<span class="co">#the fitting function</span>
prs.fit &lt;-<span class="st"> </span><span class="cf">function</span>(y, x, knots, lambda) {
  q =<span class="st"> </span><span class="kw">length</span>(knots) <span class="op">+</span><span class="st"> </span><span class="dv">2</span>       <span class="co"># dimension of basis</span>
  n =<span class="st"> </span><span class="kw">length</span>(x)               <span class="co"># number of observations</span>
  Xa =<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">spl.X</span>(x, knots), <span class="kw">mat.sqrt</span>(<span class="kw">spl.S</span>(knots))<span class="op">*</span><span class="kw">sqrt</span>(lambda))  <span class="co"># augmented model matrix</span>
  y[(n<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(n<span class="op">+</span>q)] =<span class="st"> </span><span class="dv">0</span>          <span class="co"># augment the data vector</span>
  <span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>Xa <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)              <span class="co"># fit and return penalized regression spline</span>
}</code></pre></div>
<p>Example 1.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knots =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">/</span><span class="dv">5</span>
X =<span class="st"> </span><span class="kw">spl.X</span>(x, knots)           <span class="co"># generate model matrix</span>
mod.<span class="dv">1</span> =<span class="st"> </span><span class="kw">lm</span>(wear <span class="op">~</span><span class="st"> </span>X <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)      <span class="co"># fit model</span>
xp &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">100</span><span class="op">/</span><span class="dv">100</span>               <span class="co"># x values for prediction</span>
Xp &lt;-<span class="st"> </span><span class="kw">spl.X</span>(xp, knots)        <span class="co"># prediction matrix</span></code></pre></div>
<div id="509023bfa74d" style="width:600px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="509023bfa74d">{"x":{"data":[{"x":[0,0.102564102564103,0.230769230769231,0.365384615384615,0.365384615384615,0.365384615384615,0.455128205128205,0.455128205128205,0.455128205128205,0.576923076923077,0.576923076923077,0.576923076923077,0.576923076923077,0.576923076923077,0.647435897435898,0.647435897435898,0.871794871794872,1,1],"y":[4,4.2,2.5,2.6,2.8,2.4,3.2,2.4,2.6,4.8,2.9,3.8,3,2.7,3.1,3.3,3,2.8,1.7],"text":["x: 0.0000000<br />wear: 4.0","x: 0.1025641<br />wear: 4.2","x: 0.2307692<br />wear: 2.5","x: 0.3653846<br />wear: 2.6","x: 0.3653846<br />wear: 2.8","x: 0.3653846<br />wear: 2.4","x: 0.4551282<br />wear: 3.2","x: 0.4551282<br />wear: 2.4","x: 0.4551282<br />wear: 2.6","x: 0.5769231<br />wear: 4.8","x: 0.5769231<br />wear: 2.9","x: 0.5769231<br />wear: 3.8","x: 0.5769231<br />wear: 3.0","x: 0.5769231<br />wear: 2.7","x: 0.6474359<br />wear: 3.1","x: 0.6474359<br />wear: 3.3","x: 0.8717949<br />wear: 3.0","x: 1.0000000<br />wear: 2.8","x: 1.0000000<br />wear: 1.7"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,128,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(255,128,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,0.09,0.1,0.11,0.12,0.13,0.14,0.15,0.16,0.17,0.18,0.19,0.2,0.21,0.22,0.23,0.24,0.25,0.26,0.27,0.28,0.29,0.3,0.31,0.32,0.33,0.34,0.35,0.36,0.37,0.38,0.39,0.4,0.41,0.42,0.43,0.44,0.45,0.46,0.47,0.48,0.49,0.5,0.51,0.52,0.53,0.54,0.55,0.56,0.57,0.58,0.59,0.6,0.61,0.62,0.63,0.64,0.65,0.66,0.67,0.68,0.69,0.7,0.71,0.72,0.73,0.74,0.75,0.76,0.77,0.78,0.79,0.8,0.81,0.82,0.83,0.84,0.85,0.86,0.87,0.88,0.89,0.9,0.91,0.92,0.93,0.94,0.95,0.96,0.97,0.98,0.99,1],"y":[4.25007999545561,4.18943175400254,4.12881336533211,4.06825671753703,4.00779591904824,3.94746729863489,3.88730940540441,3.82736300880243,3.76767109861283,3.70827888495774,3.64923379829749,3.5905854894307,3.53238582949416,3.47468890996296,3.41755104265039,3.36103075970798,3.3051888136255,3.25008817723096,3.19579404369061,3.14237382650892,3.08989715952861,3.03846366251091,2.98828623787636,2.93960777396401,2.89267337945116,2.84773038335333,2.80502833502429,2.76481900415603,2.7273563807788,2.69289667526107,2.66169831830954,2.63402196096916,2.61013047462312,2.59028895099282,2.57476470213793,2.56382726045633,2.55774837868416,2.55680202989577,2.56126440750376,2.57141392525898,2.58753121725049,2.6097481449068,2.63759481799946,2.67045257363946,2.707704969276,2.74873778269656,2.79293901202682,2.83969887573071,2.88840981261039,2.93846648180627,2.98926576279699,3.04020675539942,3.09069077976866,3.14012137639808,3.18790430611924,3.23344755010198,3.27616130985434,3.31545800722262,3.35075228439135,3.38146100388329,3.40700324855944,3.42693970443214,3.4413908091043,3.45061860333016,3.45488734820222,3.4544635251512,3.44961583594604,3.44061520269395,3.42773476784034,3.4112498941689,3.39143816480151,3.36857938319832,3.3429555731577,3.31485097881626,3.28455206464885,3.25234751546855,3.21852823642669,3.18338735301281,3.14722021105471,3.11032437671843,3.07299963650821,3.03549483623474,2.99784839791958,2.9600478028907,2.92208275281431,2.88394516969486,2.84562919587502,2.80713119403572,2.7684497471961,2.72958565871356,2.69054195228372,2.65132387194044,2.61193888205582,2.57239666734021,2.53270913284216,2.49289040394849,2.45295682638424,2.41292696621269,2.37282160983536,2.332663763992,2.2924786557606],"text":["xp: 0.00<br />Xp %*% coef(mod.1): 4.250080<br />x: 0.00<br />wear: 4.250080","xp: 0.01<br />Xp %*% coef(mod.1): 4.189432<br />x: 0.01<br />wear: 4.189432","xp: 0.02<br />Xp %*% coef(mod.1): 4.128813<br />x: 0.02<br />wear: 4.128813","xp: 0.03<br />Xp %*% coef(mod.1): 4.068257<br />x: 0.03<br />wear: 4.068257","xp: 0.04<br />Xp %*% coef(mod.1): 4.007796<br />x: 0.04<br />wear: 4.007796","xp: 0.05<br />Xp %*% coef(mod.1): 3.947467<br />x: 0.05<br />wear: 3.947467","xp: 0.06<br />Xp %*% coef(mod.1): 3.887309<br />x: 0.06<br />wear: 3.887309","xp: 0.07<br />Xp %*% coef(mod.1): 3.827363<br />x: 0.07<br />wear: 3.827363","xp: 0.08<br />Xp %*% coef(mod.1): 3.767671<br />x: 0.08<br />wear: 3.767671","xp: 0.09<br />Xp %*% coef(mod.1): 3.708279<br />x: 0.09<br />wear: 3.708279","xp: 0.10<br />Xp %*% coef(mod.1): 3.649234<br />x: 0.10<br />wear: 3.649234","xp: 0.11<br />Xp %*% coef(mod.1): 3.590585<br />x: 0.11<br />wear: 3.590585","xp: 0.12<br />Xp %*% coef(mod.1): 3.532386<br />x: 0.12<br />wear: 3.532386","xp: 0.13<br />Xp %*% coef(mod.1): 3.474689<br />x: 0.13<br />wear: 3.474689","xp: 0.14<br />Xp %*% coef(mod.1): 3.417551<br />x: 0.14<br />wear: 3.417551","xp: 0.15<br />Xp %*% coef(mod.1): 3.361031<br />x: 0.15<br />wear: 3.361031","xp: 0.16<br />Xp %*% coef(mod.1): 3.305189<br />x: 0.16<br />wear: 3.305189","xp: 0.17<br />Xp %*% coef(mod.1): 3.250088<br />x: 0.17<br />wear: 3.250088","xp: 0.18<br />Xp %*% coef(mod.1): 3.195794<br />x: 0.18<br />wear: 3.195794","xp: 0.19<br />Xp %*% coef(mod.1): 3.142374<br />x: 0.19<br />wear: 3.142374","xp: 0.20<br />Xp %*% coef(mod.1): 3.089897<br />x: 0.20<br />wear: 3.089897","xp: 0.21<br />Xp %*% coef(mod.1): 3.038464<br />x: 0.21<br />wear: 3.038464","xp: 0.22<br />Xp %*% coef(mod.1): 2.988286<br />x: 0.22<br />wear: 2.988286","xp: 0.23<br />Xp %*% coef(mod.1): 2.939608<br />x: 0.23<br />wear: 2.939608","xp: 0.24<br />Xp %*% coef(mod.1): 2.892673<br />x: 0.24<br />wear: 2.892673","xp: 0.25<br />Xp %*% coef(mod.1): 2.847730<br />x: 0.25<br />wear: 2.847730","xp: 0.26<br />Xp %*% coef(mod.1): 2.805028<br />x: 0.26<br />wear: 2.805028","xp: 0.27<br />Xp %*% coef(mod.1): 2.764819<br />x: 0.27<br />wear: 2.764819","xp: 0.28<br />Xp %*% coef(mod.1): 2.727356<br />x: 0.28<br />wear: 2.727356","xp: 0.29<br />Xp %*% coef(mod.1): 2.692897<br />x: 0.29<br />wear: 2.692897","xp: 0.30<br />Xp %*% coef(mod.1): 2.661698<br />x: 0.30<br />wear: 2.661698","xp: 0.31<br />Xp %*% coef(mod.1): 2.634022<br />x: 0.31<br />wear: 2.634022","xp: 0.32<br />Xp %*% coef(mod.1): 2.610130<br />x: 0.32<br />wear: 2.610130","xp: 0.33<br />Xp %*% coef(mod.1): 2.590289<br />x: 0.33<br />wear: 2.590289","xp: 0.34<br />Xp %*% coef(mod.1): 2.574765<br />x: 0.34<br />wear: 2.574765","xp: 0.35<br />Xp %*% coef(mod.1): 2.563827<br />x: 0.35<br />wear: 2.563827","xp: 0.36<br />Xp %*% coef(mod.1): 2.557748<br />x: 0.36<br />wear: 2.557748","xp: 0.37<br />Xp %*% coef(mod.1): 2.556802<br />x: 0.37<br />wear: 2.556802","xp: 0.38<br />Xp %*% coef(mod.1): 2.561264<br />x: 0.38<br />wear: 2.561264","xp: 0.39<br />Xp %*% coef(mod.1): 2.571414<br />x: 0.39<br />wear: 2.571414","xp: 0.40<br />Xp %*% coef(mod.1): 2.587531<br />x: 0.40<br />wear: 2.587531","xp: 0.41<br />Xp %*% coef(mod.1): 2.609748<br />x: 0.41<br />wear: 2.609748","xp: 0.42<br />Xp %*% coef(mod.1): 2.637595<br />x: 0.42<br />wear: 2.637595","xp: 0.43<br />Xp %*% coef(mod.1): 2.670453<br />x: 0.43<br />wear: 2.670453","xp: 0.44<br />Xp %*% coef(mod.1): 2.707705<br />x: 0.44<br />wear: 2.707705","xp: 0.45<br />Xp %*% coef(mod.1): 2.748738<br />x: 0.45<br />wear: 2.748738","xp: 0.46<br />Xp %*% coef(mod.1): 2.792939<br />x: 0.46<br />wear: 2.792939","xp: 0.47<br />Xp %*% coef(mod.1): 2.839699<br />x: 0.47<br />wear: 2.839699","xp: 0.48<br />Xp %*% coef(mod.1): 2.888410<br />x: 0.48<br />wear: 2.888410","xp: 0.49<br />Xp %*% coef(mod.1): 2.938466<br />x: 0.49<br />wear: 2.938466","xp: 0.50<br />Xp %*% coef(mod.1): 2.989266<br />x: 0.50<br />wear: 2.989266","xp: 0.51<br />Xp %*% coef(mod.1): 3.040207<br />x: 0.51<br />wear: 3.040207","xp: 0.52<br />Xp %*% coef(mod.1): 3.090691<br />x: 0.52<br />wear: 3.090691","xp: 0.53<br />Xp %*% coef(mod.1): 3.140121<br />x: 0.53<br />wear: 3.140121","xp: 0.54<br />Xp %*% coef(mod.1): 3.187904<br />x: 0.54<br />wear: 3.187904","xp: 0.55<br />Xp %*% coef(mod.1): 3.233448<br />x: 0.55<br />wear: 3.233448","xp: 0.56<br />Xp %*% coef(mod.1): 3.276161<br />x: 0.56<br />wear: 3.276161","xp: 0.57<br />Xp %*% coef(mod.1): 3.315458<br />x: 0.57<br />wear: 3.315458","xp: 0.58<br />Xp %*% coef(mod.1): 3.350752<br />x: 0.58<br />wear: 3.350752","xp: 0.59<br />Xp %*% coef(mod.1): 3.381461<br />x: 0.59<br />wear: 3.381461","xp: 0.60<br />Xp %*% coef(mod.1): 3.407003<br />x: 0.60<br />wear: 3.407003","xp: 0.61<br />Xp %*% coef(mod.1): 3.426940<br />x: 0.61<br />wear: 3.426940","xp: 0.62<br />Xp %*% coef(mod.1): 3.441391<br />x: 0.62<br />wear: 3.441391","xp: 0.63<br />Xp %*% coef(mod.1): 3.450619<br />x: 0.63<br />wear: 3.450619","xp: 0.64<br />Xp %*% coef(mod.1): 3.454887<br />x: 0.64<br />wear: 3.454887","xp: 0.65<br />Xp %*% coef(mod.1): 3.454464<br />x: 0.65<br />wear: 3.454464","xp: 0.66<br />Xp %*% coef(mod.1): 3.449616<br />x: 0.66<br />wear: 3.449616","xp: 0.67<br />Xp %*% coef(mod.1): 3.440615<br />x: 0.67<br />wear: 3.440615","xp: 0.68<br />Xp %*% coef(mod.1): 3.427735<br />x: 0.68<br />wear: 3.427735","xp: 0.69<br />Xp %*% coef(mod.1): 3.411250<br />x: 0.69<br />wear: 3.411250","xp: 0.70<br />Xp %*% coef(mod.1): 3.391438<br />x: 0.70<br />wear: 3.391438","xp: 0.71<br />Xp %*% coef(mod.1): 3.368579<br />x: 0.71<br />wear: 3.368579","xp: 0.72<br />Xp %*% coef(mod.1): 3.342956<br />x: 0.72<br />wear: 3.342956","xp: 0.73<br />Xp %*% coef(mod.1): 3.314851<br />x: 0.73<br />wear: 3.314851","xp: 0.74<br />Xp %*% coef(mod.1): 3.284552<br />x: 0.74<br />wear: 3.284552","xp: 0.75<br />Xp %*% coef(mod.1): 3.252348<br />x: 0.75<br />wear: 3.252348","xp: 0.76<br />Xp %*% coef(mod.1): 3.218528<br />x: 0.76<br />wear: 3.218528","xp: 0.77<br />Xp %*% coef(mod.1): 3.183387<br />x: 0.77<br />wear: 3.183387","xp: 0.78<br />Xp %*% coef(mod.1): 3.147220<br />x: 0.78<br />wear: 3.147220","xp: 0.79<br />Xp %*% coef(mod.1): 3.110324<br />x: 0.79<br />wear: 3.110324","xp: 0.80<br />Xp %*% coef(mod.1): 3.073000<br />x: 0.80<br />wear: 3.073000","xp: 0.81<br />Xp %*% coef(mod.1): 3.035495<br />x: 0.81<br />wear: 3.035495","xp: 0.82<br />Xp %*% coef(mod.1): 2.997848<br />x: 0.82<br />wear: 2.997848","xp: 0.83<br />Xp %*% coef(mod.1): 2.960048<br />x: 0.83<br />wear: 2.960048","xp: 0.84<br />Xp %*% coef(mod.1): 2.922083<br />x: 0.84<br />wear: 2.922083","xp: 0.85<br />Xp %*% coef(mod.1): 2.883945<br />x: 0.85<br />wear: 2.883945","xp: 0.86<br />Xp %*% coef(mod.1): 2.845629<br />x: 0.86<br />wear: 2.845629","xp: 0.87<br />Xp %*% coef(mod.1): 2.807131<br />x: 0.87<br />wear: 2.807131","xp: 0.88<br />Xp %*% coef(mod.1): 2.768450<br />x: 0.88<br />wear: 2.768450","xp: 0.89<br />Xp %*% coef(mod.1): 2.729586<br />x: 0.89<br />wear: 2.729586","xp: 0.90<br />Xp %*% coef(mod.1): 2.690542<br />x: 0.90<br />wear: 2.690542","xp: 0.91<br />Xp %*% coef(mod.1): 2.651324<br />x: 0.91<br />wear: 2.651324","xp: 0.92<br />Xp %*% coef(mod.1): 2.611939<br />x: 0.92<br />wear: 2.611939","xp: 0.93<br />Xp %*% coef(mod.1): 2.572397<br />x: 0.93<br />wear: 2.572397","xp: 0.94<br />Xp %*% coef(mod.1): 2.532709<br />x: 0.94<br />wear: 2.532709","xp: 0.95<br />Xp %*% coef(mod.1): 2.492890<br />x: 0.95<br />wear: 2.492890","xp: 0.96<br />Xp %*% coef(mod.1): 2.452957<br />x: 0.96<br />wear: 2.452957","xp: 0.97<br />Xp %*% coef(mod.1): 2.412927<br />x: 0.97<br />wear: 2.412927","xp: 0.98<br />Xp %*% coef(mod.1): 2.372822<br />x: 0.98<br />wear: 2.372822","xp: 0.99<br />Xp %*% coef(mod.1): 2.332664<br />x: 0.99<br />wear: 2.332664","xp: 1.00<br />Xp %*% coef(mod.1): 2.292479<br />x: 1.00<br />wear: 2.292479"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(41,87,255,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.689497716895,"r":7.30593607305936,"b":41.6438356164384,"l":31.4155251141553},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[-0.05,1.05],"ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(127,127,127,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":"x","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"type":"linear","autorange":false,"tickmode":"array","range":[1.545,4.955],"ticktext":["2","3","4"],"tickvals":[2,3,4],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(127,127,127,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"wear","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"transparent","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","width":"75%","paper_bgcolor":"rgba(0,0,0,0)","plot_bgcolor":"rgba(0,0,0,0)"},"source":"A","attrs":{"50904c514426":{"x":{},"y":{},"type":"ggplotly"},"50906b5141ee":{"x":{},"y":{},"x.1":{},"y.1":{}}},"cur_data":"50904c514426","visdat":{"50904c514426":["function (y) ","x"],"50906b5141ee":["function (y) ","x"]},"config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<p>Example 2.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knots =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">7</span><span class="op">/</span><span class="dv">8</span>

pisa2 =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span>xp)

<span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">c</span>(.<span class="dv">1</span>, .<span class="dv">01</span>, .<span class="dv">001</span>, .<span class="dv">0001</span>, .<span class="dv">00001</span>, .<span class="dv">000001</span>)) {
  mod.<span class="dv">2</span> =<span class="st"> </span><span class="kw">prs.fit</span>(<span class="dt">y=</span>wear, <span class="dt">x=</span>x, <span class="dt">knots=</span>knots, <span class="dt">lambda=</span>i) <span class="co"># fit penalized regression </span>
                                <span class="co"># spline choosing lambda</span>
  Xp =<span class="st"> </span><span class="kw">spl.X</span>(xp,knots)          <span class="co"># matrix to map parameters to fitted values at xp</span>
  pisa2[,<span class="kw">paste</span>(<span class="st">&#39;lambda = &#39;</span>,i, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>)] =<span class="st"> </span>Xp<span class="op">%*%</span><span class="kw">coef</span>(mod.<span class="dv">2</span>)
}</code></pre></div>
<div id="50904f3f9b99" style="width:600px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="50904f3f9b99">{"x":{"data":[{"x":[0,0.102564102564103,0.230769230769231,0.365384615384615,0.365384615384615,0.365384615384615,0.455128205128205,0.455128205128205,0.455128205128205,0.576923076923077,0.576923076923077,0.576923076923077,0.576923076923077,0.576923076923077,0.647435897435898,0.647435897435898,0.871794871794872,1,1],"y":[4,4.2,2.5,2.6,2.8,2.4,3.2,2.4,2.6,4.8,2.9,3.8,3,2.7,3.1,3.3,3,2.8,1.7],"text":["x: 0.0000000<br />wear: 4.0","x: 0.1025641<br />wear: 4.2","x: 0.2307692<br />wear: 2.5","x: 0.3653846<br />wear: 2.6","x: 0.3653846<br />wear: 2.8","x: 0.3653846<br />wear: 2.4","x: 0.4551282<br />wear: 3.2","x: 0.4551282<br />wear: 2.4","x: 0.4551282<br />wear: 2.6","x: 0.5769231<br />wear: 4.8","x: 0.5769231<br />wear: 2.9","x: 0.5769231<br />wear: 3.8","x: 0.5769231<br />wear: 3.0","x: 0.5769231<br />wear: 2.7","x: 0.6474359<br />wear: 3.1","x: 0.6474359<br />wear: 3.3","x: 0.8717949<br />wear: 3.0","x: 1.0000000<br />wear: 2.8","x: 1.0000000<br />wear: 1.7"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,128,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(255,128,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.102564102564103,0.230769230769231,0.365384615384615,0.365384615384615,0.365384615384615,0.455128205128205,0.455128205128205,0.455128205128205,0.576923076923077,0.576923076923077,0.576923076923077,0.576923076923077,0.576923076923077,0.647435897435898,0.647435897435898,0.871794871794872,1,1],"y":[4,4.2,2.5,2.6,2.8,2.4,3.2,2.4,2.6,4.8,2.9,3.8,3,2.7,3.1,3.3,3,2.8,1.7],"text":["x: 0.0000000<br />wear: 4.0","x: 0.1025641<br />wear: 4.2","x: 0.2307692<br />wear: 2.5","x: 0.3653846<br />wear: 2.6","x: 0.3653846<br />wear: 2.8","x: 0.3653846<br />wear: 2.4","x: 0.4551282<br />wear: 3.2","x: 0.4551282<br />wear: 2.4","x: 0.4551282<br />wear: 2.6","x: 0.5769231<br />wear: 4.8","x: 0.5769231<br />wear: 2.9","x: 0.5769231<br />wear: 3.8","x: 0.5769231<br />wear: 3.0","x: 0.5769231<br />wear: 2.7","x: 0.6474359<br />wear: 3.1","x: 0.6474359<br />wear: 3.3","x: 0.8717949<br />wear: 3.0","x: 1.0000000<br />wear: 2.8","x: 1.0000000<br />wear: 1.7"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,128,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(255,128,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.102564102564103,0.230769230769231,0.365384615384615,0.365384615384615,0.365384615384615,0.455128205128205,0.455128205128205,0.455128205128205,0.576923076923077,0.576923076923077,0.576923076923077,0.576923076923077,0.576923076923077,0.647435897435898,0.647435897435898,0.871794871794872,1,1],"y":[4,4.2,2.5,2.6,2.8,2.4,3.2,2.4,2.6,4.8,2.9,3.8,3,2.7,3.1,3.3,3,2.8,1.7],"text":["x: 0.0000000<br />wear: 4.0","x: 0.1025641<br />wear: 4.2","x: 0.2307692<br />wear: 2.5","x: 0.3653846<br />wear: 2.6","x: 0.3653846<br />wear: 2.8","x: 0.3653846<br />wear: 2.4","x: 0.4551282<br />wear: 3.2","x: 0.4551282<br />wear: 2.4","x: 0.4551282<br />wear: 2.6","x: 0.5769231<br />wear: 4.8","x: 0.5769231<br />wear: 2.9","x: 0.5769231<br />wear: 3.8","x: 0.5769231<br />wear: 3.0","x: 0.5769231<br />wear: 2.7","x: 0.6474359<br />wear: 3.1","x: 0.6474359<br />wear: 3.3","x: 0.8717949<br />wear: 3.0","x: 1.0000000<br />wear: 2.8","x: 1.0000000<br />wear: 1.7"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,128,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(255,128,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x3","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.102564102564103,0.230769230769231,0.365384615384615,0.365384615384615,0.365384615384615,0.455128205128205,0.455128205128205,0.455128205128205,0.576923076923077,0.576923076923077,0.576923076923077,0.576923076923077,0.576923076923077,0.647435897435898,0.647435897435898,0.871794871794872,1,1],"y":[4,4.2,2.5,2.6,2.8,2.4,3.2,2.4,2.6,4.8,2.9,3.8,3,2.7,3.1,3.3,3,2.8,1.7],"text":["x: 0.0000000<br />wear: 4.0","x: 0.1025641<br />wear: 4.2","x: 0.2307692<br />wear: 2.5","x: 0.3653846<br />wear: 2.6","x: 0.3653846<br />wear: 2.8","x: 0.3653846<br />wear: 2.4","x: 0.4551282<br />wear: 3.2","x: 0.4551282<br />wear: 2.4","x: 0.4551282<br />wear: 2.6","x: 0.5769231<br />wear: 4.8","x: 0.5769231<br />wear: 2.9","x: 0.5769231<br />wear: 3.8","x: 0.5769231<br />wear: 3.0","x: 0.5769231<br />wear: 2.7","x: 0.6474359<br />wear: 3.1","x: 0.6474359<br />wear: 3.3","x: 0.8717949<br />wear: 3.0","x: 1.0000000<br />wear: 2.8","x: 1.0000000<br />wear: 1.7"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,128,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(255,128,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0,0.102564102564103,0.230769230769231,0.365384615384615,0.365384615384615,0.365384615384615,0.455128205128205,0.455128205128205,0.455128205128205,0.576923076923077,0.576923076923077,0.576923076923077,0.576923076923077,0.576923076923077,0.647435897435898,0.647435897435898,0.871794871794872,1,1],"y":[4,4.2,2.5,2.6,2.8,2.4,3.2,2.4,2.6,4.8,2.9,3.8,3,2.7,3.1,3.3,3,2.8,1.7],"text":["x: 0.0000000<br />wear: 4.0","x: 0.1025641<br />wear: 4.2","x: 0.2307692<br />wear: 2.5","x: 0.3653846<br />wear: 2.6","x: 0.3653846<br />wear: 2.8","x: 0.3653846<br />wear: 2.4","x: 0.4551282<br />wear: 3.2","x: 0.4551282<br />wear: 2.4","x: 0.4551282<br />wear: 2.6","x: 0.5769231<br />wear: 4.8","x: 0.5769231<br />wear: 2.9","x: 0.5769231<br />wear: 3.8","x: 0.5769231<br />wear: 3.0","x: 0.5769231<br />wear: 2.7","x: 0.6474359<br />wear: 3.1","x: 0.6474359<br />wear: 3.3","x: 0.8717949<br />wear: 3.0","x: 1.0000000<br />wear: 2.8","x: 1.0000000<br />wear: 1.7"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,128,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(255,128,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0,0.102564102564103,0.230769230769231,0.365384615384615,0.365384615384615,0.365384615384615,0.455128205128205,0.455128205128205,0.455128205128205,0.576923076923077,0.576923076923077,0.576923076923077,0.576923076923077,0.576923076923077,0.647435897435898,0.647435897435898,0.871794871794872,1,1],"y":[4,4.2,2.5,2.6,2.8,2.4,3.2,2.4,2.6,4.8,2.9,3.8,3,2.7,3.1,3.3,3,2.8,1.7],"text":["x: 0.0000000<br />wear: 4.0","x: 0.1025641<br />wear: 4.2","x: 0.2307692<br />wear: 2.5","x: 0.3653846<br />wear: 2.6","x: 0.3653846<br />wear: 2.8","x: 0.3653846<br />wear: 2.4","x: 0.4551282<br />wear: 3.2","x: 0.4551282<br />wear: 2.4","x: 0.4551282<br />wear: 2.6","x: 0.5769231<br />wear: 4.8","x: 0.5769231<br />wear: 2.9","x: 0.5769231<br />wear: 3.8","x: 0.5769231<br />wear: 3.0","x: 0.5769231<br />wear: 2.7","x: 0.6474359<br />wear: 3.1","x: 0.6474359<br />wear: 3.3","x: 0.8717949<br />wear: 3.0","x: 1.0000000<br />wear: 2.8","x: 1.0000000<br />wear: 1.7"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(255,128,0,1)","opacity":1,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(255,128,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x3","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0,0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,0.09,0.1,0.11,0.12,0.13,0.14,0.15,0.16,0.17,0.18,0.19,0.2,0.21,0.22,0.23,0.24,0.25,0.26,0.27,0.28,0.29,0.3,0.31,0.32,0.33,0.34,0.35,0.36,0.37,0.38,0.39,0.4,0.41,0.42,0.43,0.44,0.45,0.46,0.47,0.48,0.49,0.5,0.51,0.52,0.53,0.54,0.55,0.56,0.57,0.58,0.59,0.6,0.61,0.62,0.63,0.64,0.65,0.66,0.67,0.68,0.69,0.7,0.71,0.72,0.73,0.74,0.75,0.76,0.77,0.78,0.79,0.8,0.81,0.82,0.83,0.84,0.85,0.86,0.87,0.88,0.89,0.9,0.91,0.92,0.93,0.94,0.95,0.96,0.97,0.98,0.99,1],"y":[3.58609038468324,3.57273912536592,3.55939368836262,3.54605978183564,3.53274298941802,3.51944877021365,3.50618245879716,3.49294926521404,3.47975427498053,3.46660244908368,3.45349862398136,3.44044751160221,3.42745369934568,3.41452180844293,3.40165997789701,3.38887986448284,3.37619315880706,3.36361142694711,3.35114611045122,3.33880852633843,3.32660986709857,3.31456120069227,3.30267347055095,3.29095749557684,3.27942397014295,3.26808346409312,3.25694538259011,3.24601484566018,3.23529580864851,3.22479210237112,3.21450743311479,3.20444538263711,3.19460940816649,3.1850028424021,3.17562889351395,3.1664906451428,3.15759105640025,3.14893296186868,3.14051864669053,3.13234049853225,3.12438100758431,3.11662211459722,3.10904563579231,3.1016332628617,3.09436656296831,3.08722697874584,3.08019582829882,3.07325430520255,3.06638347850315,3.05956429271751,3.05277756783335,3.04600456909814,3.03922871638614,3.03243387483135,3.02560378503859,3.01872206308348,3.01177220051244,3.00473756434266,2.99760139706217,2.99034681662977,2.98295681647505,2.97541426549844,2.96770190807111,2.95980286142386,2.95171155820022,2.9434337464565,2.93497554710859,2.92634295654317,2.91754184661773,2.90857796466053,2.89945693347066,2.890184251318,2.88076529194321,2.87120530455777,2.86150941384394,2.85168261995479,2.84172969402395,2.8316548646949,2.82146213159169,2.81115536980916,2.80073832991296,2.79021463793952,2.77958779539609,2.76886117926069,2.75803804198217,2.74712151148015,2.73611459114507,2.72502015983814,2.7138410723449,2.70258236935231,2.69125127744876,2.67985499914694,2.66840061243036,2.6568950707533,2.64534520304085,2.63375771368889,2.62213918256411,2.610496065004,2.59883469181682,2.58716126928167,2.57548187914841],"text":["x: 0.00<br />value: 3.586090<br />x: 0.00<br />wear: 3.586090","x: 0.01<br />value: 3.572739<br />x: 0.01<br />wear: 3.572739","x: 0.02<br />value: 3.559394<br />x: 0.02<br />wear: 3.559394","x: 0.03<br />value: 3.546060<br />x: 0.03<br />wear: 3.546060","x: 0.04<br />value: 3.532743<br />x: 0.04<br />wear: 3.532743","x: 0.05<br />value: 3.519449<br />x: 0.05<br />wear: 3.519449","x: 0.06<br />value: 3.506182<br />x: 0.06<br />wear: 3.506182","x: 0.07<br />value: 3.492949<br />x: 0.07<br />wear: 3.492949","x: 0.08<br />value: 3.479754<br />x: 0.08<br />wear: 3.479754","x: 0.09<br />value: 3.466602<br />x: 0.09<br />wear: 3.466602","x: 0.10<br />value: 3.453499<br />x: 0.10<br />wear: 3.453499","x: 0.11<br />value: 3.440448<br />x: 0.11<br />wear: 3.440448","x: 0.12<br />value: 3.427454<br />x: 0.12<br />wear: 3.427454","x: 0.13<br />value: 3.414522<br />x: 0.13<br />wear: 3.414522","x: 0.14<br />value: 3.401660<br />x: 0.14<br />wear: 3.401660","x: 0.15<br />value: 3.388880<br />x: 0.15<br />wear: 3.388880","x: 0.16<br />value: 3.376193<br />x: 0.16<br />wear: 3.376193","x: 0.17<br />value: 3.363611<br />x: 0.17<br />wear: 3.363611","x: 0.18<br />value: 3.351146<br />x: 0.18<br />wear: 3.351146","x: 0.19<br />value: 3.338809<br />x: 0.19<br />wear: 3.338809","x: 0.20<br />value: 3.326610<br />x: 0.20<br />wear: 3.326610","x: 0.21<br />value: 3.314561<br />x: 0.21<br />wear: 3.314561","x: 0.22<br />value: 3.302673<br />x: 0.22<br />wear: 3.302673","x: 0.23<br />value: 3.290957<br />x: 0.23<br />wear: 3.290957","x: 0.24<br />value: 3.279424<br />x: 0.24<br />wear: 3.279424","x: 0.25<br />value: 3.268083<br />x: 0.25<br />wear: 3.268083","x: 0.26<br />value: 3.256945<br />x: 0.26<br />wear: 3.256945","x: 0.27<br />value: 3.246015<br />x: 0.27<br />wear: 3.246015","x: 0.28<br />value: 3.235296<br />x: 0.28<br />wear: 3.235296","x: 0.29<br />value: 3.224792<br />x: 0.29<br />wear: 3.224792","x: 0.30<br />value: 3.214507<br />x: 0.30<br />wear: 3.214507","x: 0.31<br />value: 3.204445<br />x: 0.31<br />wear: 3.204445","x: 0.32<br />value: 3.194609<br />x: 0.32<br />wear: 3.194609","x: 0.33<br />value: 3.185003<br />x: 0.33<br />wear: 3.185003","x: 0.34<br />value: 3.175629<br />x: 0.34<br />wear: 3.175629","x: 0.35<br />value: 3.166491<br />x: 0.35<br />wear: 3.166491","x: 0.36<br />value: 3.157591<br />x: 0.36<br />wear: 3.157591","x: 0.37<br />value: 3.148933<br />x: 0.37<br />wear: 3.148933","x: 0.38<br />value: 3.140519<br />x: 0.38<br />wear: 3.140519","x: 0.39<br />value: 3.132340<br />x: 0.39<br />wear: 3.132340","x: 0.40<br />value: 3.124381<br />x: 0.40<br />wear: 3.124381","x: 0.41<br />value: 3.116622<br />x: 0.41<br />wear: 3.116622","x: 0.42<br />value: 3.109046<br />x: 0.42<br />wear: 3.109046","x: 0.43<br />value: 3.101633<br />x: 0.43<br />wear: 3.101633","x: 0.44<br />value: 3.094367<br />x: 0.44<br />wear: 3.094367","x: 0.45<br />value: 3.087227<br />x: 0.45<br />wear: 3.087227","x: 0.46<br />value: 3.080196<br />x: 0.46<br />wear: 3.080196","x: 0.47<br />value: 3.073254<br />x: 0.47<br />wear: 3.073254","x: 0.48<br />value: 3.066383<br />x: 0.48<br />wear: 3.066383","x: 0.49<br />value: 3.059564<br />x: 0.49<br />wear: 3.059564","x: 0.50<br />value: 3.052778<br />x: 0.50<br />wear: 3.052778","x: 0.51<br />value: 3.046005<br />x: 0.51<br />wear: 3.046005","x: 0.52<br />value: 3.039229<br />x: 0.52<br />wear: 3.039229","x: 0.53<br />value: 3.032434<br />x: 0.53<br />wear: 3.032434","x: 0.54<br />value: 3.025604<br />x: 0.54<br />wear: 3.025604","x: 0.55<br />value: 3.018722<br />x: 0.55<br />wear: 3.018722","x: 0.56<br />value: 3.011772<br />x: 0.56<br />wear: 3.011772","x: 0.57<br />value: 3.004738<br />x: 0.57<br />wear: 3.004738","x: 0.58<br />value: 2.997601<br />x: 0.58<br />wear: 2.997601","x: 0.59<br />value: 2.990347<br />x: 0.59<br />wear: 2.990347","x: 0.60<br />value: 2.982957<br />x: 0.60<br />wear: 2.982957","x: 0.61<br />value: 2.975414<br />x: 0.61<br />wear: 2.975414","x: 0.62<br />value: 2.967702<br />x: 0.62<br />wear: 2.967702","x: 0.63<br />value: 2.959803<br />x: 0.63<br />wear: 2.959803","x: 0.64<br />value: 2.951712<br />x: 0.64<br />wear: 2.951712","x: 0.65<br />value: 2.943434<br />x: 0.65<br />wear: 2.943434","x: 0.66<br />value: 2.934976<br />x: 0.66<br />wear: 2.934976","x: 0.67<br />value: 2.926343<br />x: 0.67<br />wear: 2.926343","x: 0.68<br />value: 2.917542<br />x: 0.68<br />wear: 2.917542","x: 0.69<br />value: 2.908578<br />x: 0.69<br />wear: 2.908578","x: 0.70<br />value: 2.899457<br />x: 0.70<br />wear: 2.899457","x: 0.71<br />value: 2.890184<br />x: 0.71<br />wear: 2.890184","x: 0.72<br />value: 2.880765<br />x: 0.72<br />wear: 2.880765","x: 0.73<br />value: 2.871205<br />x: 0.73<br />wear: 2.871205","x: 0.74<br />value: 2.861509<br />x: 0.74<br />wear: 2.861509","x: 0.75<br />value: 2.851683<br />x: 0.75<br />wear: 2.851683","x: 0.76<br />value: 2.841730<br />x: 0.76<br />wear: 2.841730","x: 0.77<br />value: 2.831655<br />x: 0.77<br />wear: 2.831655","x: 0.78<br />value: 2.821462<br />x: 0.78<br />wear: 2.821462","x: 0.79<br />value: 2.811155<br />x: 0.79<br />wear: 2.811155","x: 0.80<br />value: 2.800738<br />x: 0.80<br />wear: 2.800738","x: 0.81<br />value: 2.790215<br />x: 0.81<br />wear: 2.790215","x: 0.82<br />value: 2.779588<br />x: 0.82<br />wear: 2.779588","x: 0.83<br />value: 2.768861<br />x: 0.83<br />wear: 2.768861","x: 0.84<br />value: 2.758038<br />x: 0.84<br />wear: 2.758038","x: 0.85<br />value: 2.747122<br />x: 0.85<br />wear: 2.747122","x: 0.86<br />value: 2.736115<br />x: 0.86<br />wear: 2.736115","x: 0.87<br />value: 2.725020<br />x: 0.87<br />wear: 2.725020","x: 0.88<br />value: 2.713841<br />x: 0.88<br />wear: 2.713841","x: 0.89<br />value: 2.702582<br />x: 0.89<br />wear: 2.702582","x: 0.90<br />value: 2.691251<br />x: 0.90<br />wear: 2.691251","x: 0.91<br />value: 2.679855<br />x: 0.91<br />wear: 2.679855","x: 0.92<br />value: 2.668401<br />x: 0.92<br />wear: 2.668401","x: 0.93<br />value: 2.656895<br />x: 0.93<br />wear: 2.656895","x: 0.94<br />value: 2.645345<br />x: 0.94<br />wear: 2.645345","x: 0.95<br />value: 2.633758<br />x: 0.95<br />wear: 2.633758","x: 0.96<br />value: 2.622139<br />x: 0.96<br />wear: 2.622139","x: 0.97<br />value: 2.610496<br />x: 0.97<br />wear: 2.610496","x: 0.98<br />value: 2.598835<br />x: 0.98<br />wear: 2.598835","x: 0.99<br />value: 2.587161<br />x: 0.99<br />wear: 2.587161","x: 1.00<br />value: 2.575482<br />x: 1.00<br />wear: 2.575482"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(41,87,255,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,0.09,0.1,0.11,0.12,0.13,0.14,0.15,0.16,0.17,0.18,0.19,0.2,0.21,0.22,0.23,0.24,0.25,0.26,0.27,0.28,0.29,0.3,0.31,0.32,0.33,0.34,0.35,0.36,0.37,0.38,0.39,0.4,0.41,0.42,0.43,0.44,0.45,0.46,0.47,0.48,0.49,0.5,0.51,0.52,0.53,0.54,0.55,0.56,0.57,0.58,0.59,0.6,0.61,0.62,0.63,0.64,0.65,0.66,0.67,0.68,0.69,0.7,0.71,0.72,0.73,0.74,0.75,0.76,0.77,0.78,0.79,0.8,0.81,0.82,0.83,0.84,0.85,0.86,0.87,0.88,0.89,0.9,0.91,0.92,0.93,0.94,0.95,0.96,0.97,0.98,0.99,1],"y":[3.8325178352922,3.79954982259737,3.76661716939029,3.73375355069233,3.70099080392525,3.66835892891112,3.63588608787241,3.60359860543191,3.57152096861275,3.53967582683844,3.50808399193283,3.47676443812011,3.44573430202483,3.41501057845925,3.38464742774496,3.3547361757129,3.32536800638174,3.29663226617046,3.26861646389841,3.2414062707853,3.21508552045118,3.18973620891645,3.16543849460186,3.14227069832851,3.12030930331786,3.09962895519172,3.08029578256805,3.06234735884836,3.04581274043035,3.03071914611203,3.0170919570918,3.00495471696837,2.99432913174084,2.98523506980864,2.97769056197156,2.97171180142972,2.96731314378362,2.96450710703408,2.96330171407731,2.96364202759474,2.96541015005313,2.96848368881455,2.97273841364142,2.97804825669654,2.98428531254303,2.99131983814439,2.99902025286443,3.00725313846736,3.01588323911771,3.02477346138036,3.03378487422056,3.04278363332021,3.05166175402683,3.06031633840462,3.06864265091812,3.07653411843222,3.08388233021218,3.09057703792358,3.09650615563238,3.10155575980487,3.1056100893077,3.10855154540787,3.11026069177274,3.11061995508024,3.10959503844437,3.10723492141517,3.10359044655325,3.09871061881961,3.09264260557556,3.08543173658281,3.07712150400337,3.06775356239963,3.05736772873432,3.04600198237054,3.03369246507171,3.02047348100163,3.00637785815456,2.99143803264558,2.97568496442026,2.95914777582453,2.94185375160464,2.92382833890722,2.90509514727924,2.88567594866801,2.86559067742121,2.84485743028685,2.82349246641332,2.80151020734933,2.77892425069119,2.75576967032185,2.73210301641092,2.70798001517556,2.68345455523333,2.65857868760209,2.63340262570009,2.60797474534591,2.58234158475847,2.55654784455708,2.53063638776137,2.50464823979133,2.47862258846729],"text":["x: 0.00<br />value: 3.832518<br />x: 0.00<br />wear: 3.832518","x: 0.01<br />value: 3.799550<br />x: 0.01<br />wear: 3.799550","x: 0.02<br />value: 3.766617<br />x: 0.02<br />wear: 3.766617","x: 0.03<br />value: 3.733754<br />x: 0.03<br />wear: 3.733754","x: 0.04<br />value: 3.700991<br />x: 0.04<br />wear: 3.700991","x: 0.05<br />value: 3.668359<br />x: 0.05<br />wear: 3.668359","x: 0.06<br />value: 3.635886<br />x: 0.06<br />wear: 3.635886","x: 0.07<br />value: 3.603599<br />x: 0.07<br />wear: 3.603599","x: 0.08<br />value: 3.571521<br />x: 0.08<br />wear: 3.571521","x: 0.09<br />value: 3.539676<br />x: 0.09<br />wear: 3.539676","x: 0.10<br />value: 3.508084<br />x: 0.10<br />wear: 3.508084","x: 0.11<br />value: 3.476764<br />x: 0.11<br />wear: 3.476764","x: 0.12<br />value: 3.445734<br />x: 0.12<br />wear: 3.445734","x: 0.13<br />value: 3.415011<br />x: 0.13<br />wear: 3.415011","x: 0.14<br />value: 3.384647<br />x: 0.14<br />wear: 3.384647","x: 0.15<br />value: 3.354736<br />x: 0.15<br />wear: 3.354736","x: 0.16<br />value: 3.325368<br />x: 0.16<br />wear: 3.325368","x: 0.17<br />value: 3.296632<br />x: 0.17<br />wear: 3.296632","x: 0.18<br />value: 3.268616<br />x: 0.18<br />wear: 3.268616","x: 0.19<br />value: 3.241406<br />x: 0.19<br />wear: 3.241406","x: 0.20<br />value: 3.215086<br />x: 0.20<br />wear: 3.215086","x: 0.21<br />value: 3.189736<br />x: 0.21<br />wear: 3.189736","x: 0.22<br />value: 3.165438<br />x: 0.22<br />wear: 3.165438","x: 0.23<br />value: 3.142271<br />x: 0.23<br />wear: 3.142271","x: 0.24<br />value: 3.120309<br />x: 0.24<br />wear: 3.120309","x: 0.25<br />value: 3.099629<br />x: 0.25<br />wear: 3.099629","x: 0.26<br />value: 3.080296<br />x: 0.26<br />wear: 3.080296","x: 0.27<br />value: 3.062347<br />x: 0.27<br />wear: 3.062347","x: 0.28<br />value: 3.045813<br />x: 0.28<br />wear: 3.045813","x: 0.29<br />value: 3.030719<br />x: 0.29<br />wear: 3.030719","x: 0.30<br />value: 3.017092<br />x: 0.30<br />wear: 3.017092","x: 0.31<br />value: 3.004955<br />x: 0.31<br />wear: 3.004955","x: 0.32<br />value: 2.994329<br />x: 0.32<br />wear: 2.994329","x: 0.33<br />value: 2.985235<br />x: 0.33<br />wear: 2.985235","x: 0.34<br />value: 2.977691<br />x: 0.34<br />wear: 2.977691","x: 0.35<br />value: 2.971712<br />x: 0.35<br />wear: 2.971712","x: 0.36<br />value: 2.967313<br />x: 0.36<br />wear: 2.967313","x: 0.37<br />value: 2.964507<br />x: 0.37<br />wear: 2.964507","x: 0.38<br />value: 2.963302<br />x: 0.38<br />wear: 2.963302","x: 0.39<br />value: 2.963642<br />x: 0.39<br />wear: 2.963642","x: 0.40<br />value: 2.965410<br />x: 0.40<br />wear: 2.965410","x: 0.41<br />value: 2.968484<br />x: 0.41<br />wear: 2.968484","x: 0.42<br />value: 2.972738<br />x: 0.42<br />wear: 2.972738","x: 0.43<br />value: 2.978048<br />x: 0.43<br />wear: 2.978048","x: 0.44<br />value: 2.984285<br />x: 0.44<br />wear: 2.984285","x: 0.45<br />value: 2.991320<br />x: 0.45<br />wear: 2.991320","x: 0.46<br />value: 2.999020<br />x: 0.46<br />wear: 2.999020","x: 0.47<br />value: 3.007253<br />x: 0.47<br />wear: 3.007253","x: 0.48<br />value: 3.015883<br />x: 0.48<br />wear: 3.015883","x: 0.49<br />value: 3.024773<br />x: 0.49<br />wear: 3.024773","x: 0.50<br />value: 3.033785<br />x: 0.50<br />wear: 3.033785","x: 0.51<br />value: 3.042784<br />x: 0.51<br />wear: 3.042784","x: 0.52<br />value: 3.051662<br />x: 0.52<br />wear: 3.051662","x: 0.53<br />value: 3.060316<br />x: 0.53<br />wear: 3.060316","x: 0.54<br />value: 3.068643<br />x: 0.54<br />wear: 3.068643","x: 0.55<br />value: 3.076534<br />x: 0.55<br />wear: 3.076534","x: 0.56<br />value: 3.083882<br />x: 0.56<br />wear: 3.083882","x: 0.57<br />value: 3.090577<br />x: 0.57<br />wear: 3.090577","x: 0.58<br />value: 3.096506<br />x: 0.58<br />wear: 3.096506","x: 0.59<br />value: 3.101556<br />x: 0.59<br />wear: 3.101556","x: 0.60<br />value: 3.105610<br />x: 0.60<br />wear: 3.105610","x: 0.61<br />value: 3.108552<br />x: 0.61<br />wear: 3.108552","x: 0.62<br />value: 3.110261<br />x: 0.62<br />wear: 3.110261","x: 0.63<br />value: 3.110620<br />x: 0.63<br />wear: 3.110620","x: 0.64<br />value: 3.109595<br />x: 0.64<br />wear: 3.109595","x: 0.65<br />value: 3.107235<br />x: 0.65<br />wear: 3.107235","x: 0.66<br />value: 3.103590<br />x: 0.66<br />wear: 3.103590","x: 0.67<br />value: 3.098711<br />x: 0.67<br />wear: 3.098711","x: 0.68<br />value: 3.092643<br />x: 0.68<br />wear: 3.092643","x: 0.69<br />value: 3.085432<br />x: 0.69<br />wear: 3.085432","x: 0.70<br />value: 3.077122<br />x: 0.70<br />wear: 3.077122","x: 0.71<br />value: 3.067754<br />x: 0.71<br />wear: 3.067754","x: 0.72<br />value: 3.057368<br />x: 0.72<br />wear: 3.057368","x: 0.73<br />value: 3.046002<br />x: 0.73<br />wear: 3.046002","x: 0.74<br />value: 3.033692<br />x: 0.74<br />wear: 3.033692","x: 0.75<br />value: 3.020473<br />x: 0.75<br />wear: 3.020473","x: 0.76<br />value: 3.006378<br />x: 0.76<br />wear: 3.006378","x: 0.77<br />value: 2.991438<br />x: 0.77<br />wear: 2.991438","x: 0.78<br />value: 2.975685<br />x: 0.78<br />wear: 2.975685","x: 0.79<br />value: 2.959148<br />x: 0.79<br />wear: 2.959148","x: 0.80<br />value: 2.941854<br />x: 0.80<br />wear: 2.941854","x: 0.81<br />value: 2.923828<br />x: 0.81<br />wear: 2.923828","x: 0.82<br />value: 2.905095<br />x: 0.82<br />wear: 2.905095","x: 0.83<br />value: 2.885676<br />x: 0.83<br />wear: 2.885676","x: 0.84<br />value: 2.865591<br />x: 0.84<br />wear: 2.865591","x: 0.85<br />value: 2.844857<br />x: 0.85<br />wear: 2.844857","x: 0.86<br />value: 2.823492<br />x: 0.86<br />wear: 2.823492","x: 0.87<br />value: 2.801510<br />x: 0.87<br />wear: 2.801510","x: 0.88<br />value: 2.778924<br />x: 0.88<br />wear: 2.778924","x: 0.89<br />value: 2.755770<br />x: 0.89<br />wear: 2.755770","x: 0.90<br />value: 2.732103<br />x: 0.90<br />wear: 2.732103","x: 0.91<br />value: 2.707980<br />x: 0.91<br />wear: 2.707980","x: 0.92<br />value: 2.683455<br />x: 0.92<br />wear: 2.683455","x: 0.93<br />value: 2.658579<br />x: 0.93<br />wear: 2.658579","x: 0.94<br />value: 2.633403<br />x: 0.94<br />wear: 2.633403","x: 0.95<br />value: 2.607975<br />x: 0.95<br />wear: 2.607975","x: 0.96<br />value: 2.582342<br />x: 0.96<br />wear: 2.582342","x: 0.97<br />value: 2.556548<br />x: 0.97<br />wear: 2.556548","x: 0.98<br />value: 2.530636<br />x: 0.98<br />wear: 2.530636","x: 0.99<br />value: 2.504648<br />x: 0.99<br />wear: 2.504648","x: 1.00<br />value: 2.478623<br />x: 1.00<br />wear: 2.478623"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(41,87,255,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,0.09,0.1,0.11,0.12,0.13,0.14,0.15,0.16,0.17,0.18,0.19,0.2,0.21,0.22,0.23,0.24,0.25,0.26,0.27,0.28,0.29,0.3,0.31,0.32,0.33,0.34,0.35,0.36,0.37,0.38,0.39,0.4,0.41,0.42,0.43,0.44,0.45,0.46,0.47,0.48,0.49,0.5,0.51,0.52,0.53,0.54,0.55,0.56,0.57,0.58,0.59,0.6,0.61,0.62,0.63,0.64,0.65,0.66,0.67,0.68,0.69,0.7,0.71,0.72,0.73,0.74,0.75,0.76,0.77,0.78,0.79,0.8,0.81,0.82,0.83,0.84,0.85,0.86,0.87,0.88,0.89,0.9,0.91,0.92,0.93,0.94,0.95,0.96,0.97,0.98,0.99,1],"y":[4.16230300788833,4.1098658484628,4.05743943167668,4.0050161369675,3.95256831118888,3.90004826861056,3.84738829091836,3.79450062721426,3.74127749401629,3.68759107525862,3.63329352229153,3.57821695388139,3.5221734562107,3.46497084644372,3.40675947117121,3.34803220641048,3.28927765916058,3.23096440383669,3.17354098227008,3.11743590370814,3.06305764481437,3.01079464966837,2.96101532976585,2.91406806401863,2.87028119875463,2.8299630477179,2.79337780769619,2.76067330540391,2.73195325059916,2.7073013204562,2.68678115956536,2.67043637993309,2.65829056098195,2.6503472495506,2.64658995989382,2.64698217368248,2.65146734000357,2.6599688753602,2.6723875358203,2.68854360428887,2.70817689050796,2.73100454378448,2.75672368084144,2.78501138581794,2.81552471026922,2.84790067316661,2.88175626089755,2.91668842726557,2.95227409349035,2.98807014820763,3.0236134474693,3.05848310247886,3.09248734279802,3.12547665314013,3.15728148563466,3.18771225982716,3.21655936267931,3.24359314856889,3.2685639392898,3.29120202405202,3.31121765948167,3.32830106962095,3.34212244592819,3.35234578657642,3.3589333610228,3.36214571000856,3.36223718098969,3.35944208883827,3.35397471584248,3.34602931170662,3.3357800935511,3.32338124591241,3.30896692074319,3.29265123741216,3.27452828270414,3.2546721108201,3.23314803811969,3.21004652734914,3.18544930341344,3.15941805863365,3.13199445274695,3.10320011290664,3.0730366336821,3.04148557705885,3.0085084724385,2.97404681663876,2.93802207389347,2.90033567585256,2.86087759385561,2.81971492894971,2.77709191188942,2.73324131311898,2.68837587049872,2.64268828930507,2.59635124223058,2.5495173693839,2.50231927828981,2.45486954388917,2.40726070853895,2.35956528201224,2.31183574149825],"text":["x: 0.00<br />value: 4.162303<br />x: 0.00<br />wear: 4.162303","x: 0.01<br />value: 4.109866<br />x: 0.01<br />wear: 4.109866","x: 0.02<br />value: 4.057439<br />x: 0.02<br />wear: 4.057439","x: 0.03<br />value: 4.005016<br />x: 0.03<br />wear: 4.005016","x: 0.04<br />value: 3.952568<br />x: 0.04<br />wear: 3.952568","x: 0.05<br />value: 3.900048<br />x: 0.05<br />wear: 3.900048","x: 0.06<br />value: 3.847388<br />x: 0.06<br />wear: 3.847388","x: 0.07<br />value: 3.794501<br />x: 0.07<br />wear: 3.794501","x: 0.08<br />value: 3.741277<br />x: 0.08<br />wear: 3.741277","x: 0.09<br />value: 3.687591<br />x: 0.09<br />wear: 3.687591","x: 0.10<br />value: 3.633294<br />x: 0.10<br />wear: 3.633294","x: 0.11<br />value: 3.578217<br />x: 0.11<br />wear: 3.578217","x: 0.12<br />value: 3.522173<br />x: 0.12<br />wear: 3.522173","x: 0.13<br />value: 3.464971<br />x: 0.13<br />wear: 3.464971","x: 0.14<br />value: 3.406759<br />x: 0.14<br />wear: 3.406759","x: 0.15<br />value: 3.348032<br />x: 0.15<br />wear: 3.348032","x: 0.16<br />value: 3.289278<br />x: 0.16<br />wear: 3.289278","x: 0.17<br />value: 3.230964<br />x: 0.17<br />wear: 3.230964","x: 0.18<br />value: 3.173541<br />x: 0.18<br />wear: 3.173541","x: 0.19<br />value: 3.117436<br />x: 0.19<br />wear: 3.117436","x: 0.20<br />value: 3.063058<br />x: 0.20<br />wear: 3.063058","x: 0.21<br />value: 3.010795<br />x: 0.21<br />wear: 3.010795","x: 0.22<br />value: 2.961015<br />x: 0.22<br />wear: 2.961015","x: 0.23<br />value: 2.914068<br />x: 0.23<br />wear: 2.914068","x: 0.24<br />value: 2.870281<br />x: 0.24<br />wear: 2.870281","x: 0.25<br />value: 2.829963<br />x: 0.25<br />wear: 2.829963","x: 0.26<br />value: 2.793378<br />x: 0.26<br />wear: 2.793378","x: 0.27<br />value: 2.760673<br />x: 0.27<br />wear: 2.760673","x: 0.28<br />value: 2.731953<br />x: 0.28<br />wear: 2.731953","x: 0.29<br />value: 2.707301<br />x: 0.29<br />wear: 2.707301","x: 0.30<br />value: 2.686781<br />x: 0.30<br />wear: 2.686781","x: 0.31<br />value: 2.670436<br />x: 0.31<br />wear: 2.670436","x: 0.32<br />value: 2.658291<br />x: 0.32<br />wear: 2.658291","x: 0.33<br />value: 2.650347<br />x: 0.33<br />wear: 2.650347","x: 0.34<br />value: 2.646590<br />x: 0.34<br />wear: 2.646590","x: 0.35<br />value: 2.646982<br />x: 0.35<br />wear: 2.646982","x: 0.36<br />value: 2.651467<br />x: 0.36<br />wear: 2.651467","x: 0.37<br />value: 2.659969<br />x: 0.37<br />wear: 2.659969","x: 0.38<br />value: 2.672388<br />x: 0.38<br />wear: 2.672388","x: 0.39<br />value: 2.688544<br />x: 0.39<br />wear: 2.688544","x: 0.40<br />value: 2.708177<br />x: 0.40<br />wear: 2.708177","x: 0.41<br />value: 2.731005<br />x: 0.41<br />wear: 2.731005","x: 0.42<br />value: 2.756724<br />x: 0.42<br />wear: 2.756724","x: 0.43<br />value: 2.785011<br />x: 0.43<br />wear: 2.785011","x: 0.44<br />value: 2.815525<br />x: 0.44<br />wear: 2.815525","x: 0.45<br />value: 2.847901<br />x: 0.45<br />wear: 2.847901","x: 0.46<br />value: 2.881756<br />x: 0.46<br />wear: 2.881756","x: 0.47<br />value: 2.916688<br />x: 0.47<br />wear: 2.916688","x: 0.48<br />value: 2.952274<br />x: 0.48<br />wear: 2.952274","x: 0.49<br />value: 2.988070<br />x: 0.49<br />wear: 2.988070","x: 0.50<br />value: 3.023613<br />x: 0.50<br />wear: 3.023613","x: 0.51<br />value: 3.058483<br />x: 0.51<br />wear: 3.058483","x: 0.52<br />value: 3.092487<br />x: 0.52<br />wear: 3.092487","x: 0.53<br />value: 3.125477<br />x: 0.53<br />wear: 3.125477","x: 0.54<br />value: 3.157281<br />x: 0.54<br />wear: 3.157281","x: 0.55<br />value: 3.187712<br />x: 0.55<br />wear: 3.187712","x: 0.56<br />value: 3.216559<br />x: 0.56<br />wear: 3.216559","x: 0.57<br />value: 3.243593<br />x: 0.57<br />wear: 3.243593","x: 0.58<br />value: 3.268564<br />x: 0.58<br />wear: 3.268564","x: 0.59<br />value: 3.291202<br />x: 0.59<br />wear: 3.291202","x: 0.60<br />value: 3.311218<br />x: 0.60<br />wear: 3.311218","x: 0.61<br />value: 3.328301<br />x: 0.61<br />wear: 3.328301","x: 0.62<br />value: 3.342122<br />x: 0.62<br />wear: 3.342122","x: 0.63<br />value: 3.352346<br />x: 0.63<br />wear: 3.352346","x: 0.64<br />value: 3.358933<br />x: 0.64<br />wear: 3.358933","x: 0.65<br />value: 3.362146<br />x: 0.65<br />wear: 3.362146","x: 0.66<br />value: 3.362237<br />x: 0.66<br />wear: 3.362237","x: 0.67<br />value: 3.359442<br />x: 0.67<br />wear: 3.359442","x: 0.68<br />value: 3.353975<br />x: 0.68<br />wear: 3.353975","x: 0.69<br />value: 3.346029<br />x: 0.69<br />wear: 3.346029","x: 0.70<br />value: 3.335780<br />x: 0.70<br />wear: 3.335780","x: 0.71<br />value: 3.323381<br />x: 0.71<br />wear: 3.323381","x: 0.72<br />value: 3.308967<br />x: 0.72<br />wear: 3.308967","x: 0.73<br />value: 3.292651<br />x: 0.73<br />wear: 3.292651","x: 0.74<br />value: 3.274528<br />x: 0.74<br />wear: 3.274528","x: 0.75<br />value: 3.254672<br />x: 0.75<br />wear: 3.254672","x: 0.76<br />value: 3.233148<br />x: 0.76<br />wear: 3.233148","x: 0.77<br />value: 3.210047<br />x: 0.77<br />wear: 3.210047","x: 0.78<br />value: 3.185449<br />x: 0.78<br />wear: 3.185449","x: 0.79<br />value: 3.159418<br />x: 0.79<br />wear: 3.159418","x: 0.80<br />value: 3.131994<br />x: 0.80<br />wear: 3.131994","x: 0.81<br />value: 3.103200<br />x: 0.81<br />wear: 3.103200","x: 0.82<br />value: 3.073037<br />x: 0.82<br />wear: 3.073037","x: 0.83<br />value: 3.041486<br />x: 0.83<br />wear: 3.041486","x: 0.84<br />value: 3.008508<br />x: 0.84<br />wear: 3.008508","x: 0.85<br />value: 2.974047<br />x: 0.85<br />wear: 2.974047","x: 0.86<br />value: 2.938022<br />x: 0.86<br />wear: 2.938022","x: 0.87<br />value: 2.900336<br />x: 0.87<br />wear: 2.900336","x: 0.88<br />value: 2.860878<br />x: 0.88<br />wear: 2.860878","x: 0.89<br />value: 2.819715<br />x: 0.89<br />wear: 2.819715","x: 0.90<br />value: 2.777092<br />x: 0.90<br />wear: 2.777092","x: 0.91<br />value: 2.733241<br />x: 0.91<br />wear: 2.733241","x: 0.92<br />value: 2.688376<br />x: 0.92<br />wear: 2.688376","x: 0.93<br />value: 2.642688<br />x: 0.93<br />wear: 2.642688","x: 0.94<br />value: 2.596351<br />x: 0.94<br />wear: 2.596351","x: 0.95<br />value: 2.549517<br />x: 0.95<br />wear: 2.549517","x: 0.96<br />value: 2.502319<br />x: 0.96<br />wear: 2.502319","x: 0.97<br />value: 2.454870<br />x: 0.97<br />wear: 2.454870","x: 0.98<br />value: 2.407261<br />x: 0.98<br />wear: 2.407261","x: 0.99<br />value: 2.359565<br />x: 0.99<br />wear: 2.359565","x: 1.00<br />value: 2.311836<br />x: 1.00<br />wear: 2.311836"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(41,87,255,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x3","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,0.09,0.1,0.11,0.12,0.13,0.14,0.15,0.16,0.17,0.18,0.19,0.2,0.21,0.22,0.23,0.24,0.25,0.26,0.27,0.28,0.29,0.3,0.31,0.32,0.33,0.34,0.35,0.36,0.37,0.38,0.39,0.4,0.41,0.42,0.43,0.44,0.45,0.46,0.47,0.48,0.49,0.5,0.51,0.52,0.53,0.54,0.55,0.56,0.57,0.58,0.59,0.6,0.61,0.62,0.63,0.64,0.65,0.66,0.67,0.68,0.69,0.7,0.71,0.72,0.73,0.74,0.75,0.76,0.77,0.78,0.79,0.8,0.81,0.82,0.83,0.84,0.85,0.86,0.87,0.88,0.89,0.9,0.91,0.92,0.93,0.94,0.95,0.96,0.97,0.98,0.99,1],"y":[4.12792502983734,4.11223282943418,4.09627624942549,4.07968279462385,4.06196202557078,4.04250555853663,4.02058706552065,3.99536227425098,3.96586896818464,3.93102698650752,3.8896382241344,3.84038663170896,3.78183821560374,3.71252700846025,3.63284642107076,3.5450492423783,3.45135628759488,3.35387042766138,3.25457658924755,3.15534175475205,3.0579149623024,2.96392730575502,2.87489193469519,2.7922040544371,2.7171409260238,2.65086186622723,2.59425694324698,2.54749306380655,2.5104678860571,2.48296112387865,2.46463454688013,2.45503198039933,2.45357930550293,2.4595844589865,2.47223743337448,2.4906102769202,2.51365709360586,2.54021404314257,2.56903752714676,2.59964428502227,2.63231139396035,2.66723617305761,2.70449799713952,2.74405829676043,2.78576055820361,2.82933032348117,2.87437519033412,2.92038481223235,2.96673089837463,3.01266721368863,3.05732957883088,3.09995545317883,3.14054268380698,3.17919075651072,3.21588121281432,3.25047764997096,3.2827257209627,3.31225313450044,3.33856965502402,3.36106710270212,3.37901935343233,3.3915823388411,3.39779404628377,3.39663116297643,3.38825524689659,3.37401272678325,3.3551887312361,3.33295044458373,3.30834710688363,3.28231001392215,3.25565251721453,3.22907002400488,3.20313999726623,3.17832195570045,3.15495747373831,3.13327018153947,3.11336667310586,3.09523923062196,3.07876310011452,3.06369558333918,3.04967603778046,3.03622587665176,3.02274856889537,3.00852963918246,2.99273666791308,2.97441929121617,2.95250920094953,2.92582014469987,2.89310419381535,2.85428964012232,2.81048099592534,2.76272109729043,2.71193483601246,2.65892915961524,2.60439307135142,2.54889763020254,2.49289595087903,2.43672320382019,2.38059661519423,2.32461546689821,2.2687610965581],"text":["x: 0.00<br />value: 4.127925<br />x: 0.00<br />wear: 4.127925","x: 0.01<br />value: 4.112233<br />x: 0.01<br />wear: 4.112233","x: 0.02<br />value: 4.096276<br />x: 0.02<br />wear: 4.096276","x: 0.03<br />value: 4.079683<br />x: 0.03<br />wear: 4.079683","x: 0.04<br />value: 4.061962<br />x: 0.04<br />wear: 4.061962","x: 0.05<br />value: 4.042506<br />x: 0.05<br />wear: 4.042506","x: 0.06<br />value: 4.020587<br />x: 0.06<br />wear: 4.020587","x: 0.07<br />value: 3.995362<br />x: 0.07<br />wear: 3.995362","x: 0.08<br />value: 3.965869<br />x: 0.08<br />wear: 3.965869","x: 0.09<br />value: 3.931027<br />x: 0.09<br />wear: 3.931027","x: 0.10<br />value: 3.889638<br />x: 0.10<br />wear: 3.889638","x: 0.11<br />value: 3.840387<br />x: 0.11<br />wear: 3.840387","x: 0.12<br />value: 3.781838<br />x: 0.12<br />wear: 3.781838","x: 0.13<br />value: 3.712527<br />x: 0.13<br />wear: 3.712527","x: 0.14<br />value: 3.632846<br />x: 0.14<br />wear: 3.632846","x: 0.15<br />value: 3.545049<br />x: 0.15<br />wear: 3.545049","x: 0.16<br />value: 3.451356<br />x: 0.16<br />wear: 3.451356","x: 0.17<br />value: 3.353870<br />x: 0.17<br />wear: 3.353870","x: 0.18<br />value: 3.254577<br />x: 0.18<br />wear: 3.254577","x: 0.19<br />value: 3.155342<br />x: 0.19<br />wear: 3.155342","x: 0.20<br />value: 3.057915<br />x: 0.20<br />wear: 3.057915","x: 0.21<br />value: 2.963927<br />x: 0.21<br />wear: 2.963927","x: 0.22<br />value: 2.874892<br />x: 0.22<br />wear: 2.874892","x: 0.23<br />value: 2.792204<br />x: 0.23<br />wear: 2.792204","x: 0.24<br />value: 2.717141<br />x: 0.24<br />wear: 2.717141","x: 0.25<br />value: 2.650862<br />x: 0.25<br />wear: 2.650862","x: 0.26<br />value: 2.594257<br />x: 0.26<br />wear: 2.594257","x: 0.27<br />value: 2.547493<br />x: 0.27<br />wear: 2.547493","x: 0.28<br />value: 2.510468<br />x: 0.28<br />wear: 2.510468","x: 0.29<br />value: 2.482961<br />x: 0.29<br />wear: 2.482961","x: 0.30<br />value: 2.464635<br />x: 0.30<br />wear: 2.464635","x: 0.31<br />value: 2.455032<br />x: 0.31<br />wear: 2.455032","x: 0.32<br />value: 2.453579<br />x: 0.32<br />wear: 2.453579","x: 0.33<br />value: 2.459584<br />x: 0.33<br />wear: 2.459584","x: 0.34<br />value: 2.472237<br />x: 0.34<br />wear: 2.472237","x: 0.35<br />value: 2.490610<br />x: 0.35<br />wear: 2.490610","x: 0.36<br />value: 2.513657<br />x: 0.36<br />wear: 2.513657","x: 0.37<br />value: 2.540214<br />x: 0.37<br />wear: 2.540214","x: 0.38<br />value: 2.569038<br />x: 0.38<br />wear: 2.569038","x: 0.39<br />value: 2.599644<br />x: 0.39<br />wear: 2.599644","x: 0.40<br />value: 2.632311<br />x: 0.40<br />wear: 2.632311","x: 0.41<br />value: 2.667236<br />x: 0.41<br />wear: 2.667236","x: 0.42<br />value: 2.704498<br />x: 0.42<br />wear: 2.704498","x: 0.43<br />value: 2.744058<br />x: 0.43<br />wear: 2.744058","x: 0.44<br />value: 2.785761<br />x: 0.44<br />wear: 2.785761","x: 0.45<br />value: 2.829330<br />x: 0.45<br />wear: 2.829330","x: 0.46<br />value: 2.874375<br />x: 0.46<br />wear: 2.874375","x: 0.47<br />value: 2.920385<br />x: 0.47<br />wear: 2.920385","x: 0.48<br />value: 2.966731<br />x: 0.48<br />wear: 2.966731","x: 0.49<br />value: 3.012667<br />x: 0.49<br />wear: 3.012667","x: 0.50<br />value: 3.057330<br />x: 0.50<br />wear: 3.057330","x: 0.51<br />value: 3.099955<br />x: 0.51<br />wear: 3.099955","x: 0.52<br />value: 3.140543<br />x: 0.52<br />wear: 3.140543","x: 0.53<br />value: 3.179191<br />x: 0.53<br />wear: 3.179191","x: 0.54<br />value: 3.215881<br />x: 0.54<br />wear: 3.215881","x: 0.55<br />value: 3.250478<br />x: 0.55<br />wear: 3.250478","x: 0.56<br />value: 3.282726<br />x: 0.56<br />wear: 3.282726","x: 0.57<br />value: 3.312253<br />x: 0.57<br />wear: 3.312253","x: 0.58<br />value: 3.338570<br />x: 0.58<br />wear: 3.338570","x: 0.59<br />value: 3.361067<br />x: 0.59<br />wear: 3.361067","x: 0.60<br />value: 3.379019<br />x: 0.60<br />wear: 3.379019","x: 0.61<br />value: 3.391582<br />x: 0.61<br />wear: 3.391582","x: 0.62<br />value: 3.397794<br />x: 0.62<br />wear: 3.397794","x: 0.63<br />value: 3.396631<br />x: 0.63<br />wear: 3.396631","x: 0.64<br />value: 3.388255<br />x: 0.64<br />wear: 3.388255","x: 0.65<br />value: 3.374013<br />x: 0.65<br />wear: 3.374013","x: 0.66<br />value: 3.355189<br />x: 0.66<br />wear: 3.355189","x: 0.67<br />value: 3.332950<br />x: 0.67<br />wear: 3.332950","x: 0.68<br />value: 3.308347<br />x: 0.68<br />wear: 3.308347","x: 0.69<br />value: 3.282310<br />x: 0.69<br />wear: 3.282310","x: 0.70<br />value: 3.255653<br />x: 0.70<br />wear: 3.255653","x: 0.71<br />value: 3.229070<br />x: 0.71<br />wear: 3.229070","x: 0.72<br />value: 3.203140<br />x: 0.72<br />wear: 3.203140","x: 0.73<br />value: 3.178322<br />x: 0.73<br />wear: 3.178322","x: 0.74<br />value: 3.154957<br />x: 0.74<br />wear: 3.154957","x: 0.75<br />value: 3.133270<br />x: 0.75<br />wear: 3.133270","x: 0.76<br />value: 3.113367<br />x: 0.76<br />wear: 3.113367","x: 0.77<br />value: 3.095239<br />x: 0.77<br />wear: 3.095239","x: 0.78<br />value: 3.078763<br />x: 0.78<br />wear: 3.078763","x: 0.79<br />value: 3.063696<br />x: 0.79<br />wear: 3.063696","x: 0.80<br />value: 3.049676<br />x: 0.80<br />wear: 3.049676","x: 0.81<br />value: 3.036226<br />x: 0.81<br />wear: 3.036226","x: 0.82<br />value: 3.022749<br />x: 0.82<br />wear: 3.022749","x: 0.83<br />value: 3.008530<br />x: 0.83<br />wear: 3.008530","x: 0.84<br />value: 2.992737<br />x: 0.84<br />wear: 2.992737","x: 0.85<br />value: 2.974419<br />x: 0.85<br />wear: 2.974419","x: 0.86<br />value: 2.952509<br />x: 0.86<br />wear: 2.952509","x: 0.87<br />value: 2.925820<br />x: 0.87<br />wear: 2.925820","x: 0.88<br />value: 2.893104<br />x: 0.88<br />wear: 2.893104","x: 0.89<br />value: 2.854290<br />x: 0.89<br />wear: 2.854290","x: 0.90<br />value: 2.810481<br />x: 0.90<br />wear: 2.810481","x: 0.91<br />value: 2.762721<br />x: 0.91<br />wear: 2.762721","x: 0.92<br />value: 2.711935<br />x: 0.92<br />wear: 2.711935","x: 0.93<br />value: 2.658929<br />x: 0.93<br />wear: 2.658929","x: 0.94<br />value: 2.604393<br />x: 0.94<br />wear: 2.604393","x: 0.95<br />value: 2.548898<br />x: 0.95<br />wear: 2.548898","x: 0.96<br />value: 2.492896<br />x: 0.96<br />wear: 2.492896","x: 0.97<br />value: 2.436723<br />x: 0.97<br />wear: 2.436723","x: 0.98<br />value: 2.380597<br />x: 0.98<br />wear: 2.380597","x: 0.99<br />value: 2.324615<br />x: 0.99<br />wear: 2.324615","x: 1.00<br />value: 2.268761<br />x: 1.00<br />wear: 2.268761"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(41,87,255,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0,0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,0.09,0.1,0.11,0.12,0.13,0.14,0.15,0.16,0.17,0.18,0.19,0.2,0.21,0.22,0.23,0.24,0.25,0.26,0.27,0.28,0.29,0.3,0.31,0.32,0.33,0.34,0.35,0.36,0.37,0.38,0.39,0.4,0.41,0.42,0.43,0.44,0.45,0.46,0.47,0.48,0.49,0.5,0.51,0.52,0.53,0.54,0.55,0.56,0.57,0.58,0.59,0.6,0.61,0.62,0.63,0.64,0.65,0.66,0.67,0.68,0.69,0.7,0.71,0.72,0.73,0.74,0.75,0.76,0.77,0.78,0.79,0.8,0.81,0.82,0.83,0.84,0.85,0.86,0.87,0.88,0.89,0.9,0.91,0.92,0.93,0.94,0.95,0.96,0.97,0.98,0.99,1],"y":[4.03004773183526,4.05473101174749,4.07912920282822,4.10267185969263,4.12447723889788,4.14335229894307,4.15779270026923,4.16598280525929,4.16579567823814,4.15479308547256,4.1302254951713,4.08903207748501,4.0278407045063,3.94316690144253,3.83579077241865,3.71075700047713,3.57299792177528,3.42713457441229,3.27747669842932,3.12802273580942,2.98245983047759,2.84416382830076,2.7161992770878,2.60131942658946,2.50196622849848,2.42027033644949,2.35770786128363,2.31407063684214,2.28849595417276,2.27980980626518,2.28652688805099,2.30685059640372,2.33867303013883,2.3795749900137,2.42682597872766,2.47738420092194,2.52789656317972,2.5746986740261,2.61396651329083,2.6450531580878,2.67048878281505,2.69264393317528,2.7135778568131,2.73503850331507,2.75846252420964,2.78497527296723,2.81539080500018,2.85021187766274,2.88962995025109,2.93352518400336,2.98146644209962,3.03279927114734,3.08690984563801,3.14296102349057,3.19980436456585,3.25598013066667,3.30971728553772,3.35893349486566,3.40123512627909,3.43391724934847,3.45396363558626,3.45804675844681,3.44252779332641,3.40366261945201,3.34213386143298,3.26305088926113,3.17141777675892,3.07192729969075,2.96896093576291,2.86658886462369,2.76856996786323,2.67835182901364,2.59907073354897,2.53355166888517,2.48430832438013,2.45354309133368,2.44260313671899,2.45034862437685,2.47478449382139,2.51360438650869,2.56419064583676,2.62361431714552,2.68863514771682,2.75570158677447,2.82095078548417,2.88020859695356,2.92898957623222,2.96249698031166,2.97581458201181,2.96812657548448,2.94271757621332,2.90275271551038,2.85108582662968,2.79025944476718,2.72250480706075,2.64974185259016,2.57357922237717,2.49531425938541,2.41593300852049,2.3361102166299,2.25620933250312],"text":["x: 0.00<br />value: 4.030048<br />x: 0.00<br />wear: 4.030048","x: 0.01<br />value: 4.054731<br />x: 0.01<br />wear: 4.054731","x: 0.02<br />value: 4.079129<br />x: 0.02<br />wear: 4.079129","x: 0.03<br />value: 4.102672<br />x: 0.03<br />wear: 4.102672","x: 0.04<br />value: 4.124477<br />x: 0.04<br />wear: 4.124477","x: 0.05<br />value: 4.143352<br />x: 0.05<br />wear: 4.143352","x: 0.06<br />value: 4.157793<br />x: 0.06<br />wear: 4.157793","x: 0.07<br />value: 4.165983<br />x: 0.07<br />wear: 4.165983","x: 0.08<br />value: 4.165796<br />x: 0.08<br />wear: 4.165796","x: 0.09<br />value: 4.154793<br />x: 0.09<br />wear: 4.154793","x: 0.10<br />value: 4.130225<br />x: 0.10<br />wear: 4.130225","x: 0.11<br />value: 4.089032<br />x: 0.11<br />wear: 4.089032","x: 0.12<br />value: 4.027841<br />x: 0.12<br />wear: 4.027841","x: 0.13<br />value: 3.943167<br />x: 0.13<br />wear: 3.943167","x: 0.14<br />value: 3.835791<br />x: 0.14<br />wear: 3.835791","x: 0.15<br />value: 3.710757<br />x: 0.15<br />wear: 3.710757","x: 0.16<br />value: 3.572998<br />x: 0.16<br />wear: 3.572998","x: 0.17<br />value: 3.427135<br />x: 0.17<br />wear: 3.427135","x: 0.18<br />value: 3.277477<br />x: 0.18<br />wear: 3.277477","x: 0.19<br />value: 3.128023<br />x: 0.19<br />wear: 3.128023","x: 0.20<br />value: 2.982460<br />x: 0.20<br />wear: 2.982460","x: 0.21<br />value: 2.844164<br />x: 0.21<br />wear: 2.844164","x: 0.22<br />value: 2.716199<br />x: 0.22<br />wear: 2.716199","x: 0.23<br />value: 2.601319<br />x: 0.23<br />wear: 2.601319","x: 0.24<br />value: 2.501966<br />x: 0.24<br />wear: 2.501966","x: 0.25<br />value: 2.420270<br />x: 0.25<br />wear: 2.420270","x: 0.26<br />value: 2.357708<br />x: 0.26<br />wear: 2.357708","x: 0.27<br />value: 2.314071<br />x: 0.27<br />wear: 2.314071","x: 0.28<br />value: 2.288496<br />x: 0.28<br />wear: 2.288496","x: 0.29<br />value: 2.279810<br />x: 0.29<br />wear: 2.279810","x: 0.30<br />value: 2.286527<br />x: 0.30<br />wear: 2.286527","x: 0.31<br />value: 2.306851<br />x: 0.31<br />wear: 2.306851","x: 0.32<br />value: 2.338673<br />x: 0.32<br />wear: 2.338673","x: 0.33<br />value: 2.379575<br />x: 0.33<br />wear: 2.379575","x: 0.34<br />value: 2.426826<br />x: 0.34<br />wear: 2.426826","x: 0.35<br />value: 2.477384<br />x: 0.35<br />wear: 2.477384","x: 0.36<br />value: 2.527897<br />x: 0.36<br />wear: 2.527897","x: 0.37<br />value: 2.574699<br />x: 0.37<br />wear: 2.574699","x: 0.38<br />value: 2.613967<br />x: 0.38<br />wear: 2.613967","x: 0.39<br />value: 2.645053<br />x: 0.39<br />wear: 2.645053","x: 0.40<br />value: 2.670489<br />x: 0.40<br />wear: 2.670489","x: 0.41<br />value: 2.692644<br />x: 0.41<br />wear: 2.692644","x: 0.42<br />value: 2.713578<br />x: 0.42<br />wear: 2.713578","x: 0.43<br />value: 2.735039<br />x: 0.43<br />wear: 2.735039","x: 0.44<br />value: 2.758463<br />x: 0.44<br />wear: 2.758463","x: 0.45<br />value: 2.784975<br />x: 0.45<br />wear: 2.784975","x: 0.46<br />value: 2.815391<br />x: 0.46<br />wear: 2.815391","x: 0.47<br />value: 2.850212<br />x: 0.47<br />wear: 2.850212","x: 0.48<br />value: 2.889630<br />x: 0.48<br />wear: 2.889630","x: 0.49<br />value: 2.933525<br />x: 0.49<br />wear: 2.933525","x: 0.50<br />value: 2.981466<br />x: 0.50<br />wear: 2.981466","x: 0.51<br />value: 3.032799<br />x: 0.51<br />wear: 3.032799","x: 0.52<br />value: 3.086910<br />x: 0.52<br />wear: 3.086910","x: 0.53<br />value: 3.142961<br />x: 0.53<br />wear: 3.142961","x: 0.54<br />value: 3.199804<br />x: 0.54<br />wear: 3.199804","x: 0.55<br />value: 3.255980<br />x: 0.55<br />wear: 3.255980","x: 0.56<br />value: 3.309717<br />x: 0.56<br />wear: 3.309717","x: 0.57<br />value: 3.358933<br />x: 0.57<br />wear: 3.358933","x: 0.58<br />value: 3.401235<br />x: 0.58<br />wear: 3.401235","x: 0.59<br />value: 3.433917<br />x: 0.59<br />wear: 3.433917","x: 0.60<br />value: 3.453964<br />x: 0.60<br />wear: 3.453964","x: 0.61<br />value: 3.458047<br />x: 0.61<br />wear: 3.458047","x: 0.62<br />value: 3.442528<br />x: 0.62<br />wear: 3.442528","x: 0.63<br />value: 3.403663<br />x: 0.63<br />wear: 3.403663","x: 0.64<br />value: 3.342134<br />x: 0.64<br />wear: 3.342134","x: 0.65<br />value: 3.263051<br />x: 0.65<br />wear: 3.263051","x: 0.66<br />value: 3.171418<br />x: 0.66<br />wear: 3.171418","x: 0.67<br />value: 3.071927<br />x: 0.67<br />wear: 3.071927","x: 0.68<br />value: 2.968961<br />x: 0.68<br />wear: 2.968961","x: 0.69<br />value: 2.866589<br />x: 0.69<br />wear: 2.866589","x: 0.70<br />value: 2.768570<br />x: 0.70<br />wear: 2.768570","x: 0.71<br />value: 2.678352<br />x: 0.71<br />wear: 2.678352","x: 0.72<br />value: 2.599071<br />x: 0.72<br />wear: 2.599071","x: 0.73<br />value: 2.533552<br />x: 0.73<br />wear: 2.533552","x: 0.74<br />value: 2.484308<br />x: 0.74<br />wear: 2.484308","x: 0.75<br />value: 2.453543<br />x: 0.75<br />wear: 2.453543","x: 0.76<br />value: 2.442603<br />x: 0.76<br />wear: 2.442603","x: 0.77<br />value: 2.450349<br />x: 0.77<br />wear: 2.450349","x: 0.78<br />value: 2.474784<br />x: 0.78<br />wear: 2.474784","x: 0.79<br />value: 2.513604<br />x: 0.79<br />wear: 2.513604","x: 0.80<br />value: 2.564191<br />x: 0.80<br />wear: 2.564191","x: 0.81<br />value: 2.623614<br />x: 0.81<br />wear: 2.623614","x: 0.82<br />value: 2.688635<br />x: 0.82<br />wear: 2.688635","x: 0.83<br />value: 2.755702<br />x: 0.83<br />wear: 2.755702","x: 0.84<br />value: 2.820951<br />x: 0.84<br />wear: 2.820951","x: 0.85<br />value: 2.880209<br />x: 0.85<br />wear: 2.880209","x: 0.86<br />value: 2.928990<br />x: 0.86<br />wear: 2.928990","x: 0.87<br />value: 2.962497<br />x: 0.87<br />wear: 2.962497","x: 0.88<br />value: 2.975815<br />x: 0.88<br />wear: 2.975815","x: 0.89<br />value: 2.968127<br />x: 0.89<br />wear: 2.968127","x: 0.90<br />value: 2.942718<br />x: 0.90<br />wear: 2.942718","x: 0.91<br />value: 2.902753<br />x: 0.91<br />wear: 2.902753","x: 0.92<br />value: 2.851086<br />x: 0.92<br />wear: 2.851086","x: 0.93<br />value: 2.790259<br />x: 0.93<br />wear: 2.790259","x: 0.94<br />value: 2.722505<br />x: 0.94<br />wear: 2.722505","x: 0.95<br />value: 2.649742<br />x: 0.95<br />wear: 2.649742","x: 0.96<br />value: 2.573579<br />x: 0.96<br />wear: 2.573579","x: 0.97<br />value: 2.495314<br />x: 0.97<br />wear: 2.495314","x: 0.98<br />value: 2.415933<br />x: 0.98<br />wear: 2.415933","x: 0.99<br />value: 2.336110<br />x: 0.99<br />wear: 2.336110","x: 1.00<br />value: 2.256209<br />x: 1.00<br />wear: 2.256209"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(41,87,255,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x2","yaxis":"y2","hoverinfo":"text","frame":null},{"x":[0,0.01,0.02,0.03,0.04,0.05,0.06,0.07,0.08,0.09,0.1,0.11,0.12,0.13,0.14,0.15,0.16,0.17,0.18,0.19,0.2,0.21,0.22,0.23,0.24,0.25,0.26,0.27,0.28,0.29,0.3,0.31,0.32,0.33,0.34,0.35,0.36,0.37,0.38,0.39,0.4,0.41,0.42,0.43,0.44,0.45,0.46,0.47,0.48,0.49,0.5,0.51,0.52,0.53,0.54,0.55,0.56,0.57,0.58,0.59,0.6,0.61,0.62,0.63,0.64,0.65,0.66,0.67,0.68,0.69,0.7,0.71,0.72,0.73,0.74,0.75,0.76,0.77,0.78,0.79,0.8,0.81,0.82,0.83,0.84,0.85,0.86,0.87,0.88,0.89,0.9,0.91,0.92,0.93,0.94,0.95,0.96,0.97,0.98,0.99,1],"y":[4.00375711904849,4.03820817976194,4.07256239286233,4.10633768993216,4.13863176167645,4.16812205792257,4.19306578762045,4.21129991884234,4.22024117878306,4.21688605375978,4.1978107892122,4.15917138970241,4.09670361891502,4.00597406683154,3.88790362757054,3.74876749938756,3.5946717068351,3.43130203358815,3.26392402244417,3.09738297532297,2.93610395326693,2.78409177644079,2.6449310241318,2.52178603474961,2.41740090582635,2.3340994940166,2.27341730741446,2.23499718250483,2.21769360721214,2.21994082858327,2.23975285278755,2.27472344511678,2.32202612998516,2.3784141909294,2.44022067060859,2.50335837080436,2.56331985242069,2.61517743548407,2.65379858338807,2.67858435627487,2.69346941103532,2.70218354792735,2.70803632633134,2.7139170647501,2.72229484080891,2.73521849125549,2.75431661196002,2.7807975579151,2.8154494432358,2.85864014115965,2.91031728404663,2.96993642496095,3.03624552241656,3.10750045563164,3.18153686294679,3.25577014182516,3.32719544885228,3.39238769973609,3.44750156930711,3.48827149151814,3.51001165944459,3.5076160252842,3.47555830035721,3.40820231551213,3.30662995005378,3.17864113174325,3.03192590786986,2.87375408484548,2.71097522820434,2.55001866260318,2.39689347182113,2.2571884987598,2.13607234544328,2.03829337301807,1.9681797017531,1.92963921103981,1.92512062637454,1.9524967803061,2.00818135148819,2.08816777769701,2.1880292558312,2.30291874191184,2.42756895108243,2.55629235760901,2.68298119487996,2.80110745540619,2.90372289082101,2.98345901188021,3.03281063585508,3.05037392918007,3.04084640745282,3.00878889278642,2.95834196641646,2.89322596870099,2.81674099912047,2.73176691627781,2.64076333789841,2.54576964083008,2.44840496104311,2.34986819363021,2.25093799280656],"text":["x: 0.00<br />value: 4.003757<br />x: 0.00<br />wear: 4.003757","x: 0.01<br />value: 4.038208<br />x: 0.01<br />wear: 4.038208","x: 0.02<br />value: 4.072562<br />x: 0.02<br />wear: 4.072562","x: 0.03<br />value: 4.106338<br />x: 0.03<br />wear: 4.106338","x: 0.04<br />value: 4.138632<br />x: 0.04<br />wear: 4.138632","x: 0.05<br />value: 4.168122<br />x: 0.05<br />wear: 4.168122","x: 0.06<br />value: 4.193066<br />x: 0.06<br />wear: 4.193066","x: 0.07<br />value: 4.211300<br />x: 0.07<br />wear: 4.211300","x: 0.08<br />value: 4.220241<br />x: 0.08<br />wear: 4.220241","x: 0.09<br />value: 4.216886<br />x: 0.09<br />wear: 4.216886","x: 0.10<br />value: 4.197811<br />x: 0.10<br />wear: 4.197811","x: 0.11<br />value: 4.159171<br />x: 0.11<br />wear: 4.159171","x: 0.12<br />value: 4.096704<br />x: 0.12<br />wear: 4.096704","x: 0.13<br />value: 4.005974<br />x: 0.13<br />wear: 4.005974","x: 0.14<br />value: 3.887904<br />x: 0.14<br />wear: 3.887904","x: 0.15<br />value: 3.748767<br />x: 0.15<br />wear: 3.748767","x: 0.16<br />value: 3.594672<br />x: 0.16<br />wear: 3.594672","x: 0.17<br />value: 3.431302<br />x: 0.17<br />wear: 3.431302","x: 0.18<br />value: 3.263924<br />x: 0.18<br />wear: 3.263924","x: 0.19<br />value: 3.097383<br />x: 0.19<br />wear: 3.097383","x: 0.20<br />value: 2.936104<br />x: 0.20<br />wear: 2.936104","x: 0.21<br />value: 2.784092<br />x: 0.21<br />wear: 2.784092","x: 0.22<br />value: 2.644931<br />x: 0.22<br />wear: 2.644931","x: 0.23<br />value: 2.521786<br />x: 0.23<br />wear: 2.521786","x: 0.24<br />value: 2.417401<br />x: 0.24<br />wear: 2.417401","x: 0.25<br />value: 2.334099<br />x: 0.25<br />wear: 2.334099","x: 0.26<br />value: 2.273417<br />x: 0.26<br />wear: 2.273417","x: 0.27<br />value: 2.234997<br />x: 0.27<br />wear: 2.234997","x: 0.28<br />value: 2.217694<br />x: 0.28<br />wear: 2.217694","x: 0.29<br />value: 2.219941<br />x: 0.29<br />wear: 2.219941","x: 0.30<br />value: 2.239753<br />x: 0.30<br />wear: 2.239753","x: 0.31<br />value: 2.274723<br />x: 0.31<br />wear: 2.274723","x: 0.32<br />value: 2.322026<br />x: 0.32<br />wear: 2.322026","x: 0.33<br />value: 2.378414<br />x: 0.33<br />wear: 2.378414","x: 0.34<br />value: 2.440221<br />x: 0.34<br />wear: 2.440221","x: 0.35<br />value: 2.503358<br />x: 0.35<br />wear: 2.503358","x: 0.36<br />value: 2.563320<br />x: 0.36<br />wear: 2.563320","x: 0.37<br />value: 2.615177<br />x: 0.37<br />wear: 2.615177","x: 0.38<br />value: 2.653799<br />x: 0.38<br />wear: 2.653799","x: 0.39<br />value: 2.678584<br />x: 0.39<br />wear: 2.678584","x: 0.40<br />value: 2.693469<br />x: 0.40<br />wear: 2.693469","x: 0.41<br />value: 2.702184<br />x: 0.41<br />wear: 2.702184","x: 0.42<br />value: 2.708036<br />x: 0.42<br />wear: 2.708036","x: 0.43<br />value: 2.713917<br />x: 0.43<br />wear: 2.713917","x: 0.44<br />value: 2.722295<br />x: 0.44<br />wear: 2.722295","x: 0.45<br />value: 2.735218<br />x: 0.45<br />wear: 2.735218","x: 0.46<br />value: 2.754317<br />x: 0.46<br />wear: 2.754317","x: 0.47<br />value: 2.780798<br />x: 0.47<br />wear: 2.780798","x: 0.48<br />value: 2.815449<br />x: 0.48<br />wear: 2.815449","x: 0.49<br />value: 2.858640<br />x: 0.49<br />wear: 2.858640","x: 0.50<br />value: 2.910317<br />x: 0.50<br />wear: 2.910317","x: 0.51<br />value: 2.969936<br />x: 0.51<br />wear: 2.969936","x: 0.52<br />value: 3.036246<br />x: 0.52<br />wear: 3.036246","x: 0.53<br />value: 3.107500<br />x: 0.53<br />wear: 3.107500","x: 0.54<br />value: 3.181537<br />x: 0.54<br />wear: 3.181537","x: 0.55<br />value: 3.255770<br />x: 0.55<br />wear: 3.255770","x: 0.56<br />value: 3.327195<br />x: 0.56<br />wear: 3.327195","x: 0.57<br />value: 3.392388<br />x: 0.57<br />wear: 3.392388","x: 0.58<br />value: 3.447502<br />x: 0.58<br />wear: 3.447502","x: 0.59<br />value: 3.488271<br />x: 0.59<br />wear: 3.488271","x: 0.60<br />value: 3.510012<br />x: 0.60<br />wear: 3.510012","x: 0.61<br />value: 3.507616<br />x: 0.61<br />wear: 3.507616","x: 0.62<br />value: 3.475558<br />x: 0.62<br />wear: 3.475558","x: 0.63<br />value: 3.408202<br />x: 0.63<br />wear: 3.408202","x: 0.64<br />value: 3.306630<br />x: 0.64<br />wear: 3.306630","x: 0.65<br />value: 3.178641<br />x: 0.65<br />wear: 3.178641","x: 0.66<br />value: 3.031926<br />x: 0.66<br />wear: 3.031926","x: 0.67<br />value: 2.873754<br />x: 0.67<br />wear: 2.873754","x: 0.68<br />value: 2.710975<br />x: 0.68<br />wear: 2.710975","x: 0.69<br />value: 2.550019<br />x: 0.69<br />wear: 2.550019","x: 0.70<br />value: 2.396893<br />x: 0.70<br />wear: 2.396893","x: 0.71<br />value: 2.257188<br />x: 0.71<br />wear: 2.257188","x: 0.72<br />value: 2.136072<br />x: 0.72<br />wear: 2.136072","x: 0.73<br />value: 2.038293<br />x: 0.73<br />wear: 2.038293","x: 0.74<br />value: 1.968180<br />x: 0.74<br />wear: 1.968180","x: 0.75<br />value: 1.929639<br />x: 0.75<br />wear: 1.929639","x: 0.76<br />value: 1.925121<br />x: 0.76<br />wear: 1.925121","x: 0.77<br />value: 1.952497<br />x: 0.77<br />wear: 1.952497","x: 0.78<br />value: 2.008181<br />x: 0.78<br />wear: 2.008181","x: 0.79<br />value: 2.088168<br />x: 0.79<br />wear: 2.088168","x: 0.80<br />value: 2.188029<br />x: 0.80<br />wear: 2.188029","x: 0.81<br />value: 2.302919<br />x: 0.81<br />wear: 2.302919","x: 0.82<br />value: 2.427569<br />x: 0.82<br />wear: 2.427569","x: 0.83<br />value: 2.556292<br />x: 0.83<br />wear: 2.556292","x: 0.84<br />value: 2.682981<br />x: 0.84<br />wear: 2.682981","x: 0.85<br />value: 2.801107<br />x: 0.85<br />wear: 2.801107","x: 0.86<br />value: 2.903723<br />x: 0.86<br />wear: 2.903723","x: 0.87<br />value: 2.983459<br />x: 0.87<br />wear: 2.983459","x: 0.88<br />value: 3.032811<br />x: 0.88<br />wear: 3.032811","x: 0.89<br />value: 3.050374<br />x: 0.89<br />wear: 3.050374","x: 0.90<br />value: 3.040846<br />x: 0.90<br />wear: 3.040846","x: 0.91<br />value: 3.008789<br />x: 0.91<br />wear: 3.008789","x: 0.92<br />value: 2.958342<br />x: 0.92<br />wear: 2.958342","x: 0.93<br />value: 2.893226<br />x: 0.93<br />wear: 2.893226","x: 0.94<br />value: 2.816741<br />x: 0.94<br />wear: 2.816741","x: 0.95<br />value: 2.731767<br />x: 0.95<br />wear: 2.731767","x: 0.96<br />value: 2.640763<br />x: 0.96<br />wear: 2.640763","x: 0.97<br />value: 2.545770<br />x: 0.97<br />wear: 2.545770","x: 0.98<br />value: 2.448405<br />x: 0.98<br />wear: 2.448405","x: 0.99<br />value: 2.349868<br />x: 0.99<br />wear: 2.349868","x: 1.00<br />value: 2.250938<br />x: 1.00<br />wear: 2.250938"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(41,87,255,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x3","yaxis":"y2","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":39.37899543379,"r":7.30593607305936,"b":41.6438356164384,"l":31.4155251141553},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,0.323820395738204],"type":"linear","autorange":false,"tickmode":"array","range":[-0.05,1.05],"ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(127,127,127,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y2","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"annotations":[{"text":"x","x":0.5,"y":-0.0471841704718417,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"top","annotationType":"axis"},{"text":"wear","x":-0.0218797564687976,"y":0.5,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xref":"paper","yref":"paper","textangle":-90,"xanchor":"right","yanchor":"center","annotationType":"axis"},{"text":"lambda = 0.1","x":0.161910197869102,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"lambda = 0.01","x":0.5,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"lambda = 0.001","x":0.838089802130898,"y":1,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"lambda = 1e-04","x":0.161910197869102,"y":0.460426179604262,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"lambda = 1e-05","x":0.5,"y":0.460426179604262,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"},{"text":"lambda = 1e-06","x":0.838089802130898,"y":0.460426179604262,"showarrow":false,"ax":0,"ay":0,"font":{"color":"rgba(26,26,26,1)","family":"","size":11.689497716895},"xref":"paper","yref":"paper","textangle":-0,"xanchor":"center","yanchor":"bottom"}],"yaxis":{"domain":[0.539573820395738,1],"type":"linear","autorange":false,"tickmode":"array","range":[1.545,4.955],"ticktext":["2","3","4"],"tickvals":[2,3,4],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(127,127,127,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.323820395738204,"y0":0.539573820395738,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.323820395738204,"y0":1,"y1":1.06929133858268},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.342846270928463,"x1":0.657153729071537,"y0":0.539573820395738,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.342846270928463,"x1":0.657153729071537,"y0":1,"y1":1.06929133858268},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.676179604261796,"x1":1,"y0":0.539573820395738,"y1":1},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.676179604261796,"x1":1,"y0":1,"y1":1.06929133858268},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.323820395738204,"y0":0,"y1":0.460426179604262},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":0.323820395738204,"y0":0.460426179604262,"y1":0.529717518186939},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.342846270928463,"x1":0.657153729071537,"y0":0,"y1":0.460426179604262},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.342846270928463,"x1":0.657153729071537,"y0":0.460426179604262,"y1":0.529717518186939},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.676179604261796,"x1":1,"y0":0,"y1":0.460426179604262},{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0.676179604261796,"x1":1,"y0":0.460426179604262,"y1":0.529717518186939}],"xaxis2":{"type":"linear","autorange":false,"tickmode":"array","range":[-0.05,1.05],"ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(127,127,127,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0.342846270928463,0.657153729071537],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y2","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"xaxis3":{"type":"linear","autorange":false,"tickmode":"array","range":[-0.05,1.05],"ticktext":["0.00","0.25","0.50","0.75","1.00"],"tickvals":[0,0.25,0.5,0.75,1],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(127,127,127,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0.676179604261796,1],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y2","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"yaxis2":{"type":"linear","autorange":false,"tickmode":"array","range":[1.545,4.955],"ticktext":["2","3","4"],"tickvals":[2,3,4],"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(127,127,127,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":false,"domain":[0,0.460426179604262],"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":"","titlefont":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"hoverformat":".2f"},"showlegend":false,"legend":{"bgcolor":"transparent","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","width":600,"paper_bgcolor":"rgba(0,0,0,0)","plot_bgcolor":"rgba(0,0,0,0)"},"source":"A","attrs":{"5090cb16831":{"x":{},"y":{},"type":"ggplotly"},"5090532f6f79":{"x":{},"y":{},"x.1":{},"y.1":{}}},"cur_data":"5090cb16831","visdat":{"5090cb16831":["function (y) ","x"],"5090532f6f79":["function (y) ","x"]},"config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
</div>
<div id="basis-functions-for-a-cubic-spline" class="section level2">
<h2>Basis functions for a cubic spline</h2>
<p>We can take the same approach as with the polynomial example earlier in the document, and take a closer look at the basis functions. While we’re using the same approach here as above, you can inspect this in one of two ways with the <span class="pack">mgcv</span> package. One is to use the <code>fit=FALSE</code> argument, which will return the model matrix instead of a fitted gam object<label for="sn-demo" class="margin-toggle sidenote-number"></label><input type="checkbox" id="sn-demo" class="margin-toggle"/><span class="sidenote">Doing so actually returns an list of many elements. The one named <code>X</code> is the model matrix.</span>. Secondly, after a model is run, you can use the <span class="func">predict</span> function on <em>any</em> data with the argument <code>type='lpmatrix'</code> to return the matrix.</p>
<p>The following is arranged in order of the Income values.</p>
<pre><code>   Income    X1         X2         X3    X4 X5 X6 X7 X8 X9
1   0.407 0.007 0.00000000 0.00000000 0.000  0  0  0  0  0
2   0.484 0.084 0.01733333 0.00000000 0.000  0  0  0  0  0
3   0.552 0.152 0.08533333 0.01866667 0.000  0  0  0  0  0
4   0.566 0.166 0.09933333 0.03266667 0.000  0  0  0  0  0
5   0.597 0.197 0.13033333 0.06366667 0.000  0  0  0  0  0
6   0.603 0.203 0.13633333 0.06966667 0.003  0  0  0  0  0
7   0.616 0.216 0.14933333 0.08266667 0.016  0  0  0  0  0
8   0.637 0.237 0.17033333 0.10366667 0.037  0  0  0  0  0
9   0.642 0.242 0.17533333 0.10866667 0.042  0  0  0  0  0
10  0.647 0.247 0.18033333 0.11366667 0.047  0  0  0  0  0</code></pre>
<p>Note that we have many more columns than we normally would fit with a polynomial regression, and this is dealt with through the penalized approach we’ve discussed. The first column represents the linear form of Income, though it is scaled differently (i.e. the correlation is perfect). Note also that as you move along Income and past knot values, some basis functions will have zero values as they don’t apply to that range of Income.</p>
<p>If we plot these against Income, it doesn’t look like much, but we can tell where the knots are.</p>
<div id="509049b1934f" style="width:75%;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="509049b1934f">{"x":{"visdat":{"50907220201":["function () ","plotlyVisDat"]},"cur_data":"50907220201","attrs":{"50907220201":{"alpha":1,"sizes":[10,100],"x":{},"y":{},"type":"scatter","mode":"lines","split":{}}},"layout":{"width":"75%","margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"zeroline":false,"showgrid":false,"title":"Income"},"yaxis":{"domain":[0,1],"zeroline":false,"showgrid":false,"title":"bsfunc"},"plot_bgcolor":"rgba(0,0,0,0)","paper_bgcolor":"rgba(0,0,0,0)","hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false,"showLink":false,"displaylogo":false,"modeBarButtonsToRemove":["pan2d"]},"data":[{"x":[0.407,0.484,0.552,0.566,0.597,0.603,0.616,0.637,0.642,0.647,0.658,0.658,0.663,0.673,0.678,0.679,0.691,0.695,0.71,0.711,0.717,0.724,0.733,0.734,0.739,0.763,0.765,0.781,0.786,0.788,0.791,0.805,0.81,0.819,0.825,0.826,0.827,0.831,0.831,0.832,0.833,0.835,0.836,0.837,0.838,0.84,0.848,0.853,0.857,0.872,0.884,0.901,0.914,0.941],"y":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"type":"scatter","mode":"lines","name":"int","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.407,0.484,0.552,0.566,0.597,0.603,0.616,0.637,0.642,0.647,0.658,0.658,0.663,0.673,0.678,0.679,0.691,0.695,0.71,0.711,0.717,0.724,0.733,0.734,0.739,0.763,0.765,0.781,0.786,0.788,0.791,0.805,0.81,0.819,0.825,0.826,0.827,0.831,0.831,0.832,0.833,0.835,0.836,0.837,0.838,0.84,0.848,0.853,0.857,0.872,0.884,0.901,0.914,0.941],"y":[0.00699999999999995,0.084,0.152,0.166,0.197,0.203,0.216,0.237,0.242,0.247,0.258,0.258,0.263,0.273,0.278,0.279,0.291,0.295,0.31,0.311,0.317,0.324,0.333,0.334,0.339,0.363,0.365,0.381,0.386,0.388,0.391,0.405,0.41,0.419,0.425,0.426,0.427,0.431,0.431,0.432,0.433,0.435,0.436,0.437,0.438,0.44,0.448,0.453,0.457,0.472,0.484,0.501,0.514,0.541],"type":"scatter","mode":"lines","name":"X1","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.407,0.484,0.552,0.566,0.597,0.603,0.616,0.637,0.642,0.647,0.658,0.658,0.663,0.673,0.678,0.679,0.691,0.695,0.71,0.711,0.717,0.724,0.733,0.734,0.739,0.763,0.765,0.781,0.786,0.788,0.791,0.805,0.81,0.819,0.825,0.826,0.827,0.831,0.831,0.832,0.833,0.835,0.836,0.837,0.838,0.84,0.848,0.853,0.857,0.872,0.884,0.901,0.914,0.941],"y":[0,0.0173333333333333,0.0853333333333334,0.0993333333333333,0.130333333333333,0.136333333333333,0.149333333333333,0.170333333333333,0.175333333333333,0.180333333333333,0.191333333333333,0.191333333333333,0.196333333333333,0.206333333333333,0.211333333333333,0.212333333333333,0.224333333333333,0.228333333333333,0.243333333333333,0.244333333333333,0.250333333333333,0.257333333333333,0.266333333333333,0.267333333333333,0.272333333333333,0.296333333333333,0.298333333333333,0.314333333333333,0.319333333333333,0.321333333333333,0.324333333333333,0.338333333333333,0.343333333333333,0.352333333333333,0.358333333333333,0.359333333333333,0.360333333333333,0.364333333333333,0.364333333333333,0.365333333333333,0.366333333333333,0.368333333333333,0.369333333333333,0.370333333333333,0.371333333333333,0.373333333333333,0.381333333333333,0.386333333333333,0.390333333333333,0.405333333333333,0.417333333333333,0.434333333333333,0.447333333333333,0.474333333333333],"type":"scatter","mode":"lines","name":"X2","line":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.407,0.484,0.552,0.566,0.597,0.603,0.616,0.637,0.642,0.647,0.658,0.658,0.663,0.673,0.678,0.679,0.691,0.695,0.71,0.711,0.717,0.724,0.733,0.734,0.739,0.763,0.765,0.781,0.786,0.788,0.791,0.805,0.81,0.819,0.825,0.826,0.827,0.831,0.831,0.832,0.833,0.835,0.836,0.837,0.838,0.84,0.848,0.853,0.857,0.872,0.884,0.901,0.914,0.941],"y":[0,0,0.0186666666666667,0.0326666666666666,0.0636666666666666,0.0696666666666667,0.0826666666666667,0.103666666666667,0.108666666666667,0.113666666666667,0.124666666666667,0.124666666666667,0.129666666666667,0.139666666666667,0.144666666666667,0.145666666666667,0.157666666666667,0.161666666666667,0.176666666666667,0.177666666666667,0.183666666666667,0.190666666666667,0.199666666666667,0.200666666666667,0.205666666666667,0.229666666666667,0.231666666666667,0.247666666666667,0.252666666666667,0.254666666666667,0.257666666666667,0.271666666666667,0.276666666666667,0.285666666666667,0.291666666666667,0.292666666666667,0.293666666666667,0.297666666666667,0.297666666666667,0.298666666666667,0.299666666666667,0.301666666666667,0.302666666666667,0.303666666666667,0.304666666666667,0.306666666666667,0.314666666666667,0.319666666666667,0.323666666666667,0.338666666666667,0.350666666666667,0.367666666666667,0.380666666666667,0.407666666666667],"type":"scatter","mode":"lines","name":"X3","line":{"fillcolor":"rgba(214,39,40,1)","color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.407,0.484,0.552,0.566,0.597,0.603,0.616,0.637,0.642,0.647,0.658,0.658,0.663,0.673,0.678,0.679,0.691,0.695,0.71,0.711,0.717,0.724,0.733,0.734,0.739,0.763,0.765,0.781,0.786,0.788,0.791,0.805,0.81,0.819,0.825,0.826,0.827,0.831,0.831,0.832,0.833,0.835,0.836,0.837,0.838,0.84,0.848,0.853,0.857,0.872,0.884,0.901,0.914,0.941],"y":[0,0,0,0,0,0.00299999999999989,0.0159999999999999,0.0369999999999999,0.0419999999999999,0.0469999999999999,0.0579999999999999,0.0579999999999999,0.0629999999999999,0.073,0.078,0.079,0.0909999999999999,0.0949999999999999,0.11,0.111,0.117,0.124,0.133,0.134,0.139,0.163,0.165,0.181,0.186,0.188,0.191,0.205,0.21,0.219,0.225,0.226,0.227,0.231,0.231,0.232,0.233,0.235,0.236,0.237,0.238,0.24,0.248,0.253,0.257,0.272,0.284,0.301,0.314,0.341],"type":"scatter","mode":"lines","name":"X4","line":{"fillcolor":"rgba(148,103,189,1)","color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.407,0.484,0.552,0.566,0.597,0.603,0.616,0.637,0.642,0.647,0.658,0.658,0.663,0.673,0.678,0.679,0.691,0.695,0.71,0.711,0.717,0.724,0.733,0.734,0.739,0.763,0.765,0.781,0.786,0.788,0.791,0.805,0.81,0.819,0.825,0.826,0.827,0.831,0.831,0.832,0.833,0.835,0.836,0.837,0.838,0.84,0.848,0.853,0.857,0.872,0.884,0.901,0.914,0.941],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0.0063333333333333,0.0113333333333333,0.0123333333333333,0.0243333333333332,0.0283333333333332,0.0433333333333332,0.0443333333333332,0.0503333333333332,0.0573333333333332,0.0663333333333332,0.0673333333333332,0.0723333333333332,0.0963333333333333,0.0983333333333333,0.114333333333333,0.119333333333333,0.121333333333333,0.124333333333333,0.138333333333333,0.143333333333333,0.152333333333333,0.158333333333333,0.159333333333333,0.160333333333333,0.164333333333333,0.164333333333333,0.165333333333333,0.166333333333333,0.168333333333333,0.169333333333333,0.170333333333333,0.171333333333333,0.173333333333333,0.181333333333333,0.186333333333333,0.190333333333333,0.205333333333333,0.217333333333333,0.234333333333333,0.247333333333333,0.274333333333333],"type":"scatter","mode":"lines","name":"X5","line":{"fillcolor":"rgba(140,86,75,1)","color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.407,0.484,0.552,0.566,0.597,0.603,0.616,0.637,0.642,0.647,0.658,0.658,0.663,0.673,0.678,0.679,0.691,0.695,0.71,0.711,0.717,0.724,0.733,0.734,0.739,0.763,0.765,0.781,0.786,0.788,0.791,0.805,0.81,0.819,0.825,0.826,0.827,0.831,0.831,0.832,0.833,0.835,0.836,0.837,0.838,0.84,0.848,0.853,0.857,0.872,0.884,0.901,0.914,0.941],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.000666666666666593,0.0056666666666666,0.0296666666666666,0.0316666666666666,0.0476666666666666,0.0526666666666666,0.0546666666666666,0.0576666666666666,0.0716666666666667,0.0766666666666667,0.0856666666666666,0.0916666666666666,0.0926666666666666,0.0936666666666666,0.0976666666666666,0.0976666666666666,0.0986666666666666,0.0996666666666666,0.101666666666667,0.102666666666667,0.103666666666667,0.104666666666667,0.106666666666667,0.114666666666667,0.119666666666667,0.123666666666667,0.138666666666667,0.150666666666667,0.167666666666667,0.180666666666667,0.207666666666667],"type":"scatter","mode":"lines","name":"X6","line":{"fillcolor":"rgba(227,119,194,1)","color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.407,0.484,0.552,0.566,0.597,0.603,0.616,0.637,0.642,0.647,0.658,0.658,0.663,0.673,0.678,0.679,0.691,0.695,0.71,0.711,0.717,0.724,0.733,0.734,0.739,0.763,0.765,0.781,0.786,0.788,0.791,0.805,0.81,0.819,0.825,0.826,0.827,0.831,0.831,0.832,0.833,0.835,0.836,0.837,0.838,0.84,0.848,0.853,0.857,0.872,0.884,0.901,0.914,0.941],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.005,0.01,0.0189999999999999,0.0249999999999999,0.0259999999999999,0.0269999999999999,0.0309999999999999,0.0309999999999999,0.0319999999999999,0.0329999999999999,0.0349999999999999,0.0359999999999999,0.0369999999999999,0.0379999999999999,0.0399999999999999,0.0479999999999999,0.0529999999999999,0.0569999999999999,0.072,0.084,0.101,0.114,0.141],"type":"scatter","mode":"lines","name":"X7","line":{"fillcolor":"rgba(127,127,127,1)","color":"rgba(127,127,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.407,0.484,0.552,0.566,0.597,0.603,0.616,0.637,0.642,0.647,0.658,0.658,0.663,0.673,0.678,0.679,0.691,0.695,0.71,0.711,0.717,0.724,0.733,0.734,0.739,0.763,0.765,0.781,0.786,0.788,0.791,0.805,0.81,0.819,0.825,0.826,0.827,0.831,0.831,0.832,0.833,0.835,0.836,0.837,0.838,0.84,0.848,0.853,0.857,0.872,0.884,0.901,0.914,0.941],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0053333333333333,0.0173333333333333,0.0343333333333333,0.0473333333333333,0.0743333333333333],"type":"scatter","mode":"lines","name":"X8","line":{"fillcolor":"rgba(188,189,34,1)","color":"rgba(188,189,34,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.407,0.484,0.552,0.566,0.597,0.603,0.616,0.637,0.642,0.647,0.658,0.658,0.663,0.673,0.678,0.679,0.691,0.695,0.71,0.711,0.717,0.724,0.733,0.734,0.739,0.763,0.765,0.781,0.786,0.788,0.791,0.805,0.81,0.819,0.825,0.826,0.827,0.831,0.831,0.832,0.833,0.835,0.836,0.837,0.838,0.84,0.848,0.853,0.857,0.872,0.884,0.901,0.914,0.941],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0076666666666666],"type":"scatter","mode":"lines","name":"X9","line":{"fillcolor":"rgba(23,190,207,1)","color":"rgba(23,190,207,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<p>However, if we plot Income against the basis multiplied by the estimated coefficients of the model, the data story begins to reveal itself.</p>
<div id="509072292639" style="width:75%;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="509072292639">{"x":{"visdat":{"509031dc3d01":["function () ","plotlyVisDat"],"50906b8ca2bc":["function () ","data"],"50905e101bcd":["function () ","data"],"509073915ff9":["function () ","data"],"50904d340fb5":["function () ","data"],"509014f35bac":["function () ","data"],"5090750783f2":["function () ","data"],"50904067c0e4":["function () ","data"],"50905ba8d9c4":["function () ","data"],"50902a7101df":["function () ","data"],"50906131ed3d":["function () ","data"]},"cur_data":"50906131ed3d","attrs":{"50906b8ca2bc":{"alpha":1,"sizes":[10,100],"x":{},"y":{},"type":"scatter","mode":"markers","name":"Intercept"},"50905e101bcd":{"alpha":1,"sizes":[10,100],"x":{},"y":{},"type":"scatter","mode":"lines","name":"X1"},"509073915ff9":{"alpha":1,"sizes":[10,100],"x":{},"y":{},"type":"scatter","mode":"lines","name":"X2"},"50904d340fb5":{"alpha":1,"sizes":[10,100],"x":{},"y":{},"type":"scatter","mode":"lines","name":"X3"},"509014f35bac":{"alpha":1,"sizes":[10,100],"x":{},"y":{},"type":"scatter","mode":"lines","name":"X4"},"5090750783f2":{"alpha":1,"sizes":[10,100],"x":{},"y":{},"type":"scatter","mode":"lines","name":"X5"},"50904067c0e4":{"alpha":1,"sizes":[10,100],"x":{},"y":{},"type":"scatter","mode":"lines","name":"X6"},"50905ba8d9c4":{"alpha":1,"sizes":[10,100],"x":{},"y":{},"type":"scatter","mode":"lines","name":"X7"},"50902a7101df":{"alpha":1,"sizes":[10,100],"x":{},"y":{},"type":"scatter","mode":"lines","name":"X8"},"50906131ed3d":{"alpha":1,"sizes":[10,100],"x":{},"y":{},"type":"scatter","mode":"lines","name":"X9"}},"layout":{"width":"75%","margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"zeroline":false,"showgrid":false,"title":"Income"},"yaxis":{"domain":[0,1],"zeroline":false,"showgrid":false,"title":"bsfunc"},"plot_bgcolor":"rgba(0,0,0,0)","paper_bgcolor":"rgba(0,0,0,0)","hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false,"showLink":false,"displaylogo":false,"modeBarButtonsToRemove":["pan2d"]},"data":[{"x":[0.407],"y":[314.375806383648],"type":"scatter","mode":"markers","name":"Intercept","marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.407,0.484,0.552,0.566,0.597,0.603,0.616,0.637,0.642,0.647,0.658,0.658,0.663,0.673,0.678,0.679,0.691,0.695,0.71,0.711,0.717,0.724,0.733,0.734,0.739,0.763,0.765,0.781,0.786,0.788,0.791,0.805,0.81,0.819,0.825,0.826,0.827,0.831,0.831,0.832,0.833,0.835,0.836,0.837,0.838,0.84,0.848,0.853,0.857,0.872,0.884,0.901,0.914,0.941],"y":[7.62419361635122,91.4903233962153,165.553918526485,180.802305759187,214.566591774457,221.101614874187,235.260831590268,258.133412439322,263.57926502243,269.025117605538,281.005993288376,281.005993288376,286.451845871484,297.3435510377,302.789403620808,303.878574137429,316.948620336889,321.305302403375,337.642860152699,338.732030669321,345.267053769051,352.891247385402,362.693782034996,363.782952551618,369.228805134726,395.368897533645,397.547238566888,414.973966832834,420.419819415942,422.598160449185,425.86567199905,441.114059231752,446.55991181486,456.362446464455,462.897469564184,463.986640080806,465.075810597428,469.432492663914,469.432492663914,470.521663180536,471.610833697157,473.789174730401,474.878345247022,475.967515763644,477.056686280265,479.235027313509,487.948391446482,493.39424402959,497.750926096076,514.0884838454,527.15853004486,545.674428827427,559.833645543508,589.241249492291],"type":"scatter","mode":"lines","name":"X1","line":{"fillcolor":"rgba(255,127,14,1)","color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.484,0.552,0.566,0.597,0.603,0.616,0.637,0.642,0.647,0.658,0.658,0.663,0.673,0.678,0.679,0.691,0.695,0.71,0.711,0.717,0.724,0.733,0.734,0.739,0.763,0.765,0.781,0.786,0.788,0.791,0.805,0.81,0.819,0.825,0.826,0.827,0.831,0.831,0.832,0.833,0.835,0.836,0.837,0.838,0.84,0.848,0.853,0.857,0.872,0.884,0.901,0.914,0.941],"y":[-12.8661297798624,-63.3409466085535,-73.7328206615192,-96.7433989216578,-101.197059230072,-110.846656564969,-126.434467644417,-130.145851234762,-133.857234825107,-142.022278723866,-142.022278723866,-145.733662314211,-153.156429494901,-156.867813085246,-157.610089803315,-166.517410420142,-169.486517292418,-180.620668063453,-181.362944781522,-185.816605089936,-191.012542116419,-197.69303257904,-198.435309297109,-202.146692887454,-219.96133412111,-221.445887557247,-233.322315046351,-237.033698636696,-238.518252072834,-240.745082227041,-251.136956280007,-254.848339870352,-261.528830332973,-265.982490641387,-266.724767359456,-267.467044077525,-270.4361509498,-270.4361509498,-271.178427667869,-271.920704385939,-273.405257822076,-274.147534540145,-274.889811258214,-275.632087976283,-277.116641412421,-283.054855156973,-286.766238747318,-289.735345619594,-300.869496390629,-309.776817007457,-322.39552121463,-332.045118549526,-352.086589937389],"type":"scatter","mode":"lines","name":"X2","line":{"fillcolor":"rgba(44,160,44,1)","color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.552,0.566,0.597,0.603,0.616,0.637,0.642,0.647,0.658,0.658,0.663,0.673,0.678,0.679,0.691,0.695,0.71,0.711,0.717,0.724,0.733,0.734,0.739,0.763,0.765,0.781,0.786,0.788,0.791,0.805,0.81,0.819,0.825,0.826,0.827,0.831,0.831,0.832,0.833,0.835,0.836,0.837,0.838,0.84,0.848,0.853,0.857,0.872,0.884,0.901,0.914,0.941],"y":[-10.3624909641735,-18.1343591873036,-35.3434959670917,-38.6742966341475,-45.8910314127683,-57.5488337474635,-60.32450097001,-63.1001681925564,-69.2066360821587,-69.2066360821587,-71.9823033047051,-77.5336377497981,-80.3093049723446,-80.8644384168539,-87.5260397509653,-89.7465735290025,-98.0735751966419,-98.6287086411512,-101.959509308207,-105.845443419772,-110.841644420356,-111.396777864865,-114.172445087411,-127.495647755635,-128.605914644653,-137.488049756802,-140.263716979348,-141.373983868367,-143.039384201895,-150.811252425025,-153.586919647571,-158.583120648155,-161.913921315211,-162.46905475972,-163.024188204229,-165.244721982266,-165.244721982266,-165.799855426776,-166.354988871285,-167.465255760304,-168.020389204813,-168.575522649322,-169.130656093832,-170.24092298285,-174.681990538925,-177.457657761471,-179.678191539508,-188.005193207148,-194.666794541259,-204.104063097917,-211.320797876538,-226.309400878289],"type":"scatter","mode":"lines","name":"X3","line":{"fillcolor":"rgba(214,39,40,1)","color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.603,0.616,0.637,0.642,0.647,0.658,0.658,0.663,0.673,0.678,0.679,0.691,0.695,0.71,0.711,0.717,0.724,0.733,0.734,0.739,0.763,0.765,0.781,0.786,0.788,0.791,0.805,0.81,0.819,0.825,0.826,0.827,0.831,0.831,0.832,0.833,0.835,0.836,0.837,0.838,0.84,0.848,0.853,0.857,0.872,0.884,0.901,0.914,0.941],"y":[1.63067113946961,8.69691274383816,20.1116107201258,22.8293959525753,25.5471811850247,31.5263086964135,31.5263086964135,34.2440939288629,39.6796643937618,42.3974496262112,42.9410066727011,49.4636912305797,51.6379194165393,59.7912751138876,60.3348321603775,63.5961744393168,67.4010737647461,72.2930871831551,72.8366442296449,75.5544294620944,88.5997985778517,89.6869126708315,98.3838254146697,101.101610647119,102.188724740099,103.819395879569,111.429194530427,114.146979762876,119.038993181285,122.300335460225,122.843892506715,123.387449553205,125.561677739164,125.561677739164,126.105234785654,126.648791832144,127.735905925124,128.279462971614,128.823020018103,129.366577064593,130.453691157573,134.802147529492,137.519932761942,139.694160947901,147.847516645249,154.370201203128,163.610670993456,170.676912597825,185.352952853052],"type":"scatter","mode":"lines","name":"X4","line":{"fillcolor":"rgba(148,103,189,1)","color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.673,0.678,0.679,0.691,0.695,0.71,0.711,0.717,0.724,0.733,0.734,0.739,0.763,0.765,0.781,0.786,0.788,0.791,0.805,0.81,0.819,0.825,0.826,0.827,0.831,0.831,0.832,0.833,0.835,0.836,0.837,0.838,0.84,0.848,0.853,0.857,0.872,0.884,0.901,0.914,0.941],"y":[6.36084304285467,11.3825612345821,12.3869048729275,24.4390285330732,28.4564030864551,43.5215576616373,44.5259012999828,50.5519631300557,57.582368598474,66.6214613435833,67.6258049819288,72.6475231736562,96.7517704939477,98.7604577706387,114.829955984166,119.851674175894,121.860361452585,124.873392367621,138.934203304458,143.955921496185,152.995014241294,159.021076071367,160.025419709713,161.029763348058,165.04713790144,165.04713790144,166.051481539786,167.055825178131,169.064512454822,170.068856093168,171.073199731513,172.077543369859,174.08623064655,182.120979753313,187.142697945041,191.160072498423,206.225227073605,218.277350733751,235.351192585624,248.407659884115,275.524938119443],"type":"scatter","mode":"lines","name":"X5","line":{"fillcolor":"rgba(140,86,75,1)","color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.734,0.739,0.763,0.765,0.781,0.786,0.788,0.791,0.805,0.81,0.819,0.825,0.826,0.827,0.831,0.831,0.832,0.833,0.835,0.836,0.837,0.838,0.84,0.848,0.853,0.857,0.872,0.884,0.901,0.914,0.941],"y":[-1.06776766417771,-9.07602514551146,-47.5156610559134,-50.7189640484469,-76.3453879887149,-84.3536454700486,-87.5569484625821,-92.3619029513824,-114.785023899117,-122.793281380451,-137.208144846851,-146.818053824452,-148.419705320718,-150.021356816985,-156.427962802052,-156.427962802052,-158.029614298319,-159.631265794586,-162.834568787119,-164.436220283386,-166.037871779653,-167.639523275919,-170.842826268453,-183.656038238587,-191.664295719921,-198.070901704988,-222.095674148989,-241.31549210419,-268.543567540725,-289.365036992192,-332.609627391394],"type":"scatter","mode":"lines","name":"X6","line":{"fillcolor":"rgba(227,119,194,1)","color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.805,0.81,0.819,0.825,0.826,0.827,0.831,0.831,0.832,0.833,0.835,0.836,0.837,0.838,0.84,0.848,0.853,0.857,0.872,0.884,0.901,0.914,0.941],"y":[4.7261471191263,9.45229423825261,17.9593590526799,23.6307355956314,24.5759650194567,25.5211944432819,29.302112138583,29.302112138583,30.2473415624082,31.1925709862335,33.083029833884,34.0282592577093,34.9734886815345,35.9187181053598,37.8091769530103,45.3710123436124,50.0971594627387,53.8780771580398,68.0565185154187,79.3992716013218,95.4681718063512,107.75615431608,133.277348759362],"type":"scatter","mode":"lines","name":"X7","line":{"fillcolor":"rgba(127,127,127,1)","color":"rgba(127,127,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.872,0.872,0.872,0.872,0.884,0.884,0.884,0.884,0.901,0.901,0.901,0.901,0.914,0.914,0.914,0.914,0.941,0.941,0.941,0.941],"y":[-20.2437120549815,-20.2437120549815,-20.2437120549815,-20.2437120549815,-65.7920641786901,-65.7920641786901,-65.7920641786901,-65.7920641786901,-130.318896353944,-130.318896353944,-130.318896353944,-130.318896353944,-179.662944487962,-179.662944487962,-179.662944487962,-179.662944487962,-282.146736766306,-282.146736766306,-282.146736766306,-282.146736766306],"type":"scatter","mode":"lines","name":"X8","line":{"fillcolor":"rgba(188,189,34,1)","color":"rgba(188,189,34,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.941],"y":[217.380059365582],"type":"scatter","mode":"lines","name":"X9","line":{"fillcolor":"rgba(23,190,207,1)","color":"rgba(23,190,207,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<p>Each trend line represents the fit at the knot points. For example, The intercept is the starting point, and from there the function is initially increasing. After the second knot point that initial increase starts to slow down. If it helps, think of a quadratic function. This is similar to a scenario where the coefficient for <span class="math inline">\(x\)</span> is positive while it is negative and smaller for <span class="math inline">\(x^2\)</span>. We then see the trend turn strongly positive again and so on. Here is the final plot. Note that since we used lm, this is an <strong>unpenalized fit</strong> and so overfits the data a bit at the end where there extreme and few values. This serves also as an insight into the benefits of the penalization process. Using the gam function, our fit would not drop so much for Qatar.</p>
<div id="509043bd6a05" style="width:75%;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="509043bd6a05">{"x":{"visdat":{"50905c665a77":["function () ","plotlyVisDat"]},"cur_data":"50905c665a77","attrs":{"50905c665a77":{"x":[0.407,0.484,0.552,0.566,0.597,0.603,0.616,0.637,0.642,0.647,0.658,0.658,0.663,0.673,0.678,0.679,0.691,0.695,0.71,0.711,0.717,0.724,0.733,0.734,0.739,0.763,0.765,0.781,0.786,0.788,0.791,0.805,0.81,0.819,0.825,0.826,0.827,0.831,0.831,0.832,0.833,0.835,0.836,0.837,0.838,0.84,0.848,0.853,0.857,0.872,0.884,0.901,0.914,0.941],"y":[333.568913299894,372.521261803361,398.198772986927,401.742504224351,406.843431922497,407.348611785429,407.867790865448,408.915008824652,409.794798279852,411.105553671017,415.955659853451,415.955659853451,419.258384731443,428.304387070008,433.918673076802,435.110937378521,450.685688195766,456.189233819121,476.527119376896,477.804897802586,485.083812111205,492.468834528004,499.548354196889,500.131608436035,502.345817444356,500.612504951634,499.997902518428,495.928642036075,495.655109677996,495.770659028896,496.223252680139,501.818761143185,504.61293966863,509.692331242427,512.601158342187,513.016905651314,513.407587986509,514.600340437777,514.600340437777,514.774267916865,514.885784577922,514.89617231686,514.782407912615,514.585226670903,514.309222001156,513.541390652521,508.349541884741,504.220547334494,500.937530223484,490.025429078297,482.689577674857,473.973609169325,468.299132785602,457.996008459421],"name":"penalized","alpha":1,"sizes":[10,100],"type":"scatter","mode":"lines"}},"layout":{"width":"75%","margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"zeroline":false,"showgrid":false,"title":"Income"},"yaxis":{"domain":[0,1],"zeroline":false,"showgrid":false,"title":"Overall"},"plot_bgcolor":"rgba(0,0,0,0)","paper_bgcolor":"rgba(0,0,0,0)","hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false,"showLink":false,"displaylogo":false,"modeBarButtonsToRemove":["pan2d"]},"data":[{"x":[0.407,0.484,0.552,0.566,0.597,0.603,0.616,0.637,0.642,0.647,0.658,0.658,0.663,0.673,0.678,0.679,0.691,0.695,0.71,0.711,0.717,0.724,0.733,0.734,0.739,0.763,0.765,0.781,0.786,0.788,0.791,0.805,0.81,0.819,0.825,0.826,0.827,0.831,0.831,0.832,0.833,0.835,0.836,0.837,0.838,0.84,0.848,0.853,0.857,0.872,0.884,0.901,0.914,0.941],"y":[333.568913299894,372.521261803361,398.198772986927,401.742504224351,406.843431922497,407.348611785429,407.867790865448,408.915008824652,409.794798279852,411.105553671017,415.955659853451,415.955659853451,419.258384731443,428.304387070008,433.918673076802,435.110937378521,450.685688195766,456.189233819121,476.527119376896,477.804897802586,485.083812111205,492.468834528004,499.548354196889,500.131608436035,502.345817444356,500.612504951634,499.997902518428,495.928642036075,495.655109677996,495.770659028896,496.223252680139,501.818761143185,504.61293966863,509.692331242427,512.601158342187,513.016905651314,513.407587986509,514.600340437777,514.600340437777,514.774267916865,514.885784577922,514.89617231686,514.782407912615,514.585226670903,514.309222001156,513.541390652521,508.349541884741,504.220547334494,500.937530223484,490.025429078297,482.689577674857,473.973609169325,468.299132785602,457.996008459421],"name":"penalized","type":"scatter","mode":"lines","line":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<p>Having seen the innards of the process of building additive models, hopefully this will instill a little more insight and confidence using the technique.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="conclusion.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["twitter", "facebook", "google", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"download": null,
"toc": {
"collapse": "section",
"depth": 2,
"scroll_highlight": true
},
"highlight": "pygments",
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
