<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Generalized Additive Models</title>
  <meta name="description" content="Generalized Additive Models">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Generalized Additive Models" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://m-clark.github.io/" />
  <meta property="og:image" content="https://m-clark.github.io/img/nineteeneightyR.png" />
  <meta property="og:description" content="Generalized Additive Models" />
  <meta name="github-repo" content="m-clark/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Generalized Additive Models" />
  
  <meta name="twitter:description" content="Generalized Additive Models" />
  <meta name="twitter:image" content="https://m-clark.github.io/img/nineteeneightyR.png" />



<meta name="date" content="2018-01-20">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  <link rel="shortcut icon" href="img/R.ico" type="image/x-icon">
<link rel="prev" href="technical-details.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.9/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="css/tufte.css" type="text/css" />
<link rel="stylesheet" href="css/standard_html.css" type="text/css" />
<link rel="stylesheet" href="css/book.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="https://m-clark.github.io/"><span style="font-size:125%; font-variant:small-caps; font-style:italic; color:#0085A1; font-family:Roboto">Generalized Additive Models</span></a></li>

<li class="divider"></li>
<li><a href="index.html#section"></a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#beyond-the-general-linear-model-i"><i class="fa fa-check"></i>Beyond the General Linear Model I</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#general-linear-model"><i class="fa fa-check"></i>General Linear Model</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#generalized-linear-model"><i class="fa fa-check"></i>Generalized Linear Model</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#generalized-additive-model"><i class="fa fa-check"></i>Generalized Additive Model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#beyond-the-general-linear-model-ii"><i class="fa fa-check"></i>Beyond the General Linear Model II</a><ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#fitting-the-standard-linear-model"><i class="fa fa-check"></i>Fitting the Standard Linear Model</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#polynomial-regression"><i class="fa fa-check"></i>Polynomial Regression</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#scatterplot-smoothing"><i class="fa fa-check"></i>Scatterplot Smoothing</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#generalized-additive-models"><i class="fa fa-check"></i>Generalized Additive Models</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#summary"><i class="fa fa-check"></i>Summary</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="the-case-for-gams.html"><a href="the-case-for-gams.html"><i class="fa fa-check"></i>The case for GAMs</a><ul>
<li class="chapter" data-level="" data-path="the-case-for-gams.html"><a href="the-case-for-gams.html#why-not-just-use-standard-methods"><i class="fa fa-check"></i>Why not just use standard methods?</a></li>
<li class="chapter" data-level="" data-path="the-case-for-gams.html"><a href="the-case-for-gams.html#heteroscedasticity-non-normality-etc."><i class="fa fa-check"></i>Heteroscedasticity, non-normality etc.</a></li>
<li class="chapter" data-level="" data-path="the-case-for-gams.html"><a href="the-case-for-gams.html#polynomial-regression-1"><i class="fa fa-check"></i>Polynomial Regression</a><ul>
<li class="chapter" data-level="" data-path="the-case-for-gams.html"><a href="the-case-for-gams.html#a-more-complex-relationship"><i class="fa fa-check"></i>A more complex relationship</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-up-to-gams.html"><a href="building-up-to-gams.html"><i class="fa fa-check"></i>Building up to GAMs</a><ul>
<li class="chapter" data-level="" data-path="building-up-to-gams.html"><a href="building-up-to-gams.html#piecewise-polynomial"><i class="fa fa-check"></i>Piecewise polynomial</a></li>
<li class="chapter" data-level="" data-path="building-up-to-gams.html"><a href="building-up-to-gams.html#what-is-a-gam"><i class="fa fa-check"></i>What is a GAM?</a></li>
<li class="chapter" data-level="" data-path="building-up-to-gams.html"><a href="building-up-to-gams.html#polynomial-spline"><i class="fa fa-check"></i>Polynomial spline</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html"><i class="fa fa-check"></i>Application Using R</a><ul>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html#initial-examination"><i class="fa fa-check"></i>Initial Examination</a></li>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html#single-predictor"><i class="fa fa-check"></i>Single Predictor</a><ul>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html#linear-fit"><i class="fa fa-check"></i>Linear Fit</a></li>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html#gam"><i class="fa fa-check"></i>GAM</a></li>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html#graphical-display"><i class="fa fa-check"></i>Graphical Display</a></li>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html#model-comparison"><i class="fa fa-check"></i>Model Comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html#multiple-predictors"><i class="fa fa-check"></i>Multiple Predictors</a><ul>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html#linear-fit-1"><i class="fa fa-check"></i>Linear Fit</a></li>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html#gam-1"><i class="fa fa-check"></i>GAM</a></li>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html#graphical-display-1"><i class="fa fa-check"></i>Graphical Display</a></li>
<li class="chapter" data-level="" data-path="application-using-r.html"><a href="application-using-r.html#model-comparison-1"><i class="fa fa-check"></i>Model Comparison</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html"><i class="fa fa-check"></i>Issues</a><ul>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#estimation"><i class="fa fa-check"></i>Estimation</a><ul>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#shrinkage-variable-selection"><i class="fa fa-check"></i>Shrinkage &amp; Variable Selection</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#effective-degrees-of-freedom-again"><i class="fa fa-check"></i>Effective degrees of freedom again</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#choice-of-smoothing-function"><i class="fa fa-check"></i>Choice of Smoothing Function</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#diagnostics"><i class="fa fa-check"></i>Diagnostics</a><ul>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#concurvity"><i class="fa fa-check"></i>Concurvity</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#prediction"><i class="fa fa-check"></i>Prediction</a></li>
<li class="chapter" data-level="" data-path="issues.html"><a href="issues.html#model-comparison-revisited"><i class="fa fa-check"></i>Model Comparison Revisited</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="other-approaches.html"><a href="other-approaches.html"><i class="fa fa-check"></i>Other Approaches</a><ul>
<li class="chapter" data-level="" data-path="other-approaches.html"><a href="other-approaches.html#other-nonlinear-modeling-approaches"><i class="fa fa-check"></i>Other Nonlinear Modeling Approaches</a><ul>
<li class="chapter" data-level="" data-path="other-approaches.html"><a href="other-approaches.html#known-form"><i class="fa fa-check"></i>Known Form</a></li>
<li class="chapter" data-level="" data-path="other-approaches.html"><a href="other-approaches.html#response-transformation"><i class="fa fa-check"></i>Response Transformation</a></li>
<li class="chapter" data-level="" data-path="other-approaches.html"><a href="other-approaches.html#the-black-box"><i class="fa fa-check"></i>The Black Box</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="other-approaches.html"><a href="other-approaches.html#extensions"><i class="fa fa-check"></i>Extensions</a><ul>
<li class="chapter" data-level="" data-path="other-approaches.html"><a href="other-approaches.html#other-gams"><i class="fa fa-check"></i>Other GAMs</a></li>
<li class="chapter" data-level="" data-path="other-approaches.html"><a href="other-approaches.html#reproducing-kernel-hilbert-space"><i class="fa fa-check"></i>Reproducing Kernel Hilbert Space</a></li>
<li class="chapter" data-level="" data-path="other-approaches.html"><a href="other-approaches.html#gaussian-processes"><i class="fa fa-check"></i>Gaussian Processes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="concluding-remarks.html"><a href="concluding-remarks.html"><i class="fa fa-check"></i>Concluding remarks</a></li>
<li class="chapter" data-level="" data-path="technical-details.html"><a href="technical-details.html"><i class="fa fa-check"></i>Technical details</a><ul>
<li class="chapter" data-level="" data-path="technical-details.html"><a href="technical-details.html#gam-2"><i class="fa fa-check"></i>GAM</a><ul>
<li class="chapter" data-level="" data-path="technical-details.html"><a href="technical-details.html#penalized-regression"><i class="fa fa-check"></i>Penalized regression</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="technical-details.html"><a href="technical-details.html#a-detailed-example"><i class="fa fa-check"></i>A detailed example</a><ul>
<li class="chapter" data-level="" data-path="technical-details.html"><a href="technical-details.html#preview-of-other-bases"><i class="fa fa-check"></i>Preview of other bases</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="technical-details.html"><a href="technical-details.html#the-number-of-knots-and-where-to-put-them"><i class="fa fa-check"></i>The number of knots and where to put them</a></li>
<li class="chapter" data-level="" data-path="technical-details.html"><a href="technical-details.html#interpreting-output-for-smooth-terms"><i class="fa fa-check"></i>Interpreting output for smooth terms</a><ul>
<li class="chapter" data-level="" data-path="technical-details.html"><a href="technical-details.html#effective-degrees-of-freedom"><i class="fa fa-check"></i>Effective degrees of freedom</a></li>
<li class="chapter" data-level="" data-path="technical-details.html"><a href="technical-details.html#deviance-explained"><i class="fa fa-check"></i>Deviance explained</a></li>
<li class="chapter" data-level="" data-path="technical-details.html"><a href="technical-details.html#visual-depiction"><i class="fa fa-check"></i>Visual depiction</a></li>
<li class="chapter" data-level="" data-path="technical-details.html"><a href="technical-details.html#examining-first-derivatives"><i class="fa fa-check"></i>Examining first derivatives</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>Appendix</a><ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#r-packages"><i class="fa fa-check"></i>R packages</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#time-and-space"><i class="fa fa-check"></i>Time and Space</a><ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#time"><i class="fa fa-check"></i>Time</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#space"><i class="fa fa-check"></i>Space</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://m-clark.github.io/"><img src="img/mc.png" style="width:50%; padding:0px 0; display:block; margin: 0 auto;" alt="MC logo"></a></li>
<li><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="width:50%; border-width:0; display:block; margin: 0 auto;" src="img/ccbysa.png" /></a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><span style="color:#0085A1; font-size:5rem">Generalized Additive Models</span></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="appendix" class="section level1">
<h1>Appendix</h1>
<div id="r-packages" class="section level2">
<h2>R packages</h2>
<p><span class="newthought">The following is</span> a non-exhaustive list of R packages which contain GAM functionality. Each is linked to the CRAN page for the package. Note also that several build upon the <span class="pack">mgcv</span> package used for this document.</p>
<p><a href="http://cran.r-project.org/web/packages/brms/">brms</a> Allows for Bayesian GAMs via the Stan modeling language (very new implementation).</p>
<p><a href="http://cran.r-project.org/web/packages/CausalGAM/">CausalGAM</a> This package implements various estimators for average treatment effects.</p>
<p><a href="http://cran.r-project.org/web/packages/COZIGAM/">COZIGAM</a> Constrained and Unconstrained Zero-Inflated Generalized Additive Models.</p>
<p><a href="http://cran.r-project.org/web/packages/CoxBoost/">CoxBoost</a> This package provides routines for fitting Cox models. See also <span class="func">cph</span> in rms package for nonlinear approaches in the survival context.</p>
<p><a href="http://cran.r-project.org/web/packages/gam/">gam</a> Functions for fitting and working with generalized additive models.</p>
<p><a href="http://cran.r-project.org/web/packages/GAMBoost/">GAMBoost</a>: This package provides routines for fitting generalized linear and and generalized additive models by likelihood based boosting.</p>
<p><a href="http://cran.r-project.org/web/packages/gamboostLSS/">gamboostLSS</a>: Boosting models for fitting generalized additive models for location, shape and scale (gamLSS models).</p>
<p><a href="http://cran.r-project.org/web/packages/GAMens/">GAMens</a>: This package implements the GAMbag, GAMrsm and GAMens ensemble classifiers for binary classification.</p>
<p><a href="http://cran.r-project.org/web/packages/gamlss/">gamlss</a>: Generalized additive models for location, shape, and scale.</p>
<p><a href="http://cran.r-project.org/web/packages/gamm4/">gamm4</a>: Fit generalized additive mixed models via a version of mgcv’s gamm function.</p>
<p><a href="http://cran.r-project.org/web/packages/gammSlice/">gammSlice</a>: Bayesian fitting and inference for generalized additive mixed models.</p>
<p><a href="http://cran.r-project.org/web/packages/GMMBoost/">GMMBoost</a>: Likelihood-based Boosting for Generalized mixed models.</p>
<p><a href="http://cran.r-project.org/web/packages/gss/">gss</a>: A comprehensive package for structural multivariate function estimation using smoothing splines.</p>
<p><a href="http://cran.r-project.org/web/packages/mboost/">mboost</a>: Model-Based Boosting.</p>
<p><a href="http://cran.r-project.org/web/packages/mgcv/">mgcv</a>: Routines for GAMs and other generalized ridge regression with multiple smoothing parameter selection by GCV, REML or UBRE/AIC. Also GAMMs.</p>
<p><a href="http://cran.r-project.org/web/packages/VGAM/">VGAM</a>: Vector generalized linear and additive models, and associated models.</p>
</div>
<div id="time-and-space" class="section level2">
<h2>Time and Space</h2>
<div id="time" class="section level3">
<h3>Time</h3>
<p>A natural setting for GAMs is where there are observations over time. Perhaps we want to examine the trend over time. The SLiM would posit a linear trend, but we often would doubt that is the case. How would we do this with a GAM? We can incorporate a covariate representing the time component and add it as a smooth term. There will be some additional issues though as we will see.</p>
<p>Here I use the data and example at <a href="https://www.fromthebottomoftheheap.net/">Gavin Simpon’s excellent blog</a>, though with my own edits, updated data, and different model. The data regards global temperature anomalies, which for some people assume does not exist, but for our purposes is actually in front of our face.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Global temperatures
## gtemp = read.table(&quot;https://crudata.uea.ac.uk/cru/data/temperature/HadCRUT4-gl.dat&quot;, fill = TRUE)

## Drop the even rows
gtemp =<span class="st"> </span>gtemp <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">drop_na</span>()</code></pre></div>
<div id="34b926cb7ff2" style="width:40%;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="34b926cb7ff2">{"x":{"visdat":{"34b9b01daeb":["function () ","plotlyVisDat"]},"cur_data":"34b9b01daeb","attrs":{"34b9b01daeb":{"x":{},"y":0,"alpha":1,"sizes":[10,100],"type":"scatter","mode":"lines","color":["gray92"]},"34b9b01daeb.1":{"x":{},"y":{},"alpha":1,"sizes":[10,100],"type":"scatter","mode":"lines","color":["#00aaff"],"showlegend":false}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"zeroline":false,"showgrid":false,"title":"Year"},"yaxis":{"domain":[0,1],"zeroline":false,"showgrid":false,"title":"Annual"},"plot_bgcolor":"transparent","paper_bgcolor":"transparent","hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false,"showLink":false,"displaylogo":false,"modeBarButtonsToRemove":["pan2d"]},"data":[{"x":[1850,1851,1852,1853,1854,1855,1856,1857,1858,1859,1860,1861,1862,1863,1864,1865,1866,1867,1868,1869,1870,1871,1872,1873,1874,1875,1876,1877,1878,1879,1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017],"y":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"type":"scatter","mode":"lines","line":{"fillcolor":"rgba(235,235,235,1)","color":"rgba(235,235,235,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1850,1851,1852,1853,1854,1855,1856,1857,1858,1859,1860,1861,1862,1863,1864,1865,1866,1867,1868,1869,1870,1871,1872,1873,1874,1875,1876,1877,1878,1879,1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017],"y":[-0.373,-0.218,-0.228,-0.269,-0.248,-0.272,-0.358,-0.461,-0.467,-0.284,-0.343,-0.407,-0.524,-0.278,-0.494,-0.279,-0.251,-0.321,-0.238,-0.262,-0.276,-0.335,-0.227,-0.304,-0.368,-0.395,-0.384,-0.075,0.035,-0.23,-0.227,-0.2,-0.213,-0.296,-0.409,-0.389,-0.367,-0.418,-0.307,-0.171,-0.416,-0.33,-0.455,-0.473,-0.41,-0.39,-0.186,-0.206,-0.412,-0.289,-0.203,-0.259,-0.402,-0.479,-0.52,-0.377,-0.283,-0.465,-0.511,-0.522,-0.49,-0.544,-0.437,-0.424,-0.244,-0.141,-0.383,-0.468,-0.333,-0.275,-0.247,-0.187,-0.302,-0.276,-0.294,-0.215,-0.108,-0.21,-0.206,-0.35,-0.137,-0.087,-0.137,-0.273,-0.131,-0.178,-0.147,-0.026,-0.006,-0.052,0.014,0.02,-0.027,-0.004,0.144,0.025,-0.071,-0.038,-0.039,-0.074,-0.173,-0.052,0.028,0.097,-0.129,-0.19,-0.267,-0.007,0.046,0.017,-0.049,0.038,0.014,0.048,-0.223,-0.14,-0.068,-0.074,-0.113,0.032,-0.027,-0.186,-0.065,0.062,-0.214,-0.149,-0.241,0.047,-0.062,0.057,0.092,0.14,0.011,0.194,-0.014,-0.03,0.045,0.192,0.198,0.118,0.296,0.254,0.105,0.148,0.208,0.325,0.183,0.39,0.539,0.306,0.294,0.441,0.496,0.505,0.447,0.545,0.506,0.491,0.395,0.506,0.56,0.425,0.47,0.514,0.579,0.763,0.797,0.675],"type":"scatter","mode":"lines","showlegend":false,"line":{"fillcolor":"rgba(0,170,255,1)","color":"rgba(0,170,255,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<p><br></p>
<p>Fitting a straight line to this would be disastrous, so let’s do a GAM.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hot_gam =<span class="st"> </span><span class="kw">gam</span>(Annual <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(Year), <span class="dt">data=</span>gtemp)
<span class="kw">summary</span>(hot_gam)</code></pre></div>
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
Annual ~ s(Year)

Parametric coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.09471    0.00768  -12.33   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
          edf Ref.df     F p-value    
s(Year) 7.836  8.649 153.5  &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

R-sq.(adj) =  0.888   Deviance explained = 89.3%
GCV = 0.01046  Scale est. = 0.0099103  n = 168</code></pre>
<div id="361d58a9d41c" style="width:40%;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="361d58a9d41c">{"x":{"visdat":{"361d439a9110":["function () ","plotlyVisDat"],"361d75a4a7bd":["function () ","data"],"361dd00a5a2":["function () ","data"]},"cur_data":"361dd00a5a2","attrs":{"361d439a9110":{"alpha":1,"sizes":[10,100],"x":{},"ymin":{},"ymax":{},"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","color":["#ff5500"]},"361d75a4a7bd":{"alpha":1,"sizes":[10,100],"x":{},"y":{},"type":"scatter","mode":"markers","color":["#ff5500"],"opacity":0.5},"361dd00a5a2":{"alpha":1,"sizes":[10,100],"x":{},"y":{},"type":"scatter","mode":"lines","color":["#00aaff"]}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"zeroline":false,"showgrid":false,"ticklength":10,"title":"Year"},"yaxis":{"domain":[0,1],"zeroline":false,"showgrid":false,"title":"Anomaly"},"plot_bgcolor":"transparent","paper_bgcolor":"transparent","showlegend":false,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false,"showLink":false,"displaylogo":false,"modeBarButtonsToRemove":["pan2d"],"displayModeBar":false},"data":[{"x":[1850,1851.67,1853.34,1855.01,1856.68,1858.35,1860.02,1861.69,1863.36,1865.03,1866.7,1868.37,1870.04,1871.71,1873.38,1875.05,1876.72,1878.39,1880.06,1881.73,1883.4,1885.07,1886.74,1888.41,1890.08,1891.75,1893.42,1895.09,1896.76,1898.43,1900.1,1901.77,1903.44,1905.11,1906.78,1908.45,1910.12,1911.79,1913.46,1915.13,1916.8,1918.47,1920.14,1921.81,1923.48,1925.15,1926.82,1928.49,1930.16,1931.83,1933.5,1935.17,1936.84,1938.51,1940.18,1941.85,1943.52,1945.19,1946.86,1948.53,1950.2,1951.87,1953.54,1955.21,1956.88,1958.55,1960.22,1961.89,1963.56,1965.23,1966.9,1968.57,1970.24,1971.91,1973.58,1975.25,1976.92,1978.59,1980.26,1981.93,1983.6,1985.27,1986.94,1988.61,1990.28,1991.95,1993.62,1995.29,1996.96,1998.63,2000.3,2001.97,2003.64,2005.31,2006.98,2008.65,2010.32,2011.99,2013.66,2015.33,2017,2017,2017,2015.33,2013.66,2011.99,2010.32,2008.65,2006.98,2005.31,2003.64,2001.97,2000.3,1998.63,1996.96,1995.29,1993.62,1991.95,1990.28,1988.61,1986.94,1985.27,1983.6,1981.93,1980.26,1978.59,1976.92,1975.25,1973.58,1971.91,1970.24,1968.57,1966.9,1965.23,1963.56,1961.89,1960.22,1958.55,1956.88,1955.21,1953.54,1951.87,1950.2,1948.53,1946.86,1945.19,1943.52,1941.85,1940.18,1938.51,1936.84,1935.17,1933.5,1931.83,1930.16,1928.49,1926.82,1925.15,1923.48,1921.81,1920.14,1918.47,1916.8,1915.13,1913.46,1911.79,1910.12,1908.45,1906.78,1905.11,1903.44,1901.77,1900.1,1898.43,1896.76,1895.09,1893.42,1891.75,1890.08,1888.41,1886.74,1885.07,1883.4,1881.73,1880.06,1878.39,1876.72,1875.05,1873.38,1871.71,1870.04,1868.37,1866.7,1865.03,1863.36,1861.69,1860.02,1858.35,1856.68,1855.01,1853.34,1851.67,1850],"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","y":[-0.407580122129761,-0.39706587843314,-0.387436320684596,-0.379077251534884,-0.372396144627654,-0.36763438695325,-0.364618736110392,-0.362701596967946,-0.361026462766877,-0.358870616613001,-0.35581891455298,-0.351780370201203,-0.346939493432016,-0.341690818366088,-0.336564080850094,-0.332134523116914,-0.328921427716971,-0.327296953689178,-0.327441026724872,-0.329360099720567,-0.33294838112954,-0.338052710930215,-0.34451605743501,-0.352195395110947,-0.360959270596419,-0.370669542918142,-0.381150144960022,-0.392148542766448,-0.403302404856156,-0.414129912678699,-0.424056046221273,-0.432469467906679,-0.438791231314657,-0.442535342305002,-0.443350295704611,-0.441039351043441,-0.435558977510788,-0.42699724288035,-0.41553685836402,-0.401411312217247,-0.384869239774675,-0.36616071448216,-0.34554710201093,-0.323324883794703,-0.299849311556138,-0.275546788620309,-0.250912032426651,-0.226489745070221,-0.202841530851076,-0.180501401636622,-0.159927033251955,-0.14145926862627,-0.125303570335096,-0.111539130770134,-0.100149688605946,-0.0910623708407756,-0.0841817751870192,-0.0794122517587537,-0.0766654238577437,-0.0758520759746008,-0.0768593427090361,-0.0795179499952742,-0.0835705681683876,-0.0886564588584359,-0.0943229106224976,-0.100061587081399,-0.105357078131922,-0.109732937814298,-0.112786106732694,-0.114205409897013,-0.113771857185687,-0.111340253126249,-0.106803936284066,-0.100052068664159,-0.0909383994199236,-0.079279230247768,-0.0648840501555093,-0.0476060713371893,-0.0273931086446199,-0.00432476795288037,0.0213691170143945,0.0493122418705165,0.0790126503673728,0.109924298707271,0.141534867020645,0.173453778501,0.205459570356937,0.237484257240261,0.269550520953728,0.301695923473822,0.333905104750205,0.366051038315089,0.397839474417485,0.42876336587295,0.458114597424512,0.485145954692266,0.509395104769023,0.530924697027817,0.550232354579375,0.56796736977357,0.584705113864161,0.584705113864161,0.747719322273919,0.710098044218652,0.673362147971332,0.63789637000146,0.604102696620872,0.572210197519251,0.542024762450459,0.512868506659146,0.483845347260072,0.454185061926359,0.423419630815561,0.391403604046538,0.358270358968946,0.324372420990747,0.290213145014418,0.256363763795116,0.223368522830138,0.191659708292568,0.161517596358541,0.133092861691339,0.106469828316034,0.0817310590834255,0.0589982915540612,0.0384454551513272,0.0202887603534215,0.00475877511562245,-0.00794246680543614,-0.0176933850685993,-0.0245005655956406,-0.0285235156127265,-0.0300632915426649,-0.0295196209557841,-0.0273350440746564,-0.0239448870276074,-0.0197434708234418,-0.0150688108356583,-0.0102052872297231,-0.00540256662456826,-0.000906433156416982,0.00300753347308416,0.00601193135645958,0.00773021089482874,0.00776563735243894,0.00574585688406856,0.00136827285723869,-0.00556558221530183,-0.015131830223666,-0.0272828271653023,-0.0418628966716557,-0.0586388087554241,-0.0773376879258862,-0.0976809417657406,-0.119400857187589,-0.142233441465369,-0.165894174044405,-0.190049999994935,-0.214299263512017,-0.238166775152018,-0.261116040800846,-0.282578427612773,-0.301997965709177,-0.318885828748875,-0.332872723352054,-0.343743350646521,-0.351441354118074,-0.356046574797754,-0.357736688396145,-0.356747291518274,-0.35334016865653,-0.347783678965339,-0.340347480578146,-0.33131317516511,-0.320999034167708,-0.309789859170891,-0.298154212345528,-0.286631537554708,-0.275786460087401,-0.266143868622324,-0.258124657236244,-0.25199688389388,-0.247847669827943,-0.245579479899844,-0.24493608073383,-0.245561544103991,-0.247087771907538,-0.249224537822815,-0.25181050619261,-0.25480265461562,-0.258219655416851,-0.262072689628574,-0.266304388487725,-0.270736593001813,-0.275020589924333,-0.278596456181727,-0.2807085710844,-0.280570144126217,-0.277688552775793,-0.272105578561249,-0.264306527292638,-0.254935203988014,-0.244565913719904],"line":{"fillcolor":"rgba(255,85,0,1)","color":"rgba(255,85,0,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1850,1851,1852,1853,1854,1855,1856,1857,1858,1859,1860,1861,1862,1863,1864,1865,1866,1867,1868,1869,1870,1871,1872,1873,1874,1875,1876,1877,1878,1879,1880,1881,1882,1883,1884,1885,1886,1887,1888,1889,1890,1891,1892,1893,1894,1895,1896,1897,1898,1899,1900,1901,1902,1903,1904,1905,1906,1907,1908,1909,1910,1911,1912,1913,1914,1915,1916,1917,1918,1919,1920,1921,1922,1923,1924,1925,1926,1927,1928,1929,1930,1931,1932,1933,1934,1935,1936,1937,1938,1939,1940,1941,1942,1943,1944,1945,1946,1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017],"y":[-0.373,-0.218,-0.228,-0.269,-0.248,-0.272,-0.358,-0.461,-0.467,-0.284,-0.343,-0.407,-0.524,-0.278,-0.494,-0.279,-0.251,-0.321,-0.238,-0.262,-0.276,-0.335,-0.227,-0.304,-0.368,-0.395,-0.384,-0.075,0.035,-0.23,-0.227,-0.2,-0.213,-0.296,-0.409,-0.389,-0.367,-0.418,-0.307,-0.171,-0.416,-0.33,-0.455,-0.473,-0.41,-0.39,-0.186,-0.206,-0.412,-0.289,-0.203,-0.259,-0.402,-0.479,-0.52,-0.377,-0.283,-0.465,-0.511,-0.522,-0.49,-0.544,-0.437,-0.424,-0.244,-0.141,-0.383,-0.468,-0.333,-0.275,-0.247,-0.187,-0.302,-0.276,-0.294,-0.215,-0.108,-0.21,-0.206,-0.35,-0.137,-0.087,-0.137,-0.273,-0.131,-0.178,-0.147,-0.026,-0.006,-0.052,0.014,0.02,-0.027,-0.004,0.144,0.025,-0.071,-0.038,-0.039,-0.074,-0.173,-0.052,0.028,0.097,-0.129,-0.19,-0.267,-0.007,0.046,0.017,-0.049,0.038,0.014,0.048,-0.223,-0.14,-0.068,-0.074,-0.113,0.032,-0.027,-0.186,-0.065,0.062,-0.214,-0.149,-0.241,0.047,-0.062,0.057,0.092,0.14,0.011,0.194,-0.014,-0.03,0.045,0.192,0.198,0.118,0.296,0.254,0.105,0.148,0.208,0.325,0.183,0.39,0.539,0.306,0.294,0.441,0.496,0.505,0.447,0.545,0.506,0.491,0.395,0.506,0.56,0.425,0.47,0.514,0.579,0.763,0.797,0.675],"type":"scatter","mode":"markers","opacity":0.5,"marker":{"fillcolor":"rgba(255,85,0,1)","color":"rgba(255,85,0,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":[1850,1851.67,1853.34,1855.01,1856.68,1858.35,1860.02,1861.69,1863.36,1865.03,1866.7,1868.37,1870.04,1871.71,1873.38,1875.05,1876.72,1878.39,1880.06,1881.73,1883.4,1885.07,1886.74,1888.41,1890.08,1891.75,1893.42,1895.09,1896.76,1898.43,1900.1,1901.77,1903.44,1905.11,1906.78,1908.45,1910.12,1911.79,1913.46,1915.13,1916.8,1918.47,1920.14,1921.81,1923.48,1925.15,1926.82,1928.49,1930.16,1931.83,1933.5,1935.17,1936.84,1938.51,1940.18,1941.85,1943.52,1945.19,1946.86,1948.53,1950.2,1951.87,1953.54,1955.21,1956.88,1958.55,1960.22,1961.89,1963.56,1965.23,1966.9,1968.57,1970.24,1971.91,1973.58,1975.25,1976.92,1978.59,1980.26,1981.93,1983.6,1985.27,1986.94,1988.61,1990.28,1991.95,1993.62,1995.29,1996.96,1998.63,2000.3,2001.97,2003.64,2005.31,2006.98,2008.65,2010.32,2011.99,2013.66,2015.33,2017],"y":[-0.326073017924832,-0.326000541210577,-0.325871423988617,-0.325591415048066,-0.325042348701724,-0.324102265539734,-0.322663653597396,-0.320649026574836,-0.318023526345605,-0.314803604807407,-0.311061651520353,-0.306926529914889,-0.302579574424433,-0.298246736490854,-0.294187293521352,-0.290679530469865,-0.288004599812255,-0.286429248896584,-0.286188553729351,-0.287469789810206,-0.290398025478741,-0.295024797412048,-0.301320357335627,-0.309169631866636,-0.31837286534191,-0.328650540236425,-0.339652178652775,-0.35096920096867,-0.362150719511932,-0.372721543921904,-0.382201763399709,-0.390126573436009,-0.396065699985594,-0.399641316911638,-0.400543492050378,-0.398542962920598,-0.393500165814431,-0.385370296763435,-0.374204790858037,-0.360148570483061,-0.343433602741926,-0.324369571047467,-0.303331571405888,-0.280745829473361,-0.257074287534078,-0.232798394307622,-0.208403103235528,-0.184361593267795,-0.161121194019332,-0.139091171701181,-0.11863236058892,-0.100049038690847,-0.0835832335033758,-0.0694109789677179,-0.0576407594148058,-0.0483139765280387,-0.0414067511648902,-0.0368331974373425,-0.0344498932526524,-0.034060932539886,-0.0354237056762882,-0.038255208261095,-0.0422385006624023,-0.0470295127415021,-0.0522640989261104,-0.0575651989585288,-0.062550274477682,-0.0668389124209529,-0.0700605754036754,-0.0718625154263984,-0.071917574364176,-0.0699318843694877,-0.0656522509398535,-0.058872726866379,-0.0494404331126799,-0.0372602275660728,-0.0222976449010439,-0.00458030809293108,0.0158025914547206,0.0387031455652725,0.0639194726652144,0.0912025517809275,0.120265123362957,0.150792003499919,0.182451694925392,0.214908771148058,0.247836357685677,0.280928339115504,0.313910439961337,0.34654976376018,0.378662367782883,0.410118050120724,0.440842410838779,0.470815936266048,0.500069679937485,0.528678076105758,0.556748900694947,0.584410533514639,0.611797251275353,0.639032706996111,0.66621221806904],"type":"scatter","mode":"lines","line":{"fillcolor":"rgba(0,170,255,1)","color":"rgba(0,170,255,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<p><br></p>
<p>We can see that the trend is generally increasing, and has been more or less since the beginning of the 20th century. We have a remaining issue though. In general, a time series is autocorrelated, correlated with itself over time. We can see this in the following plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">acf</span>(gtemp<span class="op">$</span>Annual)</code></pre></div>
<p><img src="GAM_files/figure-html/ar_raw_pretty-1.svg" width="40%" style="display: block; margin: auto;" /></p>
<p><br></p>
<p>What the plot shows is the correlation of the values with themselves at different <span class="emph">lags</span>, or time spacings. Lag 0 is it’s correlation with itself, so the value is 1.0. It’s correlation with itself at the previous time point, i.e. lag = 1, is 0.9, it’s correlation with itself at two time points ago is slightly less, 0.83, and the decreasing trend continues slowly. The dotted lines indicate a 95% confidence interval around zero, meaning that the autocorrelation is still significant 25 years apart.</p>
<p>With our model the issue remains in that there is still autocorrelation among the residuals, at least at lag 1.</p>
<p><img src="GAM_files/figure-html/ar_res-1.svg" width="40%" style="display: block; margin: auto;" /></p>
<p>The practical implications of autocorrelated residuals is that this positive correlation would result in variance estimates that are too low. However, we can take this into account with a slight tweaking of our model to incorporate such autocorrelation. For our purposes we’ll switch to the <span class="func">gamm</span> function. It adds additional functionality for generalized additive <em>mixed</em> models, though we can just use it for to incorporate autocorrelation of the residuals. In running this, two sets of output are provided, one in our familiar <span class="objclass">gam</span> model object, and the other as a <span class="objclass">lme</span> object from the <span class="pack">nlme</span> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hot_gam_ar =<span class="st"> </span><span class="kw">gamm</span>(Annual <span class="op">~</span><span class="st"> </span><span class="kw">s</span>(Year), <span class="dt">data=</span>gtemp, <span class="dt">correlation=</span><span class="kw">corAR1</span>(<span class="dt">form =</span> <span class="op">~</span>Year))
<span class="co"># summary(hot_gam)</span>
<span class="kw">summary</span>(hot_gam_ar<span class="op">$</span>gam)</code></pre></div>
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
Annual ~ s(Year)

Parametric coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.09484    0.01159  -8.184 8.05e-14 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Approximate significance of smooth terms:
          edf Ref.df     F p-value    
s(Year) 6.744  6.744 88.08  &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

R-sq.(adj) =  0.886   
  Scale est. = 0.010426  n = 168</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(hot_gam_ar<span class="op">$</span>lme)</code></pre></div>
<pre><code>Linear mixed-effects model fit by maximum likelihood
 Data: strip.offset(mf) 
        AIC       BIC   logLik
  -281.1446 -265.5247 145.5723

Random effects:
 Formula: ~Xr - 1 | g
 Structure: pdIdnot
             Xr1      Xr2      Xr3      Xr4      Xr5      Xr6      Xr7      Xr8  Residual
StdDev: 1.206914 1.206914 1.206914 1.206914 1.206914 1.206914 1.206914 1.206914 0.1021091

Correlation Structure: AR(1)
 Formula: ~Year | g 
 Parameter estimate(s):
      Phi 
0.3680526 
Fixed effects: y ~ X - 1 
                  Value  Std.Error  DF   t-value p-value
X(Intercept) -0.0948406 0.01162332 166 -8.159513  0.0000
Xs(Year)Fx1   0.4612471 0.16916014 166  2.726689  0.0071
 Correlation: 
            X(Int)
Xs(Year)Fx1 0     

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-2.19358937 -0.71661900  0.02464626  0.71775792  3.23431657 

Number of Observations: 168
Number of Groups: 1 </code></pre>
<p>In the gam output, we see some slight differences but not much (and we wouldn’t expect it). From the lme output we can see the estimated autocorrelation value denoted as <code>Phi</code><a href="#fn37" class="footnoteRef" id="fnref37"><sup>37</sup></a>. Let’s see what it does for our fit.</p>
<div id="39464cb95e66" style="width:40%;height:384px;" class="plotly html-widget"></div>
<script type="application/json" data-for="39464cb95e66">{"x":{"visdat":{"39461280e6ef":["function () ","plotlyVisDat"],"39461de4a1e4":["function () ","data"],"3946d408f11":["function () ","data"],"3946970abe3":["function () ","data"]},"cur_data":"3946970abe3","attrs":{"39461de4a1e4":{"alpha":1,"sizes":[10,100],"x":{},"ymin":{},"ymax":{},"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","color":["gray75"]},"3946d408f11":{"alpha":1,"sizes":[10,100],"x":{},"ymin":{},"ymax":{},"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","color":["#ff5500"]},"3946970abe3":{"alpha":1,"sizes":[10,100],"x":{},"y":{},"type":"scatter","mode":"lines","color":["#00aaff"]}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"zeroline":false,"showgrid":false,"ticklength":10,"title":"Year"},"yaxis":{"domain":[0,1],"zeroline":false,"showgrid":false,"title":"Anomaly"},"plot_bgcolor":"transparent","paper_bgcolor":"transparent","showlegend":false,"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false,"showLink":false,"displaylogo":false,"modeBarButtonsToRemove":["pan2d"],"displayModeBar":false},"data":[{"x":[1850,1851.67,1853.34,1855.01,1856.68,1858.35,1860.02,1861.69,1863.36,1865.03,1866.7,1868.37,1870.04,1871.71,1873.38,1875.05,1876.72,1878.39,1880.06,1881.73,1883.4,1885.07,1886.74,1888.41,1890.08,1891.75,1893.42,1895.09,1896.76,1898.43,1900.1,1901.77,1903.44,1905.11,1906.78,1908.45,1910.12,1911.79,1913.46,1915.13,1916.8,1918.47,1920.14,1921.81,1923.48,1925.15,1926.82,1928.49,1930.16,1931.83,1933.5,1935.17,1936.84,1938.51,1940.18,1941.85,1943.52,1945.19,1946.86,1948.53,1950.2,1951.87,1953.54,1955.21,1956.88,1958.55,1960.22,1961.89,1963.56,1965.23,1966.9,1968.57,1970.24,1971.91,1973.58,1975.25,1976.92,1978.59,1980.26,1981.93,1983.6,1985.27,1986.94,1988.61,1990.28,1991.95,1993.62,1995.29,1996.96,1998.63,2000.3,2001.97,2003.64,2005.31,2006.98,2008.65,2010.32,2011.99,2013.66,2015.33,2017,2017,2017,2015.33,2013.66,2011.99,2010.32,2008.65,2006.98,2005.31,2003.64,2001.97,2000.3,1998.63,1996.96,1995.29,1993.62,1991.95,1990.28,1988.61,1986.94,1985.27,1983.6,1981.93,1980.26,1978.59,1976.92,1975.25,1973.58,1971.91,1970.24,1968.57,1966.9,1965.23,1963.56,1961.89,1960.22,1958.55,1956.88,1955.21,1953.54,1951.87,1950.2,1948.53,1946.86,1945.19,1943.52,1941.85,1940.18,1938.51,1936.84,1935.17,1933.5,1931.83,1930.16,1928.49,1926.82,1925.15,1923.48,1921.81,1920.14,1918.47,1916.8,1915.13,1913.46,1911.79,1910.12,1908.45,1906.78,1905.11,1903.44,1901.77,1900.1,1898.43,1896.76,1895.09,1893.42,1891.75,1890.08,1888.41,1886.74,1885.07,1883.4,1881.73,1880.06,1878.39,1876.72,1875.05,1873.38,1871.71,1870.04,1868.37,1866.7,1865.03,1863.36,1861.69,1860.02,1858.35,1856.68,1855.01,1853.34,1851.67,1850],"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","y":[-0.409109392093429,-0.398375213469524,-0.388532656848865,-0.379970049121537,-0.373097496369083,-0.368161296287007,-0.364998787173163,-0.362976019113925,-0.361245039388749,-0.359083396406307,-0.356070803865394,-0.352108873454439,-0.347373751133031,-0.342250816310526,-0.33725987349339,-0.332965977121415,-0.329879214572681,-0.328364957549901,-0.328599158867749,-0.330586107998377,-0.334218288292156,-0.339340634814996,-0.345794244707823,-0.353434764610007,-0.362130341862283,-0.371743574022332,-0.382100476325012,-0.392952296090126,-0.403942593948587,-0.414597594654788,-0.42435178510926,-0.432603583493259,-0.438782858920106,-0.442410705929571,-0.443140599747335,-0.440778529697058,-0.435281466122226,-0.426735973096658,-0.415321752667753,-0.401268516500819,-0.384821041757595,-0.366225747022108,-0.345740376571352,-0.323657478029805,-0.300327851291974,-0.276172959337156,-0.251682266340804,-0.22739514284858,-0.203868076411621,-0.181630596303274,-0.161137093605586,-0.1427268462602,-0.126605637132781,-0.112854520142413,-0.101459957082394,-0.0923519816834087,-0.0854378041022633,-0.0806238109105244,-0.0778229381104971,-0.0769465410814288,-0.0778817784353132,-0.080459332295089,-0.0844224116958009,-0.0894118831035746,-0.094977711969791,-0.100614875609533,-0.105811359242982,-0.110093782449659,-0.113061589171779,-0.114405401787632,-0.113907225533106,-0.11142210390008,-0.106843216634687,-0.10005986463568,-0.0909269202884961,-0.0792629426880663,-0.0648802703501182,-0.0476347035482646,-0.0274756775684884,-0.00448302580845869,0.021114880558624,0.0489452134592373,0.0785217917512541,0.109306501019494,0.140796000813153,0.172607782378705,0.204525886480132,0.23648499355044,0.268508368721648,0.300632723421465,0.332840424258261,0.365000399724349,0.396812548439003,0.42776343411672,0.457141342225098,0.484201493611182,0.508487376228153,0.530063414996639,0.549423216669025,0.567210638591197,0.583997431587273,0.583997431587273,0.749359458572323,0.711509364259458,0.674550925266797,0.638870318587,0.604870833857588,0.572785119979651,0.542428526781533,0.513136081215756,0.484020045168326,0.454310864954278,0.423536434133289,0.391545600859449,0.358465662467153,0.324642753909621,0.290573401474492,0.256821916542452,0.223926585756751,0.192315909114345,0.16226875332643,0.133935567944522,0.107400099731678,0.0827432371718582,0.0600840772641228,0.03959341590934,0.0214842444025968,0.00598411113627863,-0.00670743822779714,-0.016470246896221,-0.023310631372901,-0.0273858494512185,-0.0289931479576132,-0.0285278280132628,-0.0264283088987557,-0.0231266430198283,-0.019014897162735,-0.0144298247760408,-0.00965540255700094,-0.00494147872722562,-0.000534113801419468,0.0032913999567401,0.00620905511162859,0.00784489296648505,0.00780554722013393,0.00572217828622622,0.0012953342462942,-0.00567097121574398,-0.0152511836301686,-0.027396853634849,-0.0419523456976724,-0.0586851168667446,-0.077323230571778,-0.0975888669097834,-0.119214784976466,-0.141937476340995,-0.165473492888614,-0.18949194886959,-0.213594712943553,-0.23731148883319,-0.260111891240818,-0.281434312974237,-0.30073020821065,-0.317517784248976,-0.331433454773376,-0.342265568720348,-0.349959156709496,-0.354593478863618,-0.356344137667102,-0.355443566499704,-0.352149578646996,-0.346726009718779,-0.339437707533663,-0.33056134020586,-0.320410008686778,-0.30936267835067,-0.297880994264308,-0.286496520197946,-0.275765827109483,-0.266206645152299,-0.258234489875129,-0.252114371834651,-0.247933069119145,-0.24559575351319,-0.244852197292699,-0.24535554945516,-0.246748629629144,-0.248751842957689,-0.251212358499033,-0.25409305595137,-0.257416457387583,-0.26119599601655,-0.265374793990473,-0.269772931176466,-0.274037542659472,-0.277603372014868,-0.27971160261668,-0.279577669918493,-0.27671403873964,-0.27116314553119,-0.263404948251101,-0.254076487801232,-0.243747365108296],"line":{"fillcolor":"rgba(191,191,191,1)","color":"rgba(191,191,191,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1850,1851.67,1853.34,1855.01,1856.68,1858.35,1860.02,1861.69,1863.36,1865.03,1866.7,1868.37,1870.04,1871.71,1873.38,1875.05,1876.72,1878.39,1880.06,1881.73,1883.4,1885.07,1886.74,1888.41,1890.08,1891.75,1893.42,1895.09,1896.76,1898.43,1900.1,1901.77,1903.44,1905.11,1906.78,1908.45,1910.12,1911.79,1913.46,1915.13,1916.8,1918.47,1920.14,1921.81,1923.48,1925.15,1926.82,1928.49,1930.16,1931.83,1933.5,1935.17,1936.84,1938.51,1940.18,1941.85,1943.52,1945.19,1946.86,1948.53,1950.2,1951.87,1953.54,1955.21,1956.88,1958.55,1960.22,1961.89,1963.56,1965.23,1966.9,1968.57,1970.24,1971.91,1973.58,1975.25,1976.92,1978.59,1980.26,1981.93,1983.6,1985.27,1986.94,1988.61,1990.28,1991.95,1993.62,1995.29,1996.96,1998.63,2000.3,2001.97,2003.64,2005.31,2006.98,2008.65,2010.32,2011.99,2013.66,2015.33,2017,2017,2017,2015.33,2013.66,2011.99,2010.32,2008.65,2006.98,2005.31,2003.64,2001.97,2000.3,1998.63,1996.96,1995.29,1993.62,1991.95,1990.28,1988.61,1986.94,1985.27,1983.6,1981.93,1980.26,1978.59,1976.92,1975.25,1973.58,1971.91,1970.24,1968.57,1966.9,1965.23,1963.56,1961.89,1960.22,1958.55,1956.88,1955.21,1953.54,1951.87,1950.2,1948.53,1946.86,1945.19,1943.52,1941.85,1940.18,1938.51,1936.84,1935.17,1933.5,1931.83,1930.16,1928.49,1926.82,1925.15,1923.48,1921.81,1920.14,1918.47,1916.8,1915.13,1913.46,1911.79,1910.12,1908.45,1906.78,1905.11,1903.44,1901.77,1900.1,1898.43,1896.76,1895.09,1893.42,1891.75,1890.08,1888.41,1886.74,1885.07,1883.4,1881.73,1880.06,1878.39,1876.72,1875.05,1873.38,1871.71,1870.04,1868.37,1866.7,1865.03,1863.36,1861.69,1860.02,1858.35,1856.68,1855.01,1853.34,1851.67,1850],"type":"scatter","mode":"lines","hoveron":"points","fill":"toself","y":[-0.444382652581195,-0.429600569906798,-0.415939412387505,-0.403849197982454,-0.393785534795622,-0.386040374337142,-0.380552195452712,-0.376847213686864,-0.374204533101271,-0.37192455574428,-0.369519699556591,-0.366777188217743,-0.363738260865549,-0.360640700576618,-0.357845341212107,-0.355752914965332,-0.354719564082072,-0.354986986260184,-0.356647321277724,-0.359652584756092,-0.363858147770013,-0.369077041119253,-0.37512426127978,-0.381841116970282,-0.389098477690068,-0.396781728356021,-0.404762229432833,-0.412862976889299,-0.420829986310873,-0.428322398431286,-0.434928856787307,-0.440207030027522,-0.443734549312322,-0.445156788102589,-0.444221259783512,-0.44079437564806,-0.434858991780177,-0.426495019048853,-0.415848770467035,-0.403098980984009,-0.388430728474576,-0.372026283210511,-0.354073721077708,-0.334787159577141,-0.314428656940739,-0.293322106315215,-0.271854011462787,-0.250459641936936,-0.229595235441931,-0.209700426535238,-0.191158218492872,-0.174262361429404,-0.159201652497586,-0.146064928494519,-0.134863014765201,-0.125558411205678,-0.118092739818073,-0.112404919179795,-0.108436295794066,-0.106121882627881,-0.10536975320391,-0.106034210589844,-0.107892134166542,-0.110633137842616,-0.113870099667337,-0.117168801736721,-0.120088199426668,-0.122220156641779,-0.1232200865454,-0.122822995396327,-0.120842182507077,-0.117151443265813,-0.111654739672672,-0.104252597785287,-0.0948192362392412,-0.0832015367235365,-0.0692418374318777,-0.0528168914700008,-0.0338793617263692,-0.012489459763176,0.0111704327914301,0.0368032791725702,0.0640300440354754,0.0924452717809638,0.1216854766464,0.151488947131216,0.181722488402357,0.212364084794454,0.243450189512698,0.275006826003198,0.306979886463602,0.339171834312975,0.371190969306193,0.402433584474169,0.432145293085906,0.459606436395328,0.48439139654227,0.506520992281112,0.526388234311184,0.544550639792132,0.561541410783004,0.561541410783004,0.784532035649924,0.74237022731971,0.701320101840197,0.661814633783984,0.624284881297502,0.588992262992692,0.55584044284691,0.524318458318297,0.493668122237467,0.463155061331101,0.432262428387835,0.400757080330028,0.368672420802658,0.336254699752287,0.303893353965563,0.272041391943199,0.241134006358657,0.21152125423443,0.183434448997986,0.156996010244752,0.132262173810524,0.109274961735859,0.0881027110228287,0.0688592083796383,0.0517001918268931,0.0368003544760243,0.0243157718458645,0.0143397370039655,0.0068639922371688,0.00175852295080454,-0.0012218869658456,-0.00240702929347691,-0.00216820669810287,-0.000876472748988485,0.00112782066952984,0.00354983086433267,0.00613856024744545,0.00867086641212571,0.0109265264633709,0.0126627006075513,0.0135985213341712,0.0134183989156677,0.0117948139147582,0.00842368908921878,0.00306196689090098,-0.00444278768629872,-0.0141366899441939,-0.025959441781454,-0.0397599518832383,-0.0553241124072645,-0.0724072513102049,-0.0907621775130689,-0.110153534827545,-0.130354155223856,-0.151127686641812,-0.172206482795923,-0.193273950231883,-0.213958551308244,-0.233842611368966,-0.252486001666996,-0.26946245393649,-0.2844020697866,-0.297030109837124,-0.307191014794146,-0.314850331865448,-0.320075743047054,-0.323005239687329,-0.323813104209766,-0.322682669464946,-0.319791063924573,-0.315308561245982,-0.309412432214608,-0.302311254401009,-0.294270642100047,-0.285627221347723,-0.276779837156426,-0.268156448431224,-0.260165017120554,-0.253142188530511,-0.247312619620192,-0.242766406750951,-0.239459853683987,-0.237242916315311,-0.235911003806803,-0.235271034369858,-0.235200470153358,-0.235674475648894,-0.2367500856188,-0.238516029575633,-0.241026933890987,-0.244237157632446,-0.247941328726223,-0.251727380170029,-0.254962339842705,-0.256857045691653,-0.256654547739721,-0.253892050040371,-0.248555556479589,-0.241007544858506,-0.23178098237921,-0.221392027714235],"line":{"fillcolor":"rgba(255,85,0,1)","color":"rgba(255,85,0,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1850,1851.67,1853.34,1855.01,1856.68,1858.35,1860.02,1861.69,1863.36,1865.03,1866.7,1868.37,1870.04,1871.71,1873.38,1875.05,1876.72,1878.39,1880.06,1881.73,1883.4,1885.07,1886.74,1888.41,1890.08,1891.75,1893.42,1895.09,1896.76,1898.43,1900.1,1901.77,1903.44,1905.11,1906.78,1908.45,1910.12,1911.79,1913.46,1915.13,1916.8,1918.47,1920.14,1921.81,1923.48,1925.15,1926.82,1928.49,1930.16,1931.83,1933.5,1935.17,1936.84,1938.51,1940.18,1941.85,1943.52,1945.19,1946.86,1948.53,1950.2,1951.87,1953.54,1955.21,1956.88,1958.55,1960.22,1961.89,1963.56,1965.23,1966.9,1968.57,1970.24,1971.91,1973.58,1975.25,1976.92,1978.59,1980.26,1981.93,1983.6,1985.27,1986.94,1988.61,1990.28,1991.95,1993.62,1995.29,1996.96,1998.63,2000.3,2001.97,2003.64,2005.31,2006.98,2008.65,2010.32,2011.99,2013.66,2015.33,2017],"y":[-0.332887340147715,-0.330690776143004,-0.328473478623005,-0.326202377231021,-0.323838792417996,-0.321347461038431,-0.318704620572183,-0.315904776764785,-0.31296595663565,-0.309932942235252,-0.306878428594519,-0.303902061054365,-0.301127145220591,-0.298695393097709,-0.296759908430501,-0.295476692559345,-0.294995299225965,-0.295448995033493,-0.296945118796517,-0.29955621922004,-0.303312277260482,-0.308194830369723,-0.314133224905146,-0.321003067045418,-0.328627463060646,-0.336780782756223,-0.345194725390278,-0.353566809494673,-0.361570620355941,-0.368867415322947,-0.375118709016644,-0.379999046976047,-0.383208609388634,-0.384484946156177,-0.383613249735421,-0.380435059347557,-0.374854661822812,-0.366843016921499,-0.356439440152079,-0.343750525385304,-0.328946591205533,-0.312256142438754,-0.293958166223337,-0.274372855442693,-0.253851303586311,-0.232764294555569,-0.2114908490523,-0.190406898580396,-0.169874385134738,-0.150231302024153,-0.131782734901539,-0.114793236918334,-0.0994808021904121,-0.0860121851379863,-0.0744998523546973,-0.0650005994459881,-0.0575153864635861,-0.0519906150452879,-0.0483207409396538,-0.0463517418561069,-0.0458856159348692,-0.0466857549911465,-0.0484828038515855,-0.0509811357152451,-0.0538657697099458,-0.0568094854361944,-0.059480189378569,-0.0615483146953835,-0.0626941466217516,-0.0626150123449021,-0.0610320347364613,-0.0576964601575042,-0.0523953737177518,-0.0449564303906605,-0.0352517321966883,-0.0232005911237561,-0.00877082280249231,0.00802115845481877,0.0271116746482298,0.0483927509863415,0.0717163033009772,0.096899644708661,0.123732246516731,0.151983263007697,0.181409741502529,0.211765169537208,0.24280792118396,0.27430939227337,0.306061305157678,0.337881953166613,0.369621157425719,0.401163447822038,0.43242954577183,0.463376021396233,0.493992867966408,0.52429934969401,0.554338138919886,0.584167813032548,0.61385416807569,0.643460433555921,0.673036723216464],"type":"scatter","mode":"lines","line":{"fillcolor":"rgba(0,170,255,1)","color":"rgba(0,170,255,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<p><br></p>
<p>We can in fact see that we were a bit optimistic in the previous fit (non-colored band). Our new fit is wider at every point<a href="#fn38" class="footnoteRef" id="fnref38"><sup>38</sup></a>. Thus in using a GAM for time-series data, we have the same issues we’d have with standard regression settings, and we’d deal with them in much the same way to get a better sense of the uncertainty in our estimates.</p>
</div>
<div id="space" class="section level3">
<h3>Space</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># data available at https://github.com/polygraph-cool/smoothing_tutorial/blob/master/us_county_hs_only.zip</span>
<span class="kw">data</span>(<span class="st">&#39;CanWeather&#39;</span>, <span class="dt">package =</span> <span class="st">&#39;gamair&#39;</span>)</code></pre></div>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="37">
<li id="fn37"><p>All the same variables in the lme output start with X. This is more to avoid confusion in the functions behind the scenes.<a href="appendix.html#fnref37">↩</a></p></li>
<li id="fn38"><p>I don’t show it to keep the plot clean, but the fitted values are essentially the same.<a href="appendix.html#fnref38">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="technical-details.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["twitter", "facebook", "google", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"download": null,
"toc": {
"collapse": "section",
"depth": 2,
"scroll_highlight": true
},
"highlight": "pygments",
"search": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
